<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4. Геометрична інтерпретація комплексних чисел</title>
    <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;700&family=Roboto:wght@400;700&family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
    <style>
    
      .figure {
    display: block;
    margin: 10px auto;
    max-width: 100%;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    object-fit: contain;
}

.figure.figure-1-1 {
    width: 150px;
    height: 150px;
}

.figure.figure-1-2 {
    width: 180px;
    height: 180px;
}
.figure.figure-1-3 {
    width: 150px;
    height: 150px;
}
.figure.figure-1-4,
.figure.figure-1-5,
.figure.figure-1-6 {
    width: 200px;
    height: 200px;
}

.figure-caption {
    text-align: center;
    font-style: italic;
    color: #1e293b;
    margin-bottom: 15px;
}
       
        *, *:before, *:after {
            box-sizing: border-box;
        }
        body {
    margin: 0;
    background: linear-gradient(135deg, #1e1b4b, #134e4a);
    font-family: 'Roboto', sans-serif;
    color: #e2e8f0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: start;
    min-height: 100vh;
    visibility: hidden; /* Приховуємо body за замовчуванням */
    opacity: 0; /* Для плавного з'явлення */
    transition: opacity 0.3s ease; /* Плавний перехід */
}

body.loaded {
    visibility: visible; /* Показуємо після ініціалізації */
    opacity: 1;
}
        .title-box {
            margin-top: 60px;
            padding: 20px 40px;
            background: linear-gradient(135deg, #22d3ee, #fb7185);
            border-radius: 15px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
            max-width: 90%;
            text-align: center;
        }
        .title-box h1 {
            margin: 0;
            font-size: 32px;
            color: #ffffff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            font-family: 'Merriweather', serif;
        }
        .section-container {
            margin-top: 80px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        .section {
            width: 260px;
            height: 200px;
            background: linear-gradient(45deg, #1e293b, #475569);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 15px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            color: #e2e8f0;
            text-decoration: none;
        }
        .section:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0,0,0,0.25);
            background: linear-gradient(45deg, #1e293b, #4ade80);
        }
        .section img {
            width: 60px;
            height: 60px;
            margin-bottom: 15px;
            object-fit: cover;
            border-radius: 5px;
        }
        .section h2 {
            font-size: 20px;
            margin: 0;
            font-family: 'Merriweather', serif;
        }
        #theoryModal, #questionsModal, #trainerModal, #videoModal, #videoPlayerModal1, #videoPlayerModal2, #videoPlayerModal3 {
            display: none;
            position: fixed;
            top: 5%;
            left: 5%;
            width: 90%;
            height: 90%;
            background: linear-gradient(135deg, #2dd4bf, #1e3a8a);
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            z-index: 1000;
            overflow: hidden;
            flex-direction: column;
        }
            /* Стилі для модальних вікон */
.modal {
    display: none;
    position: fixed;
    top: 5%;
    left: 5%;
    width: 90%;
    height: 90%;
    background: linear-gradient(135deg, #2dd4bf, #1e3a8a);
    border-radius: 15px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    z-index: 1001;
    overflow: hidden;
    flex-direction: column;
}
#modalOverlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 999;
}
        .modal-content {
            padding: 20px;
            overflow-y: auto;
            flex-grow: 1;
            background: #f1f5f9;
            border-radius: 10px;
            margin: 10px;
            color: #FFB6B6;
        }
        .modal-header {
            display: flex;
            justify-content: flex-end;
            background: linear-gradient(0deg, #2dd4bf, #1e3a8a);
            padding: 10px;
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
        }
        #trainerModal .modal-header {
            background: #6b21a8;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
        }
        .close-btn {
            background: #fb7185;
            color: #ffffff;
            border: none;
            border-radius: 6px;
            padding: 6px 16px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s ease;
            font-family: 'Roboto', sans-serif;
        }
        .close-btn:hover {
            background: #10b981;
        }
        #trainerModal .close-btn {
            background: #a855f7;
        }
        #trainerModal .close-btn:hover {
            background: #ec4899;
        }
       
         .video-card-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-top: 25px;
            padding: 15px;
            background: linear-gradient(135deg, #84a9ac, #cae4db);
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        .video-card {
            width: 300px;
            height: 180px;
            background: linear-gradient(to bottom right, #e0f7ff, #b3e5fc);
            border-radius: 15px;
            border: 2px solid #ffffff;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: flex-start;
            padding: 10px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            color: #800000;
        }
        .video-card:hover {
            transform: scale(1.03);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }
        .video-card img {
            width: 50px;
            height: 50px;
            margin-right: 10px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #ffffff;
        }
        .video-card h3 {
            font-size: 16px;
            margin: 0;
            font-family: 'Merriweather', serif;
        }
        .video-player-container {
            max-width: 800px;
            margin: 20px auto;
            background: #f1f5f9;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            text-align: center;
        }
        .video-player-container iframe, .video-player-container div {
            width: 100%;
            height: 400px;
            max-height: 400px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: none;
        }
        details {
            margin: 10px 0;
            padding: 10px;
            border-radius: 6px;
            background: #003153;
            cursor: pointer;
        }
        summary {
            font-weight: bold;
            padding: 8px;
            background: #b81414;
            border-radius: 6px;
            color: #ffffff;
            font-family: 'Merriweather', serif;
        }
        summary:hover {
            background: #10b981;
        }
        details p {
            padding: 0 15px 10px;
            color: #e2e8f0;
            margin: 8px 0;
        }
        .complex-plane h3, .polar-form h3 {
            text-align: center;
            color: #fef08a;
            font-style: normal;
        }
        .math-notation {
            font-style: italic;
            color: #fef08a;
        }
        .complex-plane > div, .polar-form > div {
            display: block;
            white-space: normal;
            word-wrap: break-word;
            text-align: justify;
        }
        .highlight-term {
            background: #e0f7fa;
            padding: 2px 4px;
            border-radius: 3px;
            color: #0ea5e9;
        }
        .formula-line {
            display: inline-block;
            white-space: nowrap;
        }
        .question-block {
            margin: 15px 0;
            padding: 10px;
            background: linear-gradient(135deg, #22d3ee, #fb7185);
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            cursor: pointer;
        }
        .question-block summary {
            font-size: 16px;
            background: #2dd4bf;
            color: #ffffff;
        }
        .question-block details summary {
            background: #fb7185;
        }
        .question-block details p {
            color: #1e293b;
            background: #f1f5f9;
            padding: 10px;
            border-radius: 6px;
        }
            #questionsModal mjx-container {
    color: #FFFF00 !important;
    font-style: italic;
    font-size: 20px !important;
}
        .trainer-container {
            width: 90%;
            max-width: 800px;
            padding: 3vw 4vw;
            text-align: center;
            background-color: #ffffffc7;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0);
            transition: all 0.3s ease;
            margin: auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100%;
        }
        .question-circle {
            width: clamp(80px, 15vw, 120px);
            height: clamp(80px, 15vw, 120px);
            margin: 0 auto 3vw;
            background: linear-gradient(135deg, #a855f7, #ec4899);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
        }
        .question-circle h3 {
            color: #ffffff;
            font-family: 'Lora', serif;
            font-size: clamp(16px, 2.5vw, 20px);
            margin: 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        .completion-emoji {
            width: clamp(80px, 15vw, 120px);
            height: clamp(80px, 15vw, 120px);
            margin: 0 auto 3vw;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
            border: 2px dashed #fb7185;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .completion-emoji::after {
            content: '🎉';
            font-size: clamp(40px, 8vw, 60px);
            color: #fb7185;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
        }
        .options-container {
            display: flex;
            flex-wrap: wrap;
            gap: 2vw;
            justify-content: center;
            margin-bottom: 3vw;
        }
        .option {
            padding: 1.8vw 2.8vw;
            border: 1.5px solid #a855f7;
            border-radius: 10px;
            background: #ffedd5;
            cursor: #052419;
            transition: background 0.3s, transform 0.2s;
            font-size: clamp(13px, 2.1vw, 15px);
            line-height: 1.4;
            flex: 1 1 auto;
            min-width: 150px;
            max-width: 70%;
            font-family: 'Lora', serif;
            text-align: center;
        }
        .option:hover {
            background: #fed7aa;
            transform: scale(1.03);
        }
            
        .option.selected {
    background-color: #FFFF00 !important; /* Жовтий фон для вибраного */
    color: #000000 !important; /* Чорний текст для контрасту */
    border: 2px solid #FFD700 !important; /* Темніша жовта рамка */
    font-weight: bold; /* Жирний текст */
}

.option:focus {
    outline: 2px solid #FFD700; /* Фокус для доступності */
    outline-offset: 2px;
}
            
        button {
            background-color: #fb7185;
            color: #ffffff;
            border: none;
            border-radius: 25px;
            padding: clamp(10px, 2vw, 12px) clamp(20px, 4vw, 24px);
            font-size: clamp(16px, 3vw, 18px);
            font-family: 'Lora', serif;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        button:hover:not(:disabled) {
            background-color: #10b981;
        }
        button:disabled {
            background-color: #cbd5e1;
            cursor: not-allowed;
        }
        .result {
            margin-top: 3vw;
            font-size: clamp(16px, 2.5vw, 18px);
            font-family: 'Lora', serif;
        }
        .result-text {
            margin-top: 2vw;
            font-size: clamp(14px, 2vw, 16px);
            font-family: 'Lora', serif;
        }
        .completion-message {
            font-family: 'Lora', serif;
            font-weight: 700;
            color: #1e3a8a;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            background: linear-gradient(135deg, #bae6fd, #a5f3fc);
            border: 2.5px solid #1e3a8a;
            border-radius: 15px;
            padding: clamp(12px, 3vw, 18px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.25);
            margin: 2vw auto;
            max-width: 90%;
        }
        .completion-message h2 {
            font-size: clamp(22px, 4.5vw, 30px);
            margin: 0 0 1vw;
        }
        .completion-message p {
            font-size: clamp(18px, 3.5vw, 22px);
            margin: 0;
        }
        .math-notation-centered {
            display: block;
            text-align: center;
            width: 100%;
            font-size: clamp(16px, 2.8vw, 18px);
            margin: 5px 0;
            line-height: 1.4;
            color: #6d351a;
            font-family: 'Roboto', sans-serif;
        }
        mjx-container.math-notation-centered {
            display: inline-block !important;
            text-align: center !important;
            vertical-align: middle !important;
            white-space: nowrap !important;
            line-height: 1.4 !important;
            font-size: clamp(16px, 2.8vw, 18px) !important;
            color: #052419 !important;
            margin: 5px auto !important;
            padding: 0 !important;
        }
        mjx-container.math-notation-centered * {
            color: #a855f7 !important;
            font-style: italic !important;
        }
            .complex-plane mjx-container {
    color: #FFFF00 !important; /* Чистий жовтий колір для формул */
    font-style: italic;
    font-size: 17px !important;
}

        .feedback {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: clamp(24px, 5.8vw, 30px);
            font-family: 'Lora', serif;
            padding: 20px 30px;
            border-radius: 10px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
            z-index: 1001;
            opacity: 0;
            transition: opacity 0.5s ease;
            text-align: center;
        }
        .correct-feedback {
            color: #1e3a8a;
            background: #bae6fd;
            border: 2px solid #1e3a8a;
        }
        .incorrect-feedback {
            color: #dc2626;
            background: #fecaca;
            border: 2px solid #dc2626;
        }
        .input-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 2vw 0;
            width: 100%;
        }
        .input-group {
            display: flex;
            align-items: center;
            gap: clamp(10px, 2vw, 20px);
            font-size: clamp(16px, 3vw, 20px);
            font-family: 'Lora', serif;
            font-weight: 500;
            color: #1e293b;
        }
        .input-group strong {
            font-family: 'Lora', serif;
            font-size: clamp(15px, 2.3vw, 17px);
            color: #a855f7;
            white-space: nowrap;
            font-weight: 700;
        }
        .input-container input {
            border-radius: 50px;
            border: 2px solid #a855f7;
            padding: 10px 20px;
            font-size: clamp(16px, 2.5vw, 18px);
            font-family: 'Lora', serif;
            width: clamp(150px, 25vw, 200px);
            outline: none;
            transition: border-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
            background: linear-gradient(to bottom, #ffedd5, #fed7aa);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .input-container input:focus {
            border-color: #10b981;
            transform: scale(1.03);
            box-shadow: 0 0 12px rgba(16,185,129,0.4);
            background: #ffffff;
        }
        .input-container input::placeholder {
            color: #64748b;
            font-style: italic;
            font-size: clamp(13px, 2.1vw, 15px);
        }
        .input-group input {
            padding: 12px 18px;
            border: 2px solid transparent;
            border-radius: 10px;
            background: linear-gradient(to bottom, #ffedd5, #fed7aa);
            font-family: 'Lora', serif;
            font-size: clamp(14px, 2.2vw, 16px);
            width: clamp(160px, 30vw, 280px);
            transition: all 0.3s ease;
            outline: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            background-clip: padding-box;
            border-image: linear-gradient(to right, #a855f7, #ec4899) 1;
        }
        .input-group input:focus {
            transform: scale(1.03);
            box-shadow: 0 0 12px rgba(168,85,247,0.4);
            background: #ffffff;
            border-image: linear-gradient(to right, #ec4899, #a855f7) 1;
        }
        .navigation-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px auto;
            max-width: 1000px;
        }
        .nav-button {
            display: flex;
            align-items: center;
            background: #4682B4;
            color: #ffff00;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 16px;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .nav-button:hover {
            background: #1e3a8a;
            color: #ffffff;
            transform: scale(1.03);
        }
        .nav-button svg {
            margin-right: 8px;
            fill: currentColor;
        }
        .question-card {
            perspective: 1000px;
            margin: 20px auto;
            max-width: 964px;
            width: 100%;
            min-height: 150px;
            transition: transform 0.3s ease, opacity 0.3s ease;
            cursor: pointer;
        }
        .card-inner {
            position: relative;
            width: 100%;
            min-height: 150px;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            cursor: inherit;
        }
        .question-card.flipped .card-inner {
            transform: rotateY(180deg);
        }
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            min-height: 150px;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            text-align: center;
            cursor: inherit;
        }
        .card-front {
            background: #fefcbf;
            color: #6b21a8;
        }
        .card-back {
            background: #6b21a8;
            color: #ffffff;
            transform: rotateY(180deg);
            text-align: justify;
            padding: 20px;
            overflow: auto;
            white-space: normal;
        }
        .card-front span {
            display: block;
            text-align: justify;
            color: #4b1a6b;
            font-weight: 700;
            font-family: 'Lora', serif;
            font-size: clamp(16px, 2.8vw, 18px);
            line-height: 1.4;
            width: 100%;
        }
        .card-back span {
            display: block;
            max-width: 100%;
            word-wrap: break-word;
        }
            .exercise-container {
    display: flex;
    justify-content: center;
    gap: 20px;
   }

/* Стилі для кнопок вправ у #examplesModal */
#examplesModal .exercise-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 700px;
    height: 120px;
    padding: 15px;
    background-color: #008080;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    transition: transform 0.2s, box-shadow 0.2s;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    text-align: center;
    margin: 10px;
}

#examplesModal .exercise-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
    background: linear-gradient(135deg, #45a049, #4CAF50);
}

#examplesModal .btn-title {
    font-size: 28px !important; /* Збільшений шрифт для заголовка */
    font-weight: 700;
    color: #FFF5EE;
    margin: 0 0 10px 0;
    text-align: center;
    font-family: 'Arial', sans-serif;
}

#examplesModal .btn-description {
    font-size: 24px !important; /* Збільшений шрифт для опису */
    color: #FFFFE0;
    margin: 0;
    text-align: center;
    font-family: 'Arial', sans-serif;
}

#examplesModal .btn-description .math-formula {
    font-size: 25px !important; /* Збільшений шрифт для формул у тексті */
    font-style: italic;
    color: #ffff00;
}

#examplesModal .btn-description mjx-container {
    font-size: 24px !important; /* Збільшений шрифт для MathJax формул */
    color: #ffff00 !important;
    font-style: italic !important;
}

    /* Питання */
#trainerModal .math-notation-centered {
    font-size: clamp(18px, 3vw, 20px);
    color: #490849;
    font-family: 'Roboto', sans-serif;
    line-height: 1.5;
    text-align: center;
    margin: 5px 0;
}
       

/* Формули в питаннях */
#trainerModal .math-notation-centered mjx-container {
    font-size: clamp(18px, 3vw, 20px) !important;
    color: #92000a !important; /* Темно-червоний колір для формул */
    font-style: italic !important;
    display: inline-block !important;
    text-align: center !important;
    vertical-align: middle !important;
    margin: 5px auto !important;
}

/* Варіанти відповідей */
#trainerModal .option {
    font-size: clamp(18px, 3vw, 20px);
    color: #5c0a0a;
    font-family: 'Lora', serif;
    background: #ffedd5;
    padding: 1.8vw 2.8vw;
    border: 1.5px solid #a855f7;
    border-radius: 10px;
    text-align: center;
    line-height: 1.4;
    cursor: pointer;
    transition: background 0.3s, transform 0.2s;
    flex: 1 1 auto;
    min-width: 150px;
    max-width: 70%;
}
            .canvas-container {
    display: flex;
    justify-content: center;
    margin: 20px 0;
}
#complexPlaneCanvas {
    border: 1px solid #a855f7;
    border-radius: 5px;
    background-color: #ffffff;
}
            @media (max-width: 768px) {
 .figure-1-1 {
        width: 200px;
        height: 120px;
         max-width: 100%; /* Забезпечуємо адаптивність */
    }
 
    .figure-1-2 {
        width: 150px;
        height: 150px;
         max-width: 100%; /* Забезпечуємо адаптивність */
    }
 .figure.figure-1-3 {
        width: 200px;
        height: 150px;
         max-width: 100%; /* Забезпечуємо адаптивність */
    }
 .figure.figure-1-4,
    .figure.figure-1-5,
    .figure.figure-1-6 {
        width: 200px;
        height: 200px;
    }
            .title-box {
                margin-top: 40px;
                padding: 15px 20px;
            }
            .title-box h1 {
                font-size: 24px;
            }
            .section-container {
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }
            .section {
                width: 80%;
                height: 180px;
            }
            #theoryModal .modal-content {
                padding: 15px;
            }
            #theoryModal .modal-content details p {
                font-size: 15px;
                line-height: 1.5;
            }
            #theoryModal .modal-content details h3 {
                font-size: 18px;
            }
             /* Збільшення шрифту для тексту та заголовків у #theoryModal */
    #theoryModal .modal-content p {
        font-size: 18px !important; /* Більший шрифт для тексту */
        line-height: 1.6; /* Покращує читабельність */
    }

    #theoryModal .modal-content h3 {
        font-size: 20px !important; /* Більший шрифт для заголовків */
    }

    /* Збільшення шрифту для формул MathJax */
    #theoryModal .modal-content mjx-container {
        font-size: 18px !important; /* Більший шрифт для формул */
    }
            
            #theoryModal, #questionsModal, #trainerModal, #videoModal, #videoPlayerModal1, #videoPlayerModal2, #videoPlayerModal3 {
                top: 2%;
                left: 2%;
                width: 96%;
                height: 96%;
            }
            .complex-plane, .polar-form {
                overflow-x: auto;
                width: 100%;
            }
            .complex-plane > div, .polar-form > div {
                display: block;
                white-space: normal;
                word-wrap: break-word;
                width: 100%;
                text-align: justify;
            }
             .complex-plane mjx-container {
        font-size: 15px !important;
    }
            .complex-plane h3, .polar-form h3 {
                text-align: center;
                font-size: 18px;
            }
            .modal-content {
                padding: 15px;
            }
            .video-card {
        width: 180px; /* Зменшуємо ширину */
        height: 130px; /* Зменшуємо висоту */
        padding: 8px; /* Зменшуємо відступи */
    }
    .video-card img {
        width: 32px; /* Зменшуємо іконку */
        height: 32px;
    }
    .video-card h3 {
        font-size: 14px; /* Зменшуємо шрифт */
        line-height: 1.3; /* Покращуємо читабельність */
    }
            .question-card {
                min-height: 180px;
            }
            .card-front, .card-back {
                font-size: 14px;
                padding: 11px;
                line-height: 1.2;
                text-align: justify;
                word-wrap: break-word;
                overflow-wrap: break-word;
            }
            .card-front span {
                font-size: 14px;
                line-height: 1.2;
            }
            .trainer-container {
                width: 95%;
                padding: 4vw;
            }
            .question-circle, .completion-emoji {
                width: 25vw;
                height: 25vw;
                min-width: 80px;
                min-height: 80px;
            }
            .question-circle h3 {
                font-size: clamp(14px, 3vw, 16px);
            }
            .completion-emoji::after {
                font-size: clamp(30px, 7vw, 40px);
            }
            .options-container {
                gap: 1.5vw;
                flex-direction: column;
                align-items: center;
            }
             #questionsModal mjx-container {
    color: #FFFF00 !important;
    font-style: italic;
    font-size: 15px !important;
}

            .option {
                padding: 2.2vw 3.2vw;
                font-size: clamp(11px, 2.6vw, 13px);
                min-width: 120px;
                max-width: 95%;
            }
            button {
                padding: 3vw 5vw;
                font-size: clamp(12px, 3vw, 14px);
            }
            .feedback {
                font-size: clamp(24px, 5.8vw, 32px);
                padding: clamp(12px, 3.5vw, 18px) clamp(18px, 5vw, 25px);
                max-width: 95vw;
                word-wrap: break-word;
            }
            .completion-message {
                padding: clamp(10px, 3vw, 15px);
            }
            .completion-message h2 {
                font-size: clamp(20px, 4vw, 26px);
            }
            .completion-message p {
                font-size: clamp(16px, 3vw, 20px);
            }
            .navigation-buttons {
                margin: 20px auto;
                gap: 15px;
            }
            .nav-button {
                font-size: 16px;
                padding: 10px 20px;
            }
            .video-player-container {
                padding: 15px;
            }
            .video-player-container iframe {
                max-height: 300px;
            }
            .input-container {
                gap: 10px;
            }
            .input-group {
                gap: 10px;
            }
            .input-group label {
                font-size: clamp(12px, 2.2vw, 14px);
            }
            .input-container input {
                width: clamp(140px, 35vw, 220px);
                padding: 10px 15px;
                font-size: clamp(13px, 2.6vw, 15px);
            }
            .input-container input::placeholder {
                font-size: clamp(10px, 2vw, 13px);
            }
            .input-group strong {
                font-size: clamp(14px, 2.6vw, 16px);
            }
        }
            .exercise-container {
        flex-direction: column;
        align-items: center;
        gap: 15px;
    }
     #examplesModal .exercise-container {
        flex-direction: column;
        align-items: center;
        gap: 15px;
    }

    #examplesModal .exercise-btn {
        width: 100%;
        min-width: 400px;
        height: 150px;
        padding: 10px;
    }

    #examplesModal .btn-title {
        font-size: 22px !important; /* Збільшений для мобільних */
    }

    #examplesModal .btn-description {
        font-size: 20px !important; /* Збільшений для мобільних */
        text-align: justify;
    }

    #examplesModal .btn-description .math-formula {
        font-size: 20px !important;
    }

    #examplesModal .btn-description mjx-container {
        font-size: 20px !important;
    }
    #complexPlaneCanvas {
        width: 200px;
        height: 200px;
    }
     #trainerModal .option {
        font-size: clamp(18px, 2.8vw, 20px); /* Збільшено шрифт для мобільних */
        padding: 4vw 5vw;
        max-width: 95%; /* Максимально використовуємо доступний простір */
        min-width: 120px;
    }
}

        @media (max-width: 480px) {
.figure-1-1 {
        width: 150px;
        height: 90px;
    }
    .figure-1-2 {
        width: 120px;
        height: 120px;
    }
.figure.figure-1-3 {
        width: 150px;
        height: 150px;
    }
.figure.figure-1-4,
    .figure.figure-1-5,
    .figure.figure-1-6 {
        width: 180px;
        height: 180px;
    }
    .float-left {
        float: none; /* На малих екранах прибираємо обтікання */
        margin: 10px auto; /* Центруємо зображення */
        display: block;
    }

            .title-box {
                margin-top: 20px;
                padding: 10px 15px;
            }
            .title-box h1 {
                font-size: 20px;
            }
            .section {
                width: 90%;
                height: 150px;
            }
            .section img {
                width: 50px;
                height: 50px;
            }
            .section h2 {
                font-size: 18px;
            }
            .modal-content {
                padding: 10px;
            }
            .modal-header {
                padding: 5px 8px;
            }
            .close-btn {
                font-size: 14px;
                padding: 4px 10px;
            }
            .video-card {
        width: 180px; /* Зменшуємо ширину */
        height: 130px; /* Зменшуємо висоту */
        padding: 8px; /* Зменшуємо відступи */
    }
    .video-card img {
        width: 32px; /* Зменшуємо іконку */
        height: 32px;
    }
    .video-card h3 {
        font-size: 14px; /* Зменшуємо шрифт */
        line-height: 1.3; /* Покращуємо читабельність */
    }
            .question-card {
                min-height: 200px;
            }
            .card-inner {
                min-height: 200px;
            }
            .card-front, .card-back {
                min-height: 200px;
                font-size: 13px;
                padding: 6px;
                line-height: 1.1;
                text-align: justify;
                word-wrap: break-word;
                overflow-wrap: break-word;
            }
            .card-front span {
                font-size: 13px;
                line-height: 1.1;
            }
            .card-back .MathJax {
                font-size: 0.9em;
            }
            .trainer-container {
                padding: 5vw;
            }
            #theoryModal .modal-content {
                padding: 10px;
            }
            #theoryModal .modal-content details p {
                font-size: 14px;
                line-height: 1.4;
            }
            #theoryModal .modal-content details h3 {
                font-size: 16px;
            }
            .complex-plane, .polar-form {
                overflow-x: auto;
                width: 100%;
            }
            .complex-plane > div, .polar-form > div {
                display: block;
                white-space: normal;
                word-wrap: break-word;
                width: 100%;
                text-align: justify;
            }
             .complex-plane mjx-container {
        font-size: 14px !important;
    }
            .complex-plane h3, .polar-form h3 {
                text-align: center;
                font-size: 16px;
            }
            .question-circle, .completion-emoji {
                width: 25vw;
                height: 25vw;
                min-width: 60px;
                min-height: 60px;
            }
            .completion-emoji::after {
                font-size: clamp(25px, 6vw, 35px);
            }
            .option {
                font-size: clamp(10px, 2.3vw, 12px);
                padding: 2.8vw 3.8vw;
                min-width: 100px;
                max-width: 95%;
            }
            .feedback {
                font-size: clamp(22px, 5.2vw, 28px);
                padding: clamp(10px, 3vw, 15px) clamp(15px, 4.5vw, 20px);
                max-width: 95vw;
            }
            .completion-message {
                padding: clamp(10px, 3vw, 15px);
            }
            .completion-message h2 {
                font-size: clamp(18px, 3.5vw, 22px);
            }
            .completion-message p {
                font-size: clamp(14px, 3vw, 18px);
            }
            .navigation-buttons {
                margin: 15px auto;
                gap: 10px;
            }
            .nav-button {
                font-size: 14px;
                padding: 8px 16px;
            }
            .video-player-container {
                padding: 10px;
            }
            .video-player-container iframe {
                max-height: 200px;
            }
            .math-notation-centered {
                font-size: clamp(14px, 2.5vw, 16px);
                line-height: 1.2;
            }
            mjx-container.math-notation-centered {
                font-size: clamp(14px, 2.5vw, 16px) !important;
                line-height: 1.2 !important;
            }
            mjx-container {
                font-size: 13px !important;
            }
            .input-group label {
                font-size: clamp(11px, 2vw, 13px);
            }
            .input-group {
                gap: 8px;
                flex-wrap: wrap;
                justify-content: center;
            }
            .input-container input {
                width: clamp(120px, 45vw, 200px);
                padding: 8px 12px;
                font-size: clamp(12px, 2.9vw, 14px);
            }
            .input-container input::placeholder {
                font-size: clamp(9px, 1.8vw, 12px);
            }
            .input-group strong {
                font-size: clamp(13px, 2.9vw, 15px);
            }
        }
        mjx-frac {
            font-size: 1.2em !important;
        }
        mjx-container:not(:has(mjx-frac)) {
            font-size: inherit !important;
        }
        mjx-frac mjx-num, mjx-frac mjx-den {
            padding: 2px !important;
        }
        #videoPlayerModal4 {
    display: none;
    position: fixed;
    top: 5%;
    left: 5%;
    width: 90%;
    height: 90%;
    background: linear-gradient(135deg, #2dd4bf, #1e3a8a);
    border-radius: 15px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    z-index: 1000;
    overflow: hidden;
    flex-direction: column;
}
              #examplesModal .exercise-btn {
        width: 90%;
        min-width: 270px;
        height: 130px;
        padding: 8px;
    }

    #examplesModal .btn-title {
        font-size: 20px !important; /* Збільшений для малих екранів */
    }

    #examplesModal .btn-description {
        font-size: 19px !important; /* Збільшений для малих екранів */
        text-align: justify;
    }

    #examplesModal .btn-description .math-formula {
        font-size: 19px !important;
    }

    #examplesModal .btn-description mjx-container {
        font-size: 19px !important;
    }

    /* Виправлення глобального стилю mjx-container */
    mjx-container {
        font-size: inherit !important; /* Спадкування розміру шрифту від батьківського елемента */
    }
     #complexPlaneCanvas {
        width: 150px;
        height: 150px;
    }
      #trainerModal .option {
        font-size: clamp(16px, 2.8vw, 18px); /* Збільшено шрифт для маленьких екранів */
        padding: 3vw 4vw;
        max-width: 98%; /* Залишаємо більше простору */
        min-width: 100px;
    }
}
    </style>
</head> 
<body>
    <div class="title-box">
        <h1>4. Геометрична інтерпретація комплексних чисел</h1>
    </div>

    <div class="section-container">
        <div class="section" id="openTheoryBtn">
            <img src="https://img.icons8.com/fluency/96/book-shelf.png" alt="Книга">
            <h2>Теоретичні відомості</h2>
        </div>
        <div class="section" id="openVideoBtn">
            <img src="https://img.icons8.com/fluency/96/video.png" alt="Відео">
            <h2>Відеоматеріали</h2>
        </div>
        <div class="section" id="openExamplesBtn">
            <img src="https://img.icons8.com/fluency/96/puzzle.png" alt="Пазл">
            <h2>Інтерактивні вправи</h2>
        </div>
        <div class="section" id="openQuestionsBtn">
            <img src="https://img.icons8.com/fluency/96/flipboard.png" alt="Картки">
            <h2>Питання і відповіді</h2>
        </div>
        <div class="section" id="openTrainerBtn">
            <img src="https://img.icons8.com/fluency/96/flash-on.png" alt="Тренажер">
            <h2>Тренажер</h2>
        </div>
    </div>

    <div class="navigation-buttons">
        <a class="nav-button" href='tema1.html'>
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
                <path d="M15 18l-6-6 6-6"/>
            </svg>
            До теми 1
        </a>
       <a class="nav-button" href='index.html'>
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
                <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
            </svg>
            На головну
        </a>
    </div>

    <div id="theoryModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="theoryTitle">
        <div class="modal-header">
            <button class="close-btn" id="closeTheoryBtn" aria-label="Закрити">× Закрити</button>
        </div>
        <div class="modal-content">
            <details class="complex-plane">
                <summary>Геометричне представлення комплексних чисел</summary>
                <div>
                    <p>У шкільному курсі геометрії ви вивчали, що кожну точку на площині можна однозначно задати парою чисел \( (x, y) \), які є її координатами. Це правило працює в обидва боки: знаючи координати, можна знайти точку, і навпаки – кожній точці на площині відповідає єдина пара чисел \( (x, y) \). Для цього використовують декартову систему координат. Таким чином, будь-якій парі чисел \( (a; b) \) відповідає єдина точка \( M(a; b) \), де \( a \) – абсциса (координата по горизонталі), а \( b \) – ордината (координата по вертикалі).</p>
                    <img src="static/figure1.1.jpg" alt="Рисунок 1.1 - Декартова система координат" class="figure figure-1-1" />
                    <p>Тепер застосуємо цей підхід до комплексних чисел. Виявляється, що кожному комплексному числу \( z = a + bi \) можна поставити у відповідність точку на площині. При цьому:</p>
                    <ul>
                        <li>Число \( a \) (дійсна частина) відкладається по горизонтальній осі \( Ox \), яка називається дійсною віссю.</li>
                        <li>Число \( b \) (уявна частина) відкладається по вертикальній осі \( Oy \), яка називається уявною віссю.</li>
                    </ul>
                    <p>Цей зв’язок також працює в обидва боки: якщо задано комплексне число \( z = a + bi \), то йому відповідає точка \( M(a; b) \) на площині; якщо задано точку \( M(a; b) \), то можна записати відповідне комплексне число \( z = a + bi \).</p>
                    <p>Площину, на якій комплексним числам відповідають точки, називають комплексною площиною. На цій площині горизонтальна вісь \( (Ox) \) є дійсною віссю, на якій розташовані дійсні числа, а вертикальна вісь \( (Oy) \) є уявною віссю, на якій знаходяться чисто уявні числа.</p>
                    <p>На рисунку 1.1 показано, як комплексне число \( z = a + bi \) відображається як точка \( M(a, b) \) на комплексній площині.</p>
                    <p>Наприклад,</p>
                    <ul>
                        <li>числу \( 3 + 4i \) відповідає точка \( A(3; 4) \),</li>
                        <li>числу \( -5 + i \) відповідає точка \( B(-5; 1) \),</li>
                        <li>числу \( 6 + 0i \) відповідає точка \( C(6; 0) \) (збігається з точкою на дійсній осі),</li>
                        <li>числу \( 0 - 3i \) відповідає точка \( D(0; -3) \) (збігається з точкою на уявній осі) (рис. 1.2).</li>
                    </ul>
                    <img src="static/figure1.2.jpg" alt="Рисунок 1.2 - Приклади точок комплексних чисел" class="figure figure-1-2" />
                    <p>Таким чином, кожному комплексному числу \( a + bi \) відповідає єдина точка з координатами \( (a; b) \), і навпаки – кожній точці \( (a; b) \) відповідає комплексне число \( a + bi \).</p>
                </div>
            </details>

            <details class="complex-plane">
                <summary>Комплексні числа як вектори</summary>
                <div>
                    <p>Комплексні числа можна зображати не лише як точки, але й як вектори на комплексній площині. Для комплексного числа \( z = a + bi \) будується радіус-вектор \( \overrightarrow{OM} \), де \( O(0; 0) \) – початок координат, \( M(a; b) \) – точка, що відповідає комплексному числу \( z \). Таким чином, вектор \( \overrightarrow{OM} \) починається в точці \( O(0; 0) \) і закінчується в точці \( M(a; b) \) (рис. 1.3).</p>
                    <img src="static/figure1.3.jpg" alt="Рисунок 1.3 - Комплексні числа як вектори" class="figure figure-1-3" />
                    <p>Таке представлення працює в обидва боки: кожному комплексному числу \( z = a + bi \) відповідає єдиний вектор \( \overrightarrow{OM} \), і навпаки – кожному вектору \( \overrightarrow{OM} \) відповідає комплексне число \( z = a + bi \).</p>
                    <p>Зображення комплексних чисел у вигляді радіус-векторів дає можливість геометрично пояснювати дії додавання та віднімання.</p>
                </div>
            </details>

            <details class="complex-plane">
                <summary>Додавання, віднімання комплексних чисел (геометрично)</summary>
                <div>
                    <h3 style="text-align: center; color: #FFB6B6;">Додавання комплексних чисел</h3>
                    <p>Нехай комплексним числам \( z_1 = a_1 + b_1 i \) та \( z_2 = a_2 + b_2 i \) відповідають радіус-вектори \( \overrightarrow{OA_1}(a_1; b_1) \) і \( \overrightarrow{OA_2}(a_2; b_2) \) відповідно (рис. 1.4).</p>
                    <p>Додавання векторів \( \overrightarrow{OA_1} \) і \( \overrightarrow{OA_2} \) виконується за правилом паралелограма: діагональ паралелограма, побудованого на цих векторах, є новим вектором:</p>
                    <p style="text-align: center;">\( \overrightarrow{OA_3} = \overrightarrow{OA_1} + \overrightarrow{OA_2}, \)</p>
                    <p>який відповідає сумі комплексних чисел \( z_1 + z_2 \) (рис. 1.4).</p>
                    <p>Його координати визначаються як:</p>
                    <p style="text-align: center;">\( \overrightarrow{OA_3}(a_1 + a_2; b_1 + b_2). \)</p>
                    <img src="static/figure1.4.jpg" alt="Рисунок 1.4 - Додавання комплексних чисел" class="figure figure-1-4" />
                    
                    <h3 style="text-align: center; color: #FFB6B6;">Віднімання комплексних чисел</h3>
                    <p>Оскільки віднімання є оберненою дією до додавання, його також можна представити.</p>
                    <p>Нехай вектори \( \overrightarrow{OA_1}(a_1; b_1) \) та \( \overrightarrow{OA_2}(a_2; b_2) \) відповідно відповідають комплексним числам \( z_1 \) і \( z_2 \). Різниця \( z_2 - z_1 \) геометрично відповідає вектору \( \overrightarrow{A_1 A_2} \), який визначається як:</p>
                    <p style="text-align: center;">\( \overrightarrow{A_1 A_2} = \overrightarrow{OA_2} - \overrightarrow{OA_1}. \)</p>
                    <p>Щоб отримати точку \( A_3 \), яка відповідає числу \( z_2 - z_1 \), необхідно паралельно перенести вектор \( \overrightarrow{A_1 A_2} \) так, щоб його початок збігся з початком координат (рис. 1.5). У результаті отримуємо вектор \( \overrightarrow{OA_3} \), що представляє різницю \( z_2 - z_1 \).</p>
                    <p>Його координати:</p>
                    <p style="text-align: center;">\( \overrightarrow{OA_3}(a_2 - a_1; b_2 - b_1). \)</p>
                    <img src="static/figure1.5.jpg" alt="Рисунок 1.5 - Віднімання комплексних чисел (перший спосіб)" class="figure figure-1-5" />
                    <p>Альтернативно віднімання можна виконати за правилом паралелограма. Будується протилежний вектор \( -z_1 = -\overrightarrow{OA_1} \), тобто вектор, протилежний до \( \overrightarrow{OA_1} \). Тоді додаються вектори \( \overrightarrow{OA_2} + (-\overrightarrow{OA_1}) \) за правилом паралелограма. У результаті отримуємо вектор \( \overrightarrow{OA_3} \), що відповідає різниці \( z_2 - z_1 \).</p>
                    <img src="static/figure1.6.jpg" alt="Рисунок 1.6 - Віднімання комплексних чисел (альтернативний спосіб)" class="figure figure-1-6" />
                </div>
            </details>
        </div>
    </div>

    <div id="videoModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="videoTitle">
        <div class="modal-header">
            <button class="close-btn" id="closeVideoBtn" aria-label="Закрити">× Закрити</button>
        </div>
        <div class="modal-content">
            <h2 style="text-align: center; color: #1e3a8a;">Оберіть відео</h2>
            <div class="video-card-container">
                <div class="video-card" data-video="1">
                     <img src="https://img.icons8.com/?size=100&id=345GEAQ7pVWU&format=png&color=000000" alt="Відеокамера">
                    <h3>Комплексна площина</h3>
                </div>
                <div class="video-card" data-video="2">
                    <img src="https://img.icons8.com/?size=100&id=345GEAQ7pVWU&format=png&color=000000" alt="Відеокамера">
                    <h3>Квадратне рівняння. Геометричне представлення комплексних чисел</h3>
                </div>
                <div class="video-card" data-video="3">
                    <img src="https://img.icons8.com/?size=100&id=345GEAQ7pVWU&format=png&color=000000" alt="Відеокамера">
                    <h3>Graphing Complex Numbers</h3>
                </div>
                <div class="video-card" data-video="4">
                     <img src="https://img.icons8.com/?size=100&id=345GEAQ7pVWU&format=png&color=000000" alt="Відеокамера">
                    <h3>Visualizing Adding and Subtracting Complex Numbers</h3>
                </div>
            </div>
        </div>
    </div>

    <div id="videoPlayerModal1" class="modal" role="dialog" aria-modal="true" aria-labelledby="videoPlayerTitle1">
        <div class="modal-header">
            <button class="close-btn" id="closeVideoPlayerBtn1" aria-label="Закрити">× Закрити</button>
        </div>
        <div class="modal-content">
            <div class="video-player-container">
                <div id="youtubePlayer1"></div>
            </div>
        </div>
    </div>
    <div id="videoPlayerModal2" class="modal" role="dialog" aria-modal="true" aria-labelledby="videoPlayerTitle2">
        <div class="modal-header">
            <button class="close-btn" id="closeVideoPlayerBtn2" aria-label="Закрити">× Закрити</button>
        </div>
        <div class="modal-content">
            <div class="video-player-container">
                <div id="youtubePlayer2"></div>
            </div>
        </div>
    </div>
    <div id="videoPlayerModal3" class="modal" role="dialog" aria-modal="true" aria-labelledby="videoPlayerTitle3">
        <div class="modal-header">
            <button class="close-btn" id="closeVideoPlayerBtn3" aria-label="Закрити">× Закрити</button>
        </div>
        <div class="modal-content">
            <div class="video-player-container">
                <div id="youtubePlayer3"></div>
            </div>
        </div>
    </div>
    <div id="videoPlayerModal4" class="modal" role="dialog" aria-modal="true" aria-labelledby="videoPlayerTitle4">
        <div class="modal-header">
            <button class="close-btn" id="closeVideoPlayerBtn4" aria-label="Закрити">× Закрити</button>
        </div>
        <div class="modal-content">
            <div class="video-player-container">
                <div id="youtubePlayer4"></div>
            </div>
        </div>
    </div>

   <div id="questionsModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="questionsTitle">
    <div class="modal-header">
        <button class="close-btn" id="closeQuestionsBtn" aria-label="Закрити">× Закрити</button>
    </div>
    <div class="modal-content">
        <h2 style="text-align: center; color: #1e3a8a;">Питання і відповіді</h2>
        <div class="question-card">
            <div class="card-inner">
                <div class="card-front">
                    <span>Як називається площина, на якій зображуються комплексні числа?</span>
                </div>
                <div class="card-back">
                    <span>Площину, на якій комплексним числам відповідають точки, називають комплексною площиною. На цій площині кожному комплексному числу \( z = a + bi \) відповідає точка з координатами \( (a; b) \), і навпаки — кожній точці \( (a; b) \) відповідає комплексне число \( z = a + bi \).</span>
                </div>
            </div>
        </div>
        <div class="question-card">
            <div class="card-inner">
                <div class="card-front">
                    <span>Як називаються вісь абсцис і вісь ординат на комплексній площині?</span>
                </div>
                <div class="card-back">
                    <span>На комплексній площині горизонтальна вісь \( Ox \) називається дійсною віссю, оскільки на ній відкладається дійсна частина комплексного числа. Вертикальна вісь \( Oy \) називається уявною віссю, оскільки на ній відкладається уявна частина комплексного числа. Таким чином, абсциса  — це дійсна частина \( a \), а ордината — це уявна частина \( b \) у записі \( z = a + bi \).</span>
                </div>
            </div>
        </div>
        <div class="question-card">
            <div class="card-inner">
                <div class="card-front">
                    <span>Як геометрично зображується комплексне число на комплексній площині?</span>
                </div>
                <div class="card-back">
                    <span>Комплексне число \( z = a + bi \) геометрично зображується як точка \( M(a; b) \) або радіус-вектор, що починається в початку координат \( O(0; 0) \) і закінчується в точці \( M(a; b) \). Це означає, що кожному комплексному числу відповідає певний вектор \( \overrightarrow{OM} \), і навпаки — кожному такому вектору відповідає єдине комплексне число.</span>
                </div>
            </div>
        </div>
        <div class="question-card">
            <div class="card-inner">
                <div class="card-front">
                    <span>Як геометрично зображуються додавання та віднімання комплексних чисел на комплексній площині?</span>
                </div>
                <div class="card-back">
                    <span>Додавання комплексних чисел \( z_1 \) і \( z_2 \) зображується як побудова паралелограма: якщо два комплексні числа подати як радіус-вектори, то вектор, що відповідає їхній сумі, є діагоналлю паралелограма, побудованого на цих двох векторах. Віднімання \( z_1 - z_2 \) зображується як вектор, проведений від кінця вектора \( z_2 \) до кінця вектора \( z_1 \). Альтернативно, можна зобразити число \( -z_2 \) і додати його до \( z_1 \) за правилом паралелограма.</span>
                </div>
            </div>
        </div>
    </div>
</div>
    <div id="trainerModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="trainerTitle">
        <div class="modal-header">
            <button class="close-btn" id="closeTrainerBtn" aria-label="Закрити">× Закрити</button>
        </div>
        <div class="modal-content">
            <div class="trainer-container" id="trainerContent"></div>
        </div>
    </div>
            <div id="examplesModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="examplesTitle">
    <div class="modal-header">
        <button class="close-btn" id="closeExamplesBtn" aria-label="Закрити">× Закрити</button>
    </div>
    <div class="modal-content">
        <div class="exercise-container">
            <button class="exercise-btn" id="exercise1Btn" aria-label="Відкрити Завдання 1">
                <h3 class="btn-title">Завдання 1:</h3>
                <p class="btn-description">Позначити точку для заданого комплексного числа <span class="math-formula">\( z = a + b i \)</span>.</p>
            </button>
            <button class="exercise-btn" id="exercise2Btn" aria-label="Відкрити Завдання 2">
                <h3 class="btn-title">Завдання 2:</h3>
                <p class="btn-description">Побудувати вектор, що відповідає комплексному числу <span class="math-formula">\( z = a + b i \)</span>.</p>
            </button>
            <button class="exercise-btn" id="exercise3Btn" aria-label="Відкрити Завдання 3">
                <h3 class="btn-title">Завдання 3:</h3>
                <p class="btn-description">Геометричне додавання комплексних чисел <span class="math-formula">\( z_1 + z_2 \)</span>, де <span class="math-formula">\( z_1 = a_1 + b_1 i \)</span>, <span class="math-formula">\( z_2 = a_2 + b_2 i \).</span></p>
            </button>
            <button class="exercise-btn" id="exercise4Btn" aria-label="Відкрити Завдання 4">
                <h3 class="btn-title">Завдання 4:</h3>
                <p class="btn-description">Геометричне віднімання комплексних чисел <span class="math-formula">\( z_1 - z_2 \)</span>, де <span class="math-formula">\( z_1 = a_1 + b_1 i \)</span>, <span class="math-formula">\( z_2 = a_2 + b_2 i \).</span></p>
            </button>
        </div>
    </div>
</div>
    <div id="modalOverlay"></div>

    <script>
document.addEventListener('DOMContentLoaded', function () {
    console.log('DOM завантажено');

    // Позначаємо body як завантажений після ініціалізації
    const finalizePageLoad = () => {
        document.body.classList.add('loaded');
        console.log('Body відображено');
    };

    const elements = {
        openTheoryBtn: document.getElementById('openTheoryBtn'),
        openVideoBtn: document.getElementById('openVideoBtn'),
        openQuestionsBtn: document.getElementById('openQuestionsBtn'),
        openTrainerBtn: document.getElementById('openTrainerBtn'),
        openExamplesBtn: document.getElementById('openExamplesBtn'),
        theoryModal: document.getElementById('theoryModal'),
        videoModal: document.getElementById('videoModal'),
        questionsModal: document.getElementById('questionsModal'),
        trainerModal: document.getElementById('trainerModal'),
        examplesModal: document.getElementById('examplesModal'),
        videoPlayerModal1: document.getElementById('videoPlayerModal1'),
        videoPlayerModal2: document.getElementById('videoPlayerModal2'),
        videoPlayerModal3: document.getElementById('videoPlayerModal3'),
        videoPlayerModal4: document.getElementById('videoPlayerModal4'),
        closeTheoryBtn: document.getElementById('closeTheoryBtn'),
        closeVideoBtn: document.getElementById('closeVideoBtn'),
        closeQuestionsBtn: document.getElementById('closeQuestionsBtn'),
        closeTrainerBtn: document.getElementById('closeTrainerBtn'),
        closeExamplesBtn: document.getElementById('closeExamplesBtn'),
        closeVideoPlayerBtn1: document.getElementById('closeVideoPlayerBtn1'),
        closeVideoPlayerBtn2: document.getElementById('closeVideoPlayerBtn2'),
        closeVideoPlayerBtn3: document.getElementById('closeVideoPlayerBtn3'),
        closeVideoPlayerBtn4: document.getElementById('closeVideoPlayerBtn4'),
        exercise1Btn: document.getElementById('exercise1Btn'),
        exercise2Btn: document.getElementById('exercise2Btn'),
        exercise3Btn: document.getElementById('exercise3Btn'),
        exercise4Btn: document.getElementById('exercise4Btn'),
        modalOverlay: document.getElementById('modalOverlay')
    };

    // Перевірка URL-параметра для автоматичного відкриття examplesModal
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('openExamplesModal') === 'true') {
        console.log('🔵 Знайдено параметр openExamplesModal=true');
        if (elements.examplesModal) {
            console.log('✅ Відкривається #examplesModal');
            toggleModal(elements.examplesModal, true);
            window.history.replaceState({}, document.title, window.location.pathname);
            finalizePageLoad();
        } else {
            console.error('Помилка: Елемент #examplesModal не знайдено');
            alert('Помилка: Не вдалося відкрити модальне вікно вправ.');
            finalizePageLoad();
        }
    } else {
        finalizePageLoad();
    }

    let youtubeApiReady = false;
    let player1, player2, player3, player4;
    const videoIds = {
        '1': 'QMw45uwT7Uo',
        '2': '09iwX4swKAk',
        '3': 'WaOpP_xcA4M',
        '4': '6HQBlrl7Cdw'
    };

    // Змінні для тренажера
    let currentGroupIndex = 0;
    let score = 0;
    let currentQuestion = null;

    // Функція для генерації випадкового цілого числа в межах [min, max]
    function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    // Функція для форматування комплексного числа у LaTeX
    function formatComplexNumber(a, b) {
        if (b === 0) return `${a}`;
        if (a === 0) return b === 1 ? `i` : b === -1 ? `-i` : `${b}i`;
        if (b === 1) return `${a} + i`;
        if (b === -1) return `${a} - i`;
        return `${a} ${b > 0 ? '+' : '-'} ${Math.abs(b)}i`;
    }

    // Функція для перемішування масиву
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    // Функція для малювання системи координат із точкою M
   function drawComplexPlane(canvasId, pointX, pointY, isVector = false) {
    const canvas = document.getElementById(canvasId);
    if (!canvas) return;
    const ctx = canvas.getContext('2d');
    const width = canvas.width;
    const height = canvas.height;

    // Очистка полотна
    ctx.clearRect(0, 0, width, height);
    ctx.fillStyle = '#ffffff';
    ctx.fillRect(0, 0, width, height);

    // Налаштування масштабу (1 одиниця = 20 пікселів)
    const scale = 20;
    const originX = width / 2;
    const originY = height / 2;

    // Малювання сітки
    ctx.beginPath();
    ctx.strokeStyle = '#d3d3d3'; // Світло-сірий колір
    ctx.lineWidth = 0.5;
    for (let i = -5; i <= 5; i++) {
        ctx.moveTo(originX + i * scale, 0);
        ctx.lineTo(originX + i * scale, height);
    }
    for (let i = -5; i <= 5; i++) {
        ctx.moveTo(0, originY - i * scale);
        ctx.lineTo(width, originY - i * scale);
    }
    ctx.stroke();

    // Малювання осей
    ctx.beginPath();
    ctx.strokeStyle = '#000000';
    ctx.lineWidth = 2;
    ctx.moveTo(0, originY);
    ctx.lineTo(width, originY);
    ctx.moveTo(originX, 0);
    ctx.lineTo(originX, height);
    ctx.stroke();

    // Малювання стрілок
    ctx.beginPath();
    ctx.moveTo(width - 10, originY - 5);
    ctx.lineTo(width, originY);
    ctx.lineTo(width - 10, originY + 5);
    ctx.moveTo(originX - 5, 10);
    ctx.lineTo(originX, 0);
    ctx.lineTo(originX + 5, 10);
    ctx.fillStyle = '#000000';
    ctx.fill();

    // Мітки на осях
    ctx.font = '14px Arial';
    ctx.fillStyle = '#000000';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'top';
    for (let i = -5; i <= 5; i++) {
        if (i !== 0) {
            ctx.fillText(i, originX + i * scale, originY + 5);
            ctx.beginPath();
            ctx.moveTo(originX + i * scale, originY - 3);
            ctx.lineTo(originX + i * scale, originY + 3);
            ctx.stroke();
        }
    }
    ctx.textAlign = 'right';
    ctx.textBaseline = 'middle';
    for (let i = -5; i <= 5; i++) {
        if (i !== 0) {
            ctx.fillText(i, originX - 5, originY - i * scale);
            ctx.beginPath();
            ctx.moveTo(originX - 3, originY - i * scale);
            ctx.lineTo(originX + 3, originY - i * scale);
            ctx.stroke();
        }
    }

    // Позначки x, y
    ctx.textAlign = 'left';
    ctx.fillText('x', width - 15, originY + 15);
    ctx.textAlign = 'center';
    ctx.fillText('y', originX + 15, 15);

    if (isVector) {
        // Малювання вектора
        const endX = originX + pointX * scale;
        const endY = originY - pointY * scale;
        ctx.beginPath();
        ctx.strokeStyle = '#ff0000';
        ctx.lineWidth = 2;
        ctx.moveTo(originX, originY);
        ctx.lineTo(endX, endY);
        ctx.stroke();

        // Малювання стрілки на кінці вектора
        const angle = Math.atan2(-pointY, pointX);
        const arrowSize = 8;
        ctx.beginPath();
        ctx.moveTo(endX, endY);
        ctx.lineTo(
            endX - arrowSize * Math.cos(angle + Math.PI / 6),
            endY - arrowSize * Math.sin(angle + Math.PI / 6)
        );
        ctx.moveTo(endX, endY);
        ctx.lineTo(
            endX - arrowSize * Math.cos(angle - Math.PI / 6),
            endY - arrowSize * Math.sin(angle - Math.PI / 6)
        );
        ctx.stroke();

        // Позначка "z" біля кінця вектора
        ctx.fillStyle = '#ff0000';
        ctx.fillText('z', endX + 10, endY - 10);
    } else {
        // Малювання точки M (для третього питання)
        ctx.beginPath();
        ctx.arc(originX + pointX * scale, originY - pointY * scale, 4, 0, 2 * Math.PI);
        ctx.fillStyle = '#ff0000';
        ctx.fill();
        ctx.fillText('M', originX + pointX * scale + 10, originY - pointY * scale - 10);
    }
}

    // Функція для генерації питання та варіантів відповідей
   function generateQuestion(groupIndex) {
    let a = getRandomInt(-5, 5);
    let b = getRandomInt(-5, 5);
    // Уникаємо тривіальних випадків (a = b, a = 0, b = 0) для питань 1–3
    if (groupIndex <= 2) {
        while (a === b || a === 0 || b === 0) {
            a = getRandomInt(-5, 5);
            b = getRandomInt(-5, 5);
        }
    } else {
        // Для питань 4–5 уникаємо вектора (0; 0)
        while (a === 0 && b === 0) {
            a = getRandomInt(-5, 5);
            b = getRandomInt(-5, 5);
        }
    }

    // Лог для діагностики
    console.log(`Generating question ${groupIndex + 1} with a=${a}, b=${b}`);

    if (groupIndex === 0) {
        const correctAnswer = `\\((${a}; ${b})\\)`;
        const optionsSet = new Set([correctAnswer]);
        const possibleOptions = [
            `\\((${b}; ${a})\\)`,
            `\\((${a}; ${-b})\\)`,
            `\\(${a === 1 ? '(-1; ' : '(1; '}${b})\\)`
        ];
        // Додаємо унікальні варіанти
        for (let opt of possibleOptions) {
            if (!optionsSet.has(opt)) {
                optionsSet.add(opt);
            }
        }
        const options = Array.from(optionsSet);
        console.log('Question 1 options:', options);
        shuffleArray(options);
        return {
            type: 'multiple',
            question: `Задано комплексне число \\( z = ${formatComplexNumber(a, b)} \\). Знайти координати точки на площині \\( xOy \\), які відповідають числу \\( z \\).`,
            options: options,
            correct: correctAnswer
        };
    } else if (groupIndex === 1) {
        const correctAnswer = `\\(${formatComplexNumber(a, b)}\\)`;
        const optionsSet = new Set([correctAnswer]);
        const possibleOptions = [
            `\\(${formatComplexNumber(b, a)}\\)`,
            `\\(${formatComplexNumber(a, -b)}\\)`,
            `\\(${formatComplexNumber(-a, b)}\\)`
        ];
        for (let opt of possibleOptions) {
            if (!optionsSet.has(opt)) {
                optionsSet.add(opt);
            }
        }
        const options = Array.from(optionsSet);
        console.log('Question 2 options:', options);
        shuffleArray(options);
        return {
            type: 'multiple',
            question: `Яке комплексне число відповідає точці \\( (${a}; ${b}) \\) на комплексній площині?`,
            options: options,
            correct: correctAnswer
        };
    } else if (groupIndex === 2) {
        const correctAnswer = `\\(${formatComplexNumber(a, b)}\\)`;
        const optionsSet = new Set([correctAnswer]);
        const possibleOptions = [
            `\\(${formatComplexNumber(b, a)}\\)`,
            `\\(${formatComplexNumber(a, -b)}\\)`,
            `\\(${formatComplexNumber(-a, b)}\\)`
        ];
        for (let opt of possibleOptions) {
            if (!optionsSet.has(opt)) {
                optionsSet.add(opt);
            }
        }
        const options = Array.from(optionsSet);
        console.log('Question 3 options:', options);
        shuffleArray(options);
        return {
            type: 'multiple',
            question: `Вказати, якому комплексному числу відповідає точка \\( M \\), зображена на рисунку:`,
            options: options,
            correct: correctAnswer,
            point: { x: a, y: b }
        };
    } else if (groupIndex === 3) {
        // Питання про суму z1 + z2
        const c = getRandomInt(-3, 3);
        const d = getRandomInt(-3, 3);
        const z1 = formatComplexNumber(c, d);
        const z2 = formatComplexNumber(a - c, b - d); // z1 + z2 = a + bi
        const correctAnswer = `\\(z_1 = ${z1}, z_2 = ${z2}\\)`;
        const optionsSet = new Set([correctAnswer]);
        const possibleOptions = [
            `\\(z_1 = ${formatComplexNumber(c, d)}, z_2 = ${formatComplexNumber(-a + c, b - d)}\\)` , // Дає (-a; b)
            `\\(z_1 = ${formatComplexNumber(c, d)}, z_2 = ${formatComplexNumber(a - c, -b + d)}\\)` , // Дає (a; -b)
            `\\(z_1 = ${formatComplexNumber(-c, -d)}, z_2 = ${formatComplexNumber(-a + c, -b + d)}\\)` // Дає (-a; -b)
        ];
        for (let opt of possibleOptions) {
            if (!optionsSet.has(opt)) {
                optionsSet.add(opt);
            }
        }
        const options = Array.from(optionsSet);
        console.log('Question 4 options:', options);
        shuffleArray(options);
        return {
            type: 'multiple',
            question: `На рисунку показано вектор, що відповідає сумі двох комплексних чисел. Оберіть правильну пару чисел, які при додаванні утворюють цей вектор:`,
            options: options,
            correct: correctAnswer,
            vector: { x: a, y: b }
        };
    } else {
        // Питання про різницю z2 - z1
        const c = getRandomInt(-3, 3);
        const d = getRandomInt(-3, 3);
        const z1 = formatComplexNumber(c, d);
        const z2 = formatComplexNumber(a + c, b + d); // z2 - z1 = a + bi
        const correctAnswer = `\\(z_1 = ${z1}, z_2 = ${z2}\\)`;
        const optionsSet = new Set([correctAnswer]);
        const possibleOptions = [
            `\\(z_1 = ${formatComplexNumber(c, d)}, z_2 = ${formatComplexNumber(a + c, -b - d)}\\)` , // Дає (a; -b)
            `\\(z_1 = ${formatComplexNumber(c, d)}, z_2 = ${formatComplexNumber(-a + c, b + d)}\\)` , // Дає (-a; b)
            `\\(z_1 = ${formatComplexNumber(-c, -d)}, z_2 = ${formatComplexNumber(-a - c, -b - d)}\\)` // Дає (-a; -b)
        ];
        for (let opt of possibleOptions) {
            if (!optionsSet.has(opt)) {
                optionsSet.add(opt);
            }
        }
        const options = Array.from(optionsSet);
        console.log('Question 5 options:', options);
        shuffleArray(options);
        return {
            type: 'multiple',
            question: `На комплексній площині показано вектор різниці \\( z_2 - z_1 \\). Оберіть таку пару комплексних чисел, щоб їх різниця відповідала цьому вектору:`,
            options: options,
            correct: correctAnswer,
            vector: { x: a, y: b }
        };
    }
}
    // Функція завантаження питання
    function loadQuestion() {
    const trainerContent = document.getElementById('trainerContent');
    if (!trainerContent) {
        console.error('trainerContent not found');
        return;
    }

    if (currentGroupIndex >= 5) {
        trainerContent.innerHTML = `
            <div class="completion-emoji"></div>
            <div class="completion-message">
                <h2>Тренування завершено!</h2>
                <p>Молодець!</p>
                <button id="resetTrainerBtn">Спробувати ще раз</button>
            </div>`;
        typesetMathJax();

        const resetButton = document.getElementById('resetTrainerBtn');
        if (resetButton) {
            resetButton.addEventListener('click', () => {
                console.log('Reset button clicked');
                resetTrainer();
            });
        } else {
            console.error('Reset button not found');
        }
        return;
    }

    currentQuestion = generateQuestion(currentGroupIndex);
    let contentHtml = `
        <div class="question-circle"><h3>Питання ${currentGroupIndex + 1}</h3></div>
        <div class="math-notation-centered">${currentQuestion.question}</div>
    `;

    // Додаємо Canvas для третього, четвертого і п’ятого питань
    if (currentGroupIndex === 2 || currentGroupIndex === 3 || currentGroupIndex === 4) {
        contentHtml += `
            <div class="canvas-container">
                <canvas id="complexPlaneCanvas" width="250" height="250"></canvas>
            </div>
        `;
    }

    if (currentQuestion.type === 'multiple') {
        contentHtml += `
            <div class="options-container">
                ${currentQuestion.options.map(opt => `
                    <div class="option" data-value="${opt.replace(/\\\(|\s*\\\)/g, '')}" role="button" aria-label="Вибір відповіді: ${opt}">${opt}</div>
                `).join('')}
            </div>
            <button id="submitAnswer" disabled>Відповісти</button>
        `;
    }

    contentHtml += `<div class="result"></div>`;
    trainerContent.innerHTML = contentHtml;

    // Малюємо систему координат
    if (currentGroupIndex === 2 && currentQuestion.point) {
        drawComplexPlane('complexPlaneCanvas', currentQuestion.point.x, currentQuestion.point.y, false);
    } else if ((currentGroupIndex === 3 || currentGroupIndex === 4) && currentQuestion.vector) {
        drawComplexPlane('complexPlaneCanvas', currentQuestion.vector.x, currentQuestion.vector.y, true);
    }

    // Прив’язка обробників для варіантів відповіді
    document.querySelectorAll('.option').forEach(option => {
        option.addEventListener('click', () => {
            const value = option.dataset.value;
            selectOption(option, value);
        });
    });

    // Прив’язка обробника для кнопки "Відповісти"
    const submitButton = document.getElementById('submitAnswer');
    if (submitButton && currentQuestion.type === 'multiple') {
        submitButton.disabled = true; // Ініціалізація як неактивна
        console.log('Submit button initialized as disabled');
        submitButton.addEventListener('click', () => checkAnswer(document.querySelector('.option.selected')?.dataset?.value));
    }

    typesetMathJax();
}
    // Функція перевірки відповіді
    function checkAnswer(selectedValue) {
        if (!currentQuestion) {
            console.error('No current question available');
            return;
        }

        const normalizedSelected = selectedValue ? selectedValue.replace(/\s+/g, '') : '';
        const normalizedCorrect = currentQuestion.correct.replace(/\\\(|\s*\\\)/g, '').replace(/\s+/g, '');
        const isCorrect = normalizedSelected === normalizedCorrect;

        console.log('Selected value:', normalizedSelected);
        console.log('Correct value:', normalizedCorrect);
        console.log('Is correct:', isCorrect);

        showFeedback(isCorrect ? '✅ Правильно!' : '❌ Неправильно. Спробуйте ще раз!', isCorrect);

        if (isCorrect) {
            score++;
            currentGroupIndex++;
        }

        setTimeout(() => {
            loadQuestion();
        }, 1500);
    }

    // Функція скидання тренажера
    function resetTrainer() {
        currentGroupIndex = 0;
        score = 0;
        currentQuestion = null;
        loadQuestion();
        console.log('Trainer reset');
    }

    // Функція для вибору варіанту
   function selectOption(element, value) {
    console.log('selectOption called with value:', value);
    document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
    element.classList.add('selected');
    const submitButton = document.getElementById('submitAnswer');
    if (submitButton) {
        submitButton.disabled = false;
        console.log('Submit button enabled');
    } else {
        console.error('Submit button not found');
    }
}

    // Функція показу зворотного зв’язку
    function showFeedback(message, isCorrect) {
        const feedback = document.createElement('div');
        feedback.className = `feedback ${isCorrect ? 'correct-feedback' : 'incorrect-feedback'}`;
        feedback.textContent = message;
        feedback.setAttribute('role', 'alert');
        document.body.appendChild(feedback);
        feedback.style.opacity = '1';
        setTimeout(() => {
            feedback.style.opacity = '0';
            setTimeout(() => feedback.remove(), 500);
        }, 1500);
        console.log(`Feedback shown: ${message}, isCorrect: ${isCorrect}`);
    }

    // Функція рендерингу MathJax
    function typesetMathJax(attempts = 10, delay = 200) {
        if (window.MathJax && MathJax.typesetPromise) {
            MathJax.typesetPromise(['#trainerContent', '#questionsModal', '#theoryModal', '#examplesModal']).then(() => {
                console.log('MathJax processed');
                document.querySelectorAll('.option').forEach(option => {
                    option.addEventListener('click', () => {
                        const value = option.dataset.value;
                        selectOption(option, value);
                    });
                });
                const submitButton = document.getElementById('submitAnswer');
                if (submitButton) {
                    submitButton.disabled = true;
                    console.log('Submit button initialized as disabled');
                }
            }).catch(err => console.error('MathJax error:', err));
        } else if (attempts > 0) {
            console.log(`MathJax not loaded, retrying in ${delay}ms, attempts left: ${attempts}`);
            setTimeout(() => typesetMathJax(attempts - 1, delay), delay);
        } else {
            console.warn('Failed to load MathJax');
        }
    }

    // Функція для роботи з YouTube API
    function onYouTubeIframeAPIReady() {
        youtubeApiReady = true;
        console.log('YouTube API Ready');
    }

    // Функція для створення YouTube плеєра
    function createPlayer(playerId, videoId) {
        if (!youtubeApiReady || typeof YT === 'undefined' || !YT.Player) {
            console.error('YouTube API not loaded');
            alert('YouTube API ще не завантажено. Зачекайте.');
            return null;
        }
        return new YT.Player(playerId, {
            height: '400',
            width: '100%',
            videoId: videoId,
            playerVars: { 'autoplay': 0, 'controls': 1, 'rel': 0 },
            events: {
                'onReady': event => console.log(`Player ${playerId} ready`),
                'onError': event => {
                    console.error('YouTube Player Error:', event.data);
                    alert('Помилка завантаження відео. Перевірте підключення.');
                }
            }
        });
    }

    // Функція зупинки відео
    function stopVideo(player, playerName, playerId) {
        if (player) {
            try {
                if (typeof player.stopVideo === 'function') player.stopVideo();
                if (typeof player.destroy === 'function') player.destroy();
                const playerElement = document.getElementById(playerId);
                if (playerElement) playerElement.innerHTML = `<div id="${playerId}"></div>`;
                console.log(`Stopped and destroyed ${playerName}`);
            } catch (e) {
                console.error(`Error stopping/destroying ${playerName}:`, e);
            }
        }
    }

    // Функція перемикання модальних вікон
    function toggleModal(modal, show) {
        if (!modal) {
            console.error('Modal is undefined');
            return;
        }
        const allModals = Object.values(elements).filter(el => el?.id?.startsWith('theoryModal') || el?.id?.startsWith('videoModal') || el?.id?.startsWith('questionsModal') || el?.id?.startsWith('trainerModal') || el?.id?.startsWith('videoPlayerModal') || el?.id?.startsWith('examplesModal'));
        allModals.forEach(m => {
            if (m && m !== modal) {
                m.style.display = 'none';
            }
        });
        modal.style.display = show ? 'flex' : 'none';
        elements.modalOverlay.style.display = show ? 'block' : 'none';
        document.body.style.overflow = show ? 'hidden' : 'auto';

        if (show) {
            const closeBtn = modal.querySelector('.close-btn');
            if (closeBtn) closeBtn.focus();
            typesetMathJax();
        }

        if (show && modal === elements.trainerModal) {
            currentGroupIndex = 0;
            score = 0;
            currentQuestion = null;
            loadQuestion();
        }
        if (!show) {
            stopVideo(player1, 'player1', 'youtubePlayer1');
            stopVideo(player2, 'player2', 'youtubePlayer2');
            stopVideo(player3, 'player3', 'youtubePlayer3');
            stopVideo(player4, 'player4', 'youtubePlayer4');
            player1 = player2 = player3 = player4 = null;
        }
    }

    // Ініціалізація обробників подій
    try {
        elements.openTheoryBtn?.addEventListener('click', () => toggleModal(elements.theoryModal, true));
        elements.openVideoBtn?.addEventListener('click', () => {
            if (!navigator.onLine) {
                alert('Немає підключення до інтернету. Перевірте мережу.');
                return;
            }
            toggleModal(elements.videoModal, true);
        });
        elements.openQuestionsBtn?.addEventListener('click', () => toggleModal(elements.questionsModal, true));
        elements.openTrainerBtn?.addEventListener('click', () => toggleModal(elements.trainerModal, true));
        elements.openExamplesBtn?.addEventListener('click', () => toggleModal(elements.examplesModal, true));

        elements.closeTheoryBtn?.addEventListener('click', () => toggleModal(elements.theoryModal, false));
        elements.closeVideoBtn?.addEventListener('click', () => toggleModal(elements.videoModal, false));
        elements.closeQuestionsBtn?.addEventListener('click', () => toggleModal(elements.questionsModal, false));
        elements.closeTrainerBtn?.addEventListener('click', () => toggleModal(elements.trainerModal, false));
        elements.closeExamplesBtn?.addEventListener('click', () => toggleModal(elements.examplesModal, false));

        elements.closeVideoPlayerBtn1?.addEventListener('click', () => {
            stopVideo(player1, 'player1', 'youtubePlayer1');
            player1 = null;
            toggleModal(elements.videoPlayerModal1, false);
            toggleModal(elements.videoModal, true);
        });
        elements.closeVideoPlayerBtn2?.addEventListener('click', () => {
            stopVideo(player2, 'player2', 'youtubePlayer2');
            player2 = null;
            toggleModal(elements.videoPlayerModal2, false);
            toggleModal(elements.videoModal, true);
        });
        elements.closeVideoPlayerBtn3?.addEventListener('click', () => {
            stopVideo(player3, 'player3', 'youtubePlayer3');
            player3 = null;
            toggleModal(elements.videoPlayerModal3, false);
            toggleModal(elements.videoModal, true);
        });
        elements.closeVideoPlayerBtn4?.addEventListener('click', () => {
            stopVideo(player4, 'player4', 'youtubePlayer4');
            player4 = null;
            toggleModal(elements.videoPlayerModal4, false);
            toggleModal(elements.videoModal, true);
        });

        elements.exercise1Btn?.addEventListener('click', () => {
            console.log('Перехід до vpr1.html');
            window.location.href = "vpr1.html";
        });

        elements.exercise2Btn?.addEventListener('click', () => {
            console.log('Перехід до vpr2.html');
            window.location.href = "vpr2.html";
        });

        elements.exercise3Btn?.addEventListener('click', () => {
            console.log('Перехід до vpr3.html');
            window.location.href = "vpr3.html";
        });

        elements.exercise4Btn?.addEventListener('click', () => {
            console.log('Перехід до vpr4.html');
            window.location.href = "vpr4.html";
        });

        elements.modalOverlay?.addEventListener('click', () => {
            toggleModal(elements.theoryModal, false);
            toggleModal(elements.videoModal, false);
            toggleModal(elements.questionsModal, false);
            toggleModal(elements.trainerModal, false);
            toggleModal(elements.videoPlayerModal1, false);
            toggleModal(elements.videoPlayerModal2, false);
            toggleModal(elements.videoPlayerModal3, false);
            toggleModal(elements.videoPlayerModal4, false);
            toggleModal(elements.examplesModal, false);
        });

        document.querySelectorAll('.video-card').forEach(card => {
            card.addEventListener('click', () => {
                const videoNumber = card.dataset.video;
                if (!navigator.onLine) {
                    alert('Немає підключення до інтернету. Перевірте мережу.');
                    return;
                }
                toggleModal(elements.videoModal, false);
                if (videoNumber === '1') {
                    toggleModal(elements.videoPlayerModal1, true);
                    if (!player1) player1 = createPlayer('youtubePlayer1', videoIds['1']);
                } else if (videoNumber === '2') {
                    toggleModal(elements.videoPlayerModal2, true);
                    if (!player2) player2 = createPlayer('youtubePlayer2', videoIds['2']);
                } else if (videoNumber === '3') {
                    toggleModal(elements.videoPlayerModal3, true);
                    if (!player3) player3 = createPlayer('youtubePlayer3', videoIds['3']);
                } else if (videoNumber === '4') {
                    toggleModal(elements.videoPlayerModal4, true);
                    if (!player4) player4 = createPlayer('youtubePlayer4', videoIds['4']);
                }
            });
        });

        document.querySelectorAll('.question-card').forEach(card => {
            card.addEventListener('click', () => {
                card.classList.toggle('flipped');
                console.log('Question card flipped');
            });
        });

        document.addEventListener('keydown', e => {
            if (e.key === 'Escape') {
                toggleModal(elements.theoryModal, false);
                toggleModal(elements.videoModal, false);
                toggleModal(elements.questionsModal, false);
                toggleModal(elements.trainerModal, false);
                toggleModal(elements.videoPlayerModal1, false);
                toggleModal(elements.videoPlayerModal2, false);
                toggleModal(elements.videoPlayerModal3, false);
                toggleModal(elements.videoPlayerModal4, false);
                toggleModal(elements.examplesModal, false);
            }
        });

        typesetMathJax();
    } catch (error) {
        console.error('Error initializing event listeners:', error);
        alert('Сталася помилка при ініціалізації сторінки. Перевірте консоль для деталей.');
    }

    window.onYouTubeIframeAPIReady = onYouTubeIframeAPIReady;
});
</script>
</body>
</html>



                
