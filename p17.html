<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>17. Поняття матриці. Види матриць</title>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            startup: {
                ready: () => {
                    console.log("MathJax is loaded and ready!");
                    MathJax.startup.defaultReady();
                }
            }
        };
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" onerror="console.error('Failed to load MathJax')"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;700&family=Roboto:wght@400;700&family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
    <style>
        *, *:before, *:after {
            box-sizing: border-box;
        }
        body {
            margin: 0;
            background: linear-gradient(135deg, #1a2634, #0f3c3a);
            font-family: 'Roboto', sans-serif;
            color: #e2e8f0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: start;
            min-height: 100vh;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        body.loaded {
            visibility: visible;
            opacity: 1;
        }
        .title-box {
            margin-top: 60px;
            padding: 20px 40px;
            background: linear-gradient(135deg, #22d3ee, #fb7185);
            border-radius: 15px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
            max-width: 90%;
            text-align: center;
        }
        .title-box h1 {
            margin: 0;
            font-size: 24px;
            color: #ffffff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            font-family: 'Merriweather', serif;
        }
        .section-container {
            margin-top: 80px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        .section {
            width: 260px;
            height: 200px;
            background: linear-gradient(45deg, #1e2a38, #3b4a5a);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 15px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            color: #e2e8f0;
            text-decoration: none;
        }
        .section:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0,0,0,0.25);
            background: linear-gradient(45deg, #1e2a38, #4ade80);
        }
        .section img {
    width: 40px;
    height: 40px;
    margin-bottom: 15px;
    object-fit: cover;
    border-radius: 8px;
    filter: drop-shadow(0 0 5px rgba(163, 166, 139, 0.3));
}
        .section h2 {
            font-size: 20px;
            margin: 0;
            font-family: 'Merriweather', serif;
            color: #e2e8f0;
        }
      .modal {
    display: none;
    position: fixed;
    top: 5%;
    left: 5%;
    width: 90%;
    height: 90%;
    background: linear-gradient(135deg, #2dd4bf, #1e3a8a);
    border-radius: 15px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    z-index: 1001;
    overflow: hidden; /* Змінено з auto на hidden, щоб уникнути прокрутки модального контейнера */
    flex-direction: column;
    align-items: center;
    justify-content: flex-start; /* Змінено на flex-start для верхнього вирівнювання */
}
        #modalOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
        }
        .modal-content {
    padding: 20px;
    flex-grow: 1;
    background: #1e2a38;
    border-radius: 10px;
    margin: 10px;
    color: #e8e8e8;
    width: calc(100% - 20px);
    overflow-y: auto; /* Прокрутка тільки для вмісту */
    display: block;
    max-height: calc(100% - 60px); /* Обмежуємо висоту, враховуючи modal-header */
}

            .modal-content::-webkit-scrollbar {
            width: 6px;
        }
        .modal-content::-webkit-scrollbar-track {
            background: transparent;
        }
        .modal-content::-webkit-scrollbar-thumb {
            background: rgba(163, 166, 139, 0.5);
            border-radius: 3px;
        }
        .modal-content::-webkit-scrollbar-thumb:hover {
            background: rgba(163, 166, 139, 0.8);
        }
            
        .modal-header {
    background: linear-gradient(0deg, #2dd4bf, #1e3a8a);
    padding: 8px 12px;
    display: flex;
    justify-content: flex-end;
    width: 100%;
    flex-shrink: 0;
    position: sticky; /* Фіксуємо header зверху */
    top: 0;
    z-index: 1002; /* Вищий z-index, ніж у modal-content */
    border-top-left-radius: 15px;
    border-top-right-radius: 15px;
}
       #trainerModal .modal-header {
    background: #6b21a8;
    border-top-left-radius: 15px;
    border-top-right-radius: 15px;
}
       /* Переконуємося, що close-btn видимий */
.close-btn {
    background: #fb7185;
    color: #ffffff;
    border: none;
    border-radius: 6px;
    padding: 6px 16px;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.3s ease;
    font-family: 'Roboto', sans-serif;
    z-index: 1003; /* Вищий z-index для кнопки */
}
        .close-btn:hover {
    background: #10b981;
}

#trainerModal .close-btn {
    background: #a855f7;
}

#trainerModal .close-btn:hover {
    background: #ec4899;
}
        details {
            margin: 10px 0;
            padding: 10px;
            border-radius: 6px;
            background: #1e2a38;
            cursor: pointer;
        }
        summary {
            font-weight: bold;
            padding: 8px;
            background: #b81414;
            border-radius: 6px;
            color: #ffffff;
            font-family: 'Merriweather', serif;
        }
        summary:hover {
            background: #10b981;
        }
        details p {
            padding: 0 15px 10px;
            color: #e2e8f0;
            margin: 8px 0;
        }
        .math-notation {
            font-style: italic;
            color: #fef08a;
            background: #1e2a38;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .highlight-term {
            background: #e0f7fa;
            padding: 2px 4px;
            border-radius: 3px;
            color: #0ea5e9;
        }
        .formula-line {
            display: inline-block;
            white-space: nowrap;
        }
        .question-block {
            margin: 15px 0;
            padding: 10px;
            background: linear-gradient(135deg, #22d3ee, #fb7185);
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            cursor: pointer;
        }
        .question-block summary {
            font-size: 16px;
            background: #2dd4bf;
            color: #ffffff;
        }
        .question-block details summary {
            background: #fb7185;
        }
        .question-block details p {
            color: #e2e8f0;
            background: #1e2a38;
            padding: 10px;
            border-radius: 6px;
        }
        #questionsModal mjx-container {
            color: #fef08a !important;
           background: none !important; /* Прибираємо темний фон */
            font-style: italic;
            font-size: 20px !important;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .trainer-container {
            width: 90%;
            max-width: 800px;
            padding: 3vw 4vw;
            text-align: center;
            background-color: #1e2a38;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0);
            transition: all 0.3s ease;
            margin: auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100%;
        }
        .question-circle {
            width: clamp(80px, 15vw, 120px);
            height: clamp(80px, 15vw, 120px);
            margin: 0 auto 3vw;
            background: linear-gradient(135deg, #a855f7, #ec4899);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
        }
        .question-circle h3 {
            color: #ffffff;
            font-family: 'Lora', serif;
            font-size: clamp(16px, 2.5vw, 20px);
            margin: 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        /* === СТИЛІ ДЛЯ МЕДАЛІ З ТРИЗУБОМ === */
.completion-emoji {
    position: relative;
    display: inline-block;
    width: clamp(56px, 12vw, 96px);
    height: clamp(56px, 12vw, 96px);
    vertical-align: middle;
    margin: 0 auto 3vw;
    border-radius: 50%;
    background: linear-gradient(135deg, #1c2526, #2e3a3b);
    border: 3px dashed #ffd700;
    box-shadow: 0 4px 16px rgba(255, 215, 0, 0.3);
    overflow: hidden;
    animation: medalAppear 0.8s ease-out;
}

.completion-emoji::after {
    content: '';
    position: absolute;
    inset: 0;
    background-image: url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 120 120'>\
<defs>\
<radialGradient id='goldShine' cx='40%' cy='35%' r='70%'>\
<stop offset='0%' stop-color='%23fff59d'/>\
<stop offset='40%' stop-color='%23ffeb3b'/>\
<stop offset='100%' stop-color='%23f9a825'/>\
</radialGradient>\
<filter id='s' x='-50%' y='-50%' width='200%' height='200%'>\
<feDropShadow dx='0' dy='2' stdDeviation='3' flood-color='%23000000' flood-opacity='0.4'/>\
</filter>\
</defs>\
<rect x='30' y='0' width='60' height='40' rx='4' fill='%23007ACC'/>\
<rect x='30' y='20' width='60' height='20' rx='4' fill='%23FFD700'/>\
<g transform='translate(60,70)'>\
<polygon points='0,-26 6,-6 26,-6 9,6 15,26 0,14 -15,26 -9,6 -26,-6 -6,-6' fill='url(%23goldShine)' filter='url(%23s)'/>\
</g>\
</svg>");
    background-size: 75%;
    background-repeat: no-repeat;
    background-position: center 60%;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.25));
    animation: medalBounce 1.2s ease-out 0.3s both;
}

/* Анімація появи кола */
@keyframes medalAppear {
    0% {
        transform: scale(0.3) rotate(-180deg);
        opacity: 0;
    }
    60% {
        transform: scale(1.1);
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}

/* Анімація медалі — падає і блимає */
@keyframes medalBounce {
    0% {
        transform: translateY(-120px) rotate(-30deg) scale(0.4);
        opacity: 0;
    }
    60% {
        transform: translateY(15px) rotate(10deg) scale(1.15);
        opacity: 1;
    }
    80% {
        transform: translateY(-8px) rotate(-5deg) scale(1.05);
    }
    100% {
        transform: translateY(0) rotate(0) scale(1);
    }
}

        .options-container {
            display: flex;
            flex-wrap: wrap;
            gap: 2vw;
            justify-content: center;
            margin-bottom: 3vw;
            width: 100%;
        }
        .option {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1.5vw 3vw;
            border: 1.5px solid #a855f7;
            border-radius: 8px;
            background: #3b4a5a;
            cursor: pointer;
            font-size: clamp(15px, 3.5vw, 18px);
            min-height: 45px;
            min-width: 90px;
            max-width: 45%;
            text-align: center;
            font-family: 'Lora', serif;
            position: relative;
            z-index: 1;
            overflow: hidden;
            box-sizing: border-box;
            touch-action: manipulation;
            pointer-events: auto !important;
            user-select: none;
            transition: background 0.3s ease, transform 0.3s ease, border 0.3s ease;
            color: #e2e8f0;
        }
        .option mjx-container {
            display: flex !important;
            justify-content: center !important;
            align-items: center !important;
            width: 100% !important;
            height: 100% !important;
            pointer-events: none !important;
            font-size: inherit !important;
            color: #fef08a !important;
            background: none !important;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        .option::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 2;
            pointer-events: none !important;
        }
        .option:hover {
            background: #4ade80;
            transform: scale(1.03);
        }
        .option.selected {
            background-color: #073b24 !important;
            color: #1e2a38 !important;
            border: 2px solid #FFD700 !important;
            font-weight: bold;
        }
        .option:focus {
            outline: 2px solid #FFD700;
            outline-offset: 2px;
        }
        .option {
            min-height: 50px !important;
            padding: 12px 20px !important;
        }
        mjx-container, mjx-container * {
            pointer-events: none !important;
            user-select: none !important;
        }
        mjx-frac {
            font-size: 1.2em !important;
            padding: 2px !important;
        }
        mjx-num, mjx-den {
            padding: 2px !important;
        }
        button {
            background-color: #fb7185;
            color: #ffffff;
            border: none;
            border-radius: 25px;
            padding: clamp(10px, 2vw, 12px) clamp(20px, 4vw, 24px);
            font-size: clamp(16px, 3vw, 18px);
            font-family: 'Lora', serif;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        button:hover:not(:disabled) {
            background-color: #10b981;
        }
        button:disabled {
            background-color: #cbd5e1;
            cursor: not-allowed;
        }
        .result {
            margin-top: 3vw;
            font-size: clamp(16px, 2.5vw, 18px);
            font-family: 'Lora', serif;
            color: #e2e8f0;
        }
        .completion-message {
            font-family: 'Lora', serif;
            font-weight: 700;
            color: #e2e8f0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            background: linear-gradient(135deg, #2dd4bf, #1e3a8a);
            border: 2.5px solid #1e3a8a;
            border-radius: 15px;
            padding: clamp(12px, 3vw, 18px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.25);
            margin: 2vw auto;
            max-width: 90%;
        }
        .completion-message h2 {
            font-size: clamp(22px, 4.5vw, 30px);
            margin: 0 0 1vw;
            color: #ff9000;
        }
        .completion-message p {
            font-size: clamp(18px, 3.5vw, 22px);
            margin: 0;
            color: #ffff00 ;
        }
        .math-notation-centered {
            display: block;
            text-align: center;
            width: 100%;
            font-size: clamp(18px, 3vw, 20px);
            margin: 5px 0;
            line-height: 1.4;
            color: #ffffff;
            background: #1e2a38;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Roboto', sans-serif;
        }
        mjx-container.math-notation-centered {
            display: inline-block !important;
            text-align: center !important;
            vertical-align: middle !important;
            white-space: nowrap !important;
            line-height: 1.4 !important;
            font-size: clamp(18px, 3vw, 20px) !important;
            color: #ffff00 !important;
            background: #1e2a38 !important;
            margin: 5px auto !important;
            padding: 2px 4px !important;
            border-radius: 3px;
        }
        mjx-container.math-notation-centered * {
            color: #ffff00  !important;
            font-style: italic !important;
        }
        #trainerModal .math-notation-centered {
            font-size: clamp(18px, 3vw, 20px);
            color: #ffffff;
            background: #1e2a38;
            font-family: 'Roboto', sans-serif;
            line-height: 1.5;
            text-align: center;
            margin: 5px 0;
            padding: 2px 4px;
            border-radius: 3px;
        }
        #trainerModal .math-notation-centered mjx-container {
            font-size: clamp(18px, 3vw, 20px) !important;
            color: #ffff00 !important;
            background: #1e2a38 !important;
            font-style: italic !important;
            display: inline-block !important;
            text-align: center !important;
            vertical-align: middle !important;
            margin: 5px auto !important;
            padding: 2px 4px !important;
            border-radius: 3px;
        }
        .feedback {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: clamp(24px, 5.8vw, 30px);
            font-family: 'Lora', serif;
            padding: 20px 30px;
            border-radius: 10px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
            z-index: 1001;
            opacity: 0;
            transition: opacity 0.5s ease;
            text-align: center;
        }
        .correct-feedback {
            color: #e2e8f0;
            background: #10b981;
            border: 2px solid #10b981;
        }
        .incorrect-feedback {
            color: #e2e8f0;
            background: #dc2626;
            border: 2px solid #dc2626;
        }
        .navigation-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px auto;
            max-width: 1000px;
        }
        .nav-button {
            display: flex;
            align-items: center;
            background: #4682B4;
            color: #fef08a;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 16px;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .nav-button:hover {
            background: #1e3a8a;
            color: #ffffff;
            transform: scale(1.03);
        }
        .nav-button svg {
            margin-right: 8px;
            fill: currentColor;
        }
        .question-card {
            perspective: 1000px;
            margin: 20px auto;
            max-width: 964px;
            width: 100%;
            min-height: 150px;
            transition: transform 0.3s ease, opacity 0.3s ease;
            cursor: pointer;
        }
        .card-inner {
            position: relative;
            width: 100%;
            min-height: 150px;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            cursor: inherit;
        }
        .question-card.flipped .card-inner {
            transform: rotateY(180deg);
        }
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            min-height: 150px;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            text-align: center;
            cursor: inherit;
        }
        .card-front {
            background: #005159;
            color: #e2e8f0;
        }
        .card-back {
            background: #6b21a8;
            color: #e2e8f0;
            transform: rotateY(180deg);
            text-align: justify;
            padding: 20px;
            overflow: auto;
            white-space: normal;
        }
        .card-front span {
            display: block;
            text-align: center;
            color: #e2e8f0;
            font-weight: 700;
            font-family: 'Lora', serif;
            font-size: clamp(16px, 2.8vw, 18px);
            line-height: 1.4;
            width: 100%;
        }
        .card-back span {
            display: block;
            max-width: 100%;
            word-wrap: break-word;
            color: #e2e8f0;
        }
        .hidden {
    display: none !important;
}
            .video-card {
            width: 350px;
            height: 250px;
            background: #4f7942;
            border-radius: 15px;
            border: 1px solid rgba(163, 166, 139, 0.3);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 10px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            color: #e8e8e8;
        }
            .video-card-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center; /* Center the cards horizontally */
    align-items: center; /* Center the cards vertically */
    gap: 20px; /* Add spacing between cards */
    padding: 20px; /* Optional: Add padding inside the container for better spacing */
}

.video-card {
    width: 350px;
    height: 250px;
    background: #4f7942;
    border-radius: 15px;
    border: 1px solid rgba(163, 166, 139, 0.3);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    display: flex;
    flex-direction: column;
    align-items: center; /* Center content horizontally */
    justify-content: center; /* Center content vertically */
    text-align: center;
    padding: 10px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: pointer;
    color: #e8e8e8;
    margin: 10px; /* Add margin around each card for extra spacing */
}

.video-card img {
    width: 40px;
    height: 40px;
    margin: 0 auto 8px; /* Center icon horizontally and add bottom margin */
    object-fit: cover;
    border-radius: 6px;
}

.video-card h3 {
    font-size: clamp(16px, 2.5vw, 18px);
    font-weight: 600;
    margin: 0; /* Remove default margin to prevent unwanted spacing */
}
          .video-player-container {
    width: 80vw; /* Залишаємо ширину 80% від viewport */
    max-width: 960px; /* Максимальна ширина для великих екранів */
    aspect-ratio: 16 / 9; /* Змінено на стандартне співвідношення YouTube */
    margin: 20px auto; /* Центрування з відступом зверху */
    display: flex; /* Додаємо flex для центрування iframe */
    justify-content: center;
    align-items: center;
}

.video-player-container iframe {
    width: 100%; /* Заповнює контейнер */
    height: 100%; /* Заповнює контейнер */
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    display: block; /* Додаємо, щоб уникнути приховування */
    border: none; /* Видаляємо рамку для чистого вигляду */
}
        .theory-content h2 {
            color: #ffc45f;
            text-align: center;
        }
        .theory-content h3 {
            color: #e2e8f0;
        }
        .theory-content p, .theory-content li {
            color: #e2e8f0;
            font-size: clamp(18px, 3vw, 20px);
        }
        .example {
            color: #fb7185;
            font-weight: bold;
        }
        .solution {
            color: #fb7185;
            font-weight: bold;
            text-align: center;
            display: block;
        }
        .note {
    color: #fb7185;
    font-weight: bold;
}

.note-text {
    font-style: italic;
    color: #e2e8f0;
    text-align: justify;
   width: 100%;
}
            .theory-content p:not(.math-notation-centered),
.theory-content li {
    text-align: justify;
}


        .matrix-type {
            font-style: italic;
            color: #ffff00;
        }
        .main-types {
            font-weight: bold;
            color: #e2e8f0;
        }
            ol {
        color: #e2e8f0;
    }

    ol li::marker {
        color: #ffff00;
    }
 mjx-container {
        color: #ffff00 !important;
        background: #1e2a38 !important;
        font-style: italic !important;
    }

    .theory-content mjx-container {
        color: #ffff00 !important;
        background: #1e2a38 !important;
        padding: 2px 4px;
        border-radius: 3px;
    }

   
            .modal-content::-webkit-scrollbar {
        width: 12px;
        height: 12px;
    }

    .modal-content::-webkit-scrollbar-track {
        background: #1e2a38;
        border-radius: 10px;
        box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.3);
    }

    .modal-content::-webkit-scrollbar-thumb {
        background: linear-gradient(45deg, #2dd4bf, #fb7185);
        border-radius: 10px;
        border: 2px solid #1e2a38;
    }

    .modal-content::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(45deg, #10b981, #ec4899);
    }

    /* Optional global scrollbar */
    ::-webkit-scrollbar {
        width: 12px;
        height: 12px;
    }

    ::-webkit-scrollbar-track {
        background: #1e2a38;
        border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb {
        background: linear-gradient(45deg, #2dd4bf, #fb7185);
        border-radius: 10px;
        border: 2px solid #1e2a38;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(45deg, #10b981, #ec4899);
    }

    .modal-content {
        scrollbar-color: #2dd4bf #1e2a38;
        scrollbar-width: thin;
    }
        .glow-title {
    text-align: center; /* Center the text horizontally */
    color: #e2e8f0; /* Match modal text color */
    font-family: 'Merriweather', serif; /* Match section heading font */
    font-size: clamp(20px, 3vw, 24px); /* Responsive font size */
    margin: 20px 0; /* Add vertical spacing above and below */
    text-shadow: 0 0 5px rgba(163, 166, 139, 0.5); /* Subtle glow effect */
}



/* Стилі для inputContainer */
.input-container {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 20px 0;
    width: 100%;
    max-width: 300px;
}

#answerInput {
    padding: 8px;
    font-size: clamp(14px, 3vw, 16px);
    width: 100px; /* Зменшена ширина для мобільних */
    border: 2px solid #a855f7;
    border-radius: 8px;
    background: #3b4a5a;
    color: #e2e8f0;
    text-align: center;
    font-family: 'Roboto', sans-serif;
}

.option.text-option {
    font-size: clamp(14px, 3vw, 16px);
    padding: 10px 20px;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
        
       @media (max-width: 768px) {
    /* 1. Збільшення розміру кнопки "Закрити" в модальних вікнах */
    .close-btn {
        font-size: 16px; /* Збільшено з 14px */
        padding: 6px 12px; /* Збільшено для більшої області натискання */
        border-radius: 8px; /* Злегка більший радіус для кращого вигляду */
    }

    /* 2. Теоретичні відомості: збільшення розміру основного тексту та формул */
    .theory-content p, .theory-content li {
        font-size: clamp(18px, 3vw, 20px); /* Збільшено з 16px до 18-20px */
    }
    .theory-content mjx-container {
        font-size: clamp(16px, 3vw, 18px) !important; /* Збільшено розмір формул */
    }
    .theory-content h2, .theory-content h3 {
        font-size: clamp(20px, 3vw, 24px); /* Розмір заголовків без змін */
    }

    /* 3. Питання та відповіді: збільшення розміру тексту питань і відповідей */
    .question-block summary {
        font-size: clamp(18px, 3vw, 20px); /* Збільшено з 16px */
    }
    .question-block details p {
        font-size: clamp(18px, 3vw, 20px); /* Збільшено розмір тексту відповідей */
    }
    #questionsModal mjx-container {
        font-size: 20px !important; /* Розмір формул без змін */
    }

    /* 4. Тренажер: збільшення розміру кнопки та тексту "Відповісти" */
    #submitAnswer {
        font-size: clamp(16px, 3.5vw, 18px); /* Збільшено з 12-14px */
        padding: clamp(12px, 3vw, 14px) clamp(24px, 5vw, 28px); /* Збільшено область кнопки */
    }

    /* 5. Збільшення ширини поля введення у другому питанні */
    #answerInput {
        width: 80px; /* Збільшено з 45px для більшої зручності */
        padding: 8px; /* Збільшено відступ для зручності */
        font-size: clamp(16px, 3vw, 18px); /* Збільшено розмір тексту для зручності */
    }

    /* Решта стилів без змін */
    .title-box {
        margin-top: 40px;
        padding: 15px 20px;
    }
    .title-box h1 {
        font-size: 24px;
    }
    .section-container {
        flex-direction: column;
        align-items: center;
        gap: 20px;
    }
    .section {
        width: 80%;
        height: 180px;
    }
    .modal {
        top: 2%;
        left: 2%;
        width: 96%;
        height: 96%;
    }
    .modal-header {
        padding: 5px 8px;
    }
    .modal-content {
        max-height: calc(100% - 50px);
    }
    .question-card {
        min-height: 180px;
    }
   /* Збільшення розміру тексту у флеш-картках */
    .card-front, .card-back {
        font-size: clamp(16px, 3vw, 18px); /* Збільшено з 14px до 16-18px */
        padding: 12px; /* Злегка збільшено відступи для кращої читабельності */
        line-height: 1.3; /* Збільшено міжрядковий інтервал */
        text-align: justify;
        word-wrap: break-word;
        overflow-wrap: break-word;
    }
    .card-front span {
        font-size: clamp(16px, 3vw, 18px); /* Збільшено з 14px до 16-18px */
        line-height: 1.3;
    }
    .video-card-container {
        flex-direction: column;
        gap: 15px;
        padding: 15px;
    }
    .video-card {
        width: 260px;
        height: 160px;
        margin: 5px;
    }
    .video-card img {
        width: 40px;
        height: 40px;
        margin-bottom: 6px;
    }
    .video-player-container {
        width: 80vw;
        max-width: 600px;
        aspect-ratio: 16 / 9;
    }
    .video-card h3 {
        font-size: clamp(14px, 2.5vw, 16px);
    }
    .trainer-container {
        width: 95%;
        padding: 4vw;
    }
    .question-circle, .completion-emoji {
        width: 25vw;
        height: 25vw;
        min-width: 80px;
        min-height: 80px;
    }
    .question-circle h3 {
        font-size: clamp(14px, 3vw, 16px);
    }
    .completion-emoji::after {
        font-size: clamp(30px, 7vw, 40px);
    }
    .options-container {
        gap: 1.5vw;
        flex-direction: column;
        align-items: center;
    }
    .option {
        font-size: clamp(14px, 4vw, 16px);
        padding: 10px !important;
        min-height: 60px !important;
        min-width: 100% !important;
        max-width: 100% !important;
        box-sizing: border-box;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        overflow: hidden;
    }
    .option mjx-container {
        font-size: clamp(14px, 4vw, 16px) !important;
        width: 100% !important;
        text-align: center;
        overflow: hidden;
    }
    button {
        padding: 3vw 5vw;
        font-size: clamp(12px, 3vw, 14px);
    }
    .feedback {
        font-size: clamp(24px, 5.8vw, 32px);
        padding: clamp(12px, 3.5vw, 18px) clamp(18px, 5vw, 25px);
        max-width: 95vw;
        word-wrap: break-word;
    }
    .completion-message {
        padding: clamp(10px, 3vw, 15px);
    }
    .completion-message h2 {
        font-size: clamp(20px, 4vw, 26px);
    }
    .completion-message p {
        font-size: clamp(16px, 3vw, 20px);
    }
    .navigation-buttons {
        margin: 20px auto;
        gap: 15px;
    }
    .nav-button {
        font-size: 16px;
        padding: 10px 20px;
    }
    .math-notation-centered {
        font-size: clamp(16px, 2.5vw, 18px);
    }
    mjx-container.math-notation-centered {
        font-size: clamp(16px, 2.5vw, 18px) !important;
    }
    .input-container {
        flex-direction: row;
        align-items: center;
        gap: 8px;
    }
}

@media (max-width: 480px) {
    /* 1. Збільшення розміру кнопки "Закрити" в модальних вікнах */
    .close-btn {
        font-size: 14px; /* Збільшено з 12px */
        padding: 5px 10px; /* Збільшено для більшої області натискання */
        border-radius: 6px;
    }

    /* 2. Теоретичні відомості: збільшення розміру основного тексту та формул */
    .theory-content p, .theory-content li {
        font-size: clamp(17px, 3.2vw, 19px); /* Збільшено з 14px до 16-18px */
    }
    .theory-content mjx-container {
        font-size: clamp(17px, 3.2vw, 19px) !important; /* Збільшено розмір формул */
    }
    .theory-content h2, .theory-content h3 {
        font-size: clamp(20px, 3vw, 24px); /* Розмір заголовків без змін */
    }

    /* 3. Питання та відповіді: збільшення розміру тексту питань і відповідей */
    .question-block summary {
        font-size: clamp(17px, 3.2vw, 19px); /* Збільшено з 14px */
    }
    .question-block details p {
        font-size: clamp(17px, 3.2vw, 19px); /* Збільшено розмір тексту відповідей */
    }
    #questionsModal mjx-container {
        font-size: 18px !important; /* Розмір формул без змін */
    }

    /* 4. Тренажер: збільшення розміру кнопки та тексту "Відповісти" */
    #submitAnswer {
        font-size: clamp(14px, 3.5vw, 16px); /* Збільшено з 12px */
        padding: clamp(10px, 3vw, 12px) clamp(20px, 5vw, 24px); /* Збільшено область кнопки */
    }

    /* 5. Збільшення ширини поля введення у другому питанні */
    #answerInput {
        width: 70px; /* Збільшено з 50px для більшої зручності */
        padding: 6px; /* Збільшено відступ */
        font-size: clamp(14px, 3vw, 16px); /* Збільшено розмір тексту */
    }

    /* Решта стилів без змін */
    .title-box {
        margin-top: 20px;
        padding: 10px 15px;
    }
    .title-box h1 {
        font-size: 20px;
    }
    .section {
        width: 90%;
        height: 150px;
    }
    .section img {
        width: 50px;
        height: 50px;
    }
    .section h2 {
        font-size: 18px;
    }
    .modal-header {
        padding: 4px 6px;
    }
    .modal-content {
        max-height: calc(100% - 40px);
    }
    .question-card {
        min-height: 200px;
    }
    .video-card-container {
        gap: 10px;
        padding: 10px;
    }
    .video-card {
        width: 90%;
        max-width: 260px;
        height: 140px;
        margin: 5px;
    }
    .video-card img {
        width: 30px;
        height: 30px;
        margin-bottom: 5px;
    }
    .video-card h3 {
        font-size: clamp(12px, 2.5vw, 14px);
    }
    .video-player-container {
        width: 80vw;
        max-width: 400px;
        aspect-ratio: 16 / 9;
    }
    .card-inner {
        min-height: 200px;
    }
     /* Збільшення розміру тексту у флеш-картках */
    .card-front, .card-back {
        font-size: clamp(14px, 3vw, 16px); /* Збільшено з 13px до 14-16px */
        padding: 10px; /* Збільшено відступи */
        line-height: 1.2; /* Збільшено міжрядковий інтервал */
        text-align: justify;
        word-wrap: break-word;
        overflow-wrap: break-word;
    }
    .card-front span {
        font-size: clamp(14px, 3vw, 16px); /* Збільшено з 13px до 14-16px */
        line-height: 1.2;
    }
    .trainer-container {
        padding: 5vw;
    }
    .question-circle, .completion-emoji {
        width: 25vw;
        height: 25vw;
        min-width: 60px;
        min-height: 60px;
    }
    .completion-emoji::after {
        font-size: clamp(25px, 6vw, 35px);
    }
    .option {
        font-size: 16px !important;
        padding: 10px !important;
        min-height: 60px !important;
        min-width: 100% !important;
        max-width: 100% !important;
        box-sizing: border-box;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        overflow: hidden;
    }
    .option mjx-container {
        font-size: clamp(13px, 4vw, 15px) !important;
        width: 100% !important;
        text-align: center;
        overflow: hidden;
    }
    .feedback {
        font-size: clamp(22px, 5.2vw, 28px);
        padding: clamp(10px, 3vw, 15px) clamp(15px, 4.5vw, 20px);
        max-width: 95vw;
    }
    .completion-message {
        padding: clamp(10px, 3vw, 15px);
    }
    .completion-message h2 {
        font-size: clamp(18px, 3.5vw, 22px);
    }
    .completion-message p {
        font-size: clamp(14px, 3vw, 18px);
    }
    .navigation-buttons {
        margin: 15px auto;
        gap: 10px;
    }
    .nav-button {
        font-size: 14px;
        padding: 8px 16px;
    }
    .math-notation-centered {
        font-size: clamp(14px, 2.5vw, 16px);
        line-height: 1.2;
    }
    mjx-container.math-notation-centered {
        font-size: clamp(14px, 2.5vw, 16px) !important;
        line-height: 1.2 !important;
    }
    mjx-container {
        font-size: 13px !important;
    }
    .input-container {
        gap: 6px;
    }
}
    
    </style>
</head>
   <body>         
    <div class="title-box">
        <h1>17. Поняття матриці. Види матриць</h1>
    </div>

    <div class="section-container">
        <div class="section" id="openTheoryBtn">
            <img src="https://img.icons8.com/fluency/96/book-shelf.png" alt="Книга">
            <h2>Теоретичні відомості</h2>
        </div>
        <div class="section" id="openVideoBtn">
            <img src="https://img.icons8.com/fluency/96/video.png" alt="Відео">
            <h2>Відеоматеріали</h2>
        </div>
        <div class="section" id="openQuestionsBtn">
            <img src="https://img.icons8.com/fluency/96/flipboard.png" alt="Картки">
            <h2>Питання і відповіді</h2>
        </div>
        <div class="section" id="openTrainerBtn">
            <img src="https://img.icons8.com/fluency/96/flash-on.png" alt="Тренажер">
            <h2>Тренажер</h2>
        </div>
    </div>

    <div class="navigation-buttons">
       <a class="nav-button" href='tema5.html'>
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
                <path d="M15 18l-6-6 6-6"/>
            </svg>
            До теми 5
        </a>
       <a class="nav-button" href='zmist.html'>
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
  <path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
</svg>
            До курсу
        </a>

    </div>

    <div id="theoryModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="theoryTitle">
        <div class="modal-header">
            <button class="close-btn" id="closeTheoryBtn" aria-label="Закрити">× Закрити</button>
        </div>
       <div class="modal-content">
            <div class="theory-content">
                <h2>Матриці</h2>
                <p>Матриці – це зручний інструмент у математиці та технічних науках, який допомагає впорядковувати дані й спрощувати обчислення. Простіше кажучи, матриця – це таблиця чисел або символів із <span class="math-notation">\( m \)</span> рядків і <span class="math-notation">\( n \)</span> стовпців. Порядок елементів у ній фіксований: зміна порядку дає нову матрицю з іншими властивостями. Матриці широко застосовуються у військовій справі, наприклад, для аналізу систем чи планування, а також у лінійній алгебрі й розрахунках.</p>
                <p>У цьому параграфі ми розглянемо основні операції з матрицями: додавання, віднімання, транспонування, множення та знаходження оберненої матриці.</p>
                <h2>Поняття матриці. Види матриць</h2>
                <p>Матриці – це математичний інструмент, який використовується для обчислень, аналізу даних і розв’язання систем рівнянь. Вони бувають різних видів, кожен із яких має свої особливості та застосування. Для ефективної роботи з матрицями в практичних задачах важливо знати їхні основи.</p>
                <p>Числову матрицю розміру <span class="math-notation">\( m \times n \)</span> (читається як «ем на ен») задають як прямокутну таблицю з <span class="math-notation">\( m \)</span> рядків і <span class="math-notation">\( n \)</span> стовпців:</p>
                <p class="math-notation-centered">\[ A = \begin{pmatrix} a_{11} & a_{12} & \cdots & a_{1n} \\ a_{21} & a_{22} & \cdots & a_{2n} \\ \vdots & \vdots & \ddots & \vdots \\ a_{m1} & a_{m2} & \cdots & a_{mn} \end{pmatrix} \tag{5.1} \]</p>
                <p>де <span class="math-notation">\( a_{ij} \)</span> – елементи матриці, <span class="math-notation">\( i \)</span> – номер рядка (<span class="math-notation">\( i=1,2,\ldots,m \)</span>), а <span class="math-notation">\( j \)</span> – номер стовпця (<span class="math-notation">\( j=1,2,\ldots,n \)</span>). Таку матрицю позначають <span class="math-notation">\( A_{m \times n} \)</span> або просто <span class="math-notation">\( A \)</span>. Зазвичай для матриць використовують великі латинські літери: <span class="math-notation">\( A, B, C, D, E \)</span> тощо.</p>
                <p><span class="example">Приклад 5.1.</span> Розглянемо матрицю <span class="math-notation">\( A_{2 \times 3} \)</span> (читається як «два на три»):</p>
                <p class="math-notation-centered">\[ A = \begin{pmatrix} 4 & 2 & -10 \\ -1 & 0 & 5 \end{pmatrix} \]</p>
                <p><span class="solution">Розв’язання:</span></p>
                <p>Ця матриця має 2 рядки і 3 стовпці, тобто розмір <span class="math-notation">\( 2 \times 3 \)</span>. Її елементи: <span class="math-notation">\( a_{11}=4, a_{12}=2, a_{13}=-10, a_{21}=-1, a_{22}=0, a_{23}=5 .\)</span> Порядок елементів фіксований і визначає властивості матриці.</p>
                <p><span class="note">Примітка.</span> <span class="note-text">Розмір матриці завжди вказують як «кількість рядків × кількість стовпців».</span></p>
                <p><span class="main-types">Основні види матриць.</span> Матриці бувають різних видів, кожен із яких має свої особливості. Розглянемо основні типи.</p>
                <ol>
                    <li><span class="matrix-type">Квадратна матриця.</span> Матриця називається квадратною, якщо кількість рядків дорівнює кількості стовпців, тобто <span class="math-notation">\( m = n \)</span>. Її розмір – <span class="math-notation">\( n \times n \)</span>. Число <span class="math-notation">\( n \)</span> називають порядком матриці. Її загальний вигляд:</li>
                    <p class="math-notation-centered">\[ \begin{pmatrix} a_{11} & a_{12} & \cdots & a_{1n} \\ a_{21} & a_{22} & \cdots & a_{2n} \\ \vdots & \vdots & \ddots & \vdots \\ a_{n1} & a_{n2} & \cdots & a_{nn} \end{pmatrix} \tag{5.2} \]</p>
                    <p>Елементи <span class="math-notation">\( a_{11}, a_{22}, a_{33}, \ldots, a_{nn} \)</span> утворюють головну діагональ, а <span class="math-notation">\( a_{1n}, a_{2(n-1)}, a_{3(n-2)}, \ldots, a_{n1} \)</span> – побічну діагональ.</p>
                    <p>Наприклад, матриця <span class="math-notation">\( A_{3 \times 3} \)</span> – квадратна матриця третього порядку, її вигляд:</p>
                    <p class="math-notation-centered">\[ A = \begin{pmatrix} -2 & 0 & 3 \\ 5 & -4 & 7 \\ -6 & 2 & -4 \end{pmatrix} \]</p>
                    <p>Головна діагональ: <span class="math-notation">\( -2, -4, -4, \)</span> а побічна діагональ: <span class="math-notation">\( 3, -4, -6 \)</span>.</p>
                    <li><span class="matrix-type">Діагональна матриця.</span> Квадратна матриця, у якої усі елементи поза головною діагоналлю дорівнюють нулю, називається діагональною матрицею. Її загальний вигляд:</li>
                    <p class="math-notation-centered">\[ \begin{pmatrix} a_{11} & 0 & \cdots & 0 \\ 0 & a_{22} & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \cdots & a_{nn} \end{pmatrix} \tag{5.3} \]</p>
                    <p>Наприклад, діагональна матриця <span class="math-notation">\( A_{3 \times 3} \)</span>:</p>
                    <p class="math-notation-centered">\[ A = \begin{pmatrix} 3 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 5 \end{pmatrix} \]</p>
                    <p>У цій матриці головна діагональ складається з елементів <span class="math-notation">\( 3, 2, 5 \)</span>, а всі інші елементи дорівнюють нулю.</p>
                    <li><span class="matrix-type">Скалярна матриця.</span> Діагональна матриця, у якій усі елементи головної діагоналі однакові й рівні деякому числу <span class="math-notation">\( k \)</span> називається скалярною матрицею.</li>
                    <p>Наприклад, скалярна матриця <span class="math-notation">\( A_{3 \times 3} \)</span>:</p>
                    <p class="math-notation-centered">\[ A = \begin{pmatrix} 2 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 2 \end{pmatrix} \]</p>
                    <p>У цій матриці всі елементи головної діагоналі рівні <span class="math-notation">\( 2 \)</span>, а всі інші елементи дорівнюють нулю.</p>
                    <li><span class="matrix-type">Одинична матриця.</span> Діагональна матриця, у якій всі елементи головної діагоналі дорівнюють <span class="math-notation">\( 1 \)</span>, називається одиничною матрицею і позначається <span class="math-notation">\( E \)</span> або <span class="math-notation">\( I \)</span>. Загальний вигляд:</li>
                    <p class="math-notation-centered">\[ E = \begin{pmatrix} 1 & 0 & \cdots & 0 \\ 0 & 1 & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \cdots & 1 \end{pmatrix} \tag{5.4} \]</p>
                    <p>Наприклад, одинична матриця другого порядку: <span class="math-notation">\( E_{2 \times 2} = \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix} \)</span>;</p>
                    <p>одинична матриця третього порядку: <span class="math-notation">\( E_{3 \times 3} = \begin{pmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{pmatrix} \)</span>.</p>
                    <li><span class="matrix-type">Нульова матриця.</span> Матриця будь-якого розміру, усі елементи якої дорівнюють <span class="math-notation">\( 0 \)</span> називається нульовою матрицею. Позначається <span class="math-notation">\( O \)</span>. Загальний вигляд:</li>
                    <p class="math-notation-centered">\[ O = \begin{pmatrix} 0 & 0 & \cdots & 0 \\ 0 & 0 & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \cdots & 0 \end{pmatrix} \tag{5.5} \]</p>
                    <p>Наприклад, нульова матриця <span class="math-notation">\( O_{3 \times 3} \)</span>: <span class="math-notation">\( O = \begin{pmatrix} 0 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 0 \end{pmatrix} \)</span>.</p>
                    <li><span class="matrix-type">Матриця-рядок.</span> Матриця, що має лише один рядок (тобто <span class="math-notation">\( m = 1 \)</span>), називається матрицею-рядком і має загальний вигляд:</li>
                    <p class="math-notation-centered">\[ \begin{pmatrix} a_{11} & a_{12} & \cdots & a_{1n} \end{pmatrix} \tag{5.6} \]</p>
                    <p>Наприклад, матриця-рядок <span class="math-notation">\( A_{1 \times 4} \)</span>: <span class="math-notation">\( A = \begin{pmatrix} -3 & 2 & 1 & -2 \end{pmatrix} \)</span>.</p>
                    <li><span class="matrix-type">Матриця-стовпець.</span> Матриця, що має лише один стовпець (тобто <span class="math-notation">\( n = 1 \)</span>), називається матрицею-стовпцем і має загальний вигляд:</li>
                    <p class="math-notation-centered">\[ \begin{pmatrix} a_{11} \\ a_{21} \\ \vdots \\ a_{m1} \end{pmatrix} \tag{5.7} \]</p>
                    <p>Наприклад, матриця-стовпець <span class="math-notation">\( A_{3 \times 1} \)</span>: <span class="math-notation">\( A = \begin{pmatrix} 2 \\ 0 \\ -3 \end{pmatrix} \)</span>.</p>
                    <p><span class="note">Примітка.</span> <span class="note-text">Матриці-рядки часто називають векторами-рядками, а матриці-стовпці – векторами-стовпцями.</span></p>
                    <li><span class="matrix-type">Симетрична матриця.</span> Квадратна матриця, у якій елементи симетричні відносно головної діагоналі (<span class="math-notation">\( a_{ij} = a_{ji} \)</span>) називається симетричною матрицею.</li>
                    <p>Наприклад, симетрична матриця <span class="math-notation">\( A_{3 \times 3} \)</span>:</p>
                    <p class="math-notation-centered">\[ A = \begin{pmatrix} 1 & 2 & 3 \\ 2 & 4 & 5 \\ 3 & 5 & 6 \end{pmatrix} \]</p>
                    <li><span class="matrix-type">Трикутна матриця.</span> Трикутна матриця – це квадратна матриця, у якій усі елементи вище або нижче головної діагоналі дорівнюють нулю.</li>
                    <p>Верхня трикутна матриця має нулі нижче головної діагоналі. Наприклад:</p>
                    <p class="math-notation-centered">\[ A = \begin{pmatrix} -1 & 2 & 4 \\ 0 & 3 & -2 \\ 0 & 0 & 1 \end{pmatrix} \]</p>
                    <p>Нижня трикутна матриця має нулі вище головної діагоналі. Наприклад:</p>
                    <p class="math-notation-centered">\[ B = \begin{pmatrix} 2 & 0 & 0 \\ -5 & 7 & 0 \\ 4 & 1 & 3 \end{pmatrix} \]</p>
                    <li><span class="matrix-type">Трапецієвидна матриця.</span> Трапецієвидна матриця – це матриця довільного розміру, у якій усі ненульові елементи зосереджені у верхній або нижній частині, утворюючи область, що нагадує трапецію. Для верхньої трапецієвидної матриці менша основа трапеції розташована внизу, а для нижньої – угорі. Усередині цієї області можуть бути нульові елементи, але за її межами всі елементи матриці дорівнюють нулю.</li>
                    <p>Наприклад, верхня трапецієвидна матриця:</p>
                    <p class="math-notation-centered">\[ \begin{pmatrix} 1 & -2 & 3 \\ 0 & 5 & -6 \\ 0 & 0 & 0 \end{pmatrix} \]</p>
                    <p>Нижня трапецієвидна матриця:</p>
                    <p class="math-notation-centered">\[ \begin{pmatrix} 0 & 0 & 0 \\ -1 & 2 & 0 \\ 7 & 6 & -8 \end{pmatrix} \]</p>
                    <p><span class="note">Примітка.</span> <span class="note-text">Такі матриці, як діагональні, трикутні та трапецієподібні, іноді називають східчастими (або ступінчастими) матрицями. Вони часто виникають при розв’язанні систем лінійних рівнянь, обчисленні рангу чи знаходженні обернених матриць за допомогою елементарних перетворень.</span></p>
                </ol>
            </div>
        </div>
    </div>

  <!-- Video Modal -->
<div id="videoModal" class="modal">
    <div class="modal-header">
        <button class="close-btn" id="closeVideoBtn" aria-label="Закрити">× Закрити</button>
    </div>
    <div class="modal-content">
        <h2 class="glow-title">Оберіть відео</h2>
        <div class="video-card-container">
            <div class="video-card" data-video="1">
                <img src="https://img.icons8.com/?size=100&id=o1CR3NjO7Pv8&format=png&color=000000" alt="Відеокамера">
                <h3>Знайомство з матрицями</h3>
            </div>
            <div class="video-card" data-video="2">
                <img src="https://img.icons8.com/?size=100&id=o1CR3NjO7Pv8&format=png&color=000000" alt="Відеокамера">
                <h3>Матриці. Означення. Види</h3>
            </div>
            <div class="video-card" data-video="3">
                <img src="https://img.icons8.com/?size=100&id=o1CR3NjO7Pv8&format=png&color=000000" alt="Відеокамера">
                <h3>Використання матриць для задання даних. Автобусні маршрути</h3>
            </div>
        </div>
    </div>
</div>

<!-- Video Player Modals -->
<div id="videoPlayerModal1" class="modal">
    <div class="modal-header">
        <button class="close-btn" id="closeVideoPlayerBtn1" aria-label="Закрити">× Закрити</button>
    </div>
    <div class="modal-content">
        <div class="video-player-container">
            <iframe id="youtubePlayer1" width="100%" src="https://www.youtube.com/embed/0-Imd4qvjiI" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
    </div>
</div>

<div id="videoPlayerModal2" class="modal">
    <div class="modal-header">
        <button class="close-btn" id="closeVideoPlayerBtn2" aria-label="Закрити">× Закрити</button>
    </div>
    <div class="modal-content">
        <div class="video-player-container">
            <iframe id="youtubePlayer2" width="100%" src="https://www.youtube.com/embed/5hedMrmjgZQ" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
    </div>
</div>

<div id="videoPlayerModal3" class="modal">
    <div class="modal-header">
        <button class="close-btn" id="closeVideoPlayerBtn3" aria-label="Закрити">× Закрити</button>
    </div>
    <div class="modal-content">
        <div class="video-player-container">
            <iframe id="youtubePlayer3" width="100%" src="https://www.youtube.com/embed/LGUH6oFbrQU" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
    </div>
</div>

   <div id="questionsModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="questionsTitle">
    <div class="modal-header">
        <button class="close-btn" id="closeQuestionsBtn" aria-label="Закрити">× Закрити</button>
    </div>
    <div class="modal-content">
        
        <!-- Flashcard 1 -->
        <div class="question-card" onclick="this.classList.toggle('flipped')">
            <div class="card-inner">
                <div class="card-front">
                    <span>Що таке матриця?</span>
                </div>
                <div class="card-back">
                    <span>Матриця – це прямокутна таблиця чисел або символів, розташованих у \( m \) рядках і \( n \) стовпцях. Елементи матриці мають фіксований порядок, зміна якого утворює іншу матрицю.</span>
                </div>
            </div>
        </div>
        <!-- Flashcard 2 -->
        <div class="question-card" onclick="this.classList.toggle('flipped')">
            <div class="card-inner">
                <div class="card-front">
                    <span>Як визначають та позначають розмір матриці?</span>
                </div>
                <div class="card-back">
                    <span>Розмір матриці визначають кількістю рядків і стовпців, записуючи його як \( m \times n \) (\( m \) — кількість рядків, \( n \) — кількість стовпців). Наприклад, матриця розміру \( 2 \times 3 \) має \( 2 \) рядки і \( 3 \) стовпці.</span>
                </div>
            </div>
        </div>
        <!-- Flashcard 3 -->
        <div class="question-card" onclick="this.classList.toggle('flipped')">
            <div class="card-inner">
                <div class="card-front">
                    <span>Що таке квадратна матриця?</span>
                </div>
                <div class="card-back">
                    <span>Квадратна матриця — це матриця, у якої кількість рядків дорівнює кількості стовпців, тобто \( m = n \). Її розмір записують як \( n \times n \).</span>
                </div>
            </div>
        </div>
        <!-- Flashcard 4 -->
        <div class="question-card" onclick="this.classList.toggle('flipped')">
            <div class="card-inner">
                <div class="card-front">
                    <span>Яка матриця називається нульовою?</span>
                </div>
                <div class="card-back">
                    <span>Нульова матриця — це матриця будь-якого розміру, усі елементи якої дорівнюють нулю. Позначають її літерою \( O \).</span>
                </div>
            </div>
        </div>
        <!-- Flashcard 5 -->
        <div class="question-card" onclick="this.classList.toggle('flipped')">
            <div class="card-inner">
                <div class="card-front">
                    <span>Що таке одинична матриця?</span>
                </div>
                <div class="card-back">
                    <span>Одинична матриця — це квадратна матриця, у якої всі елементи головної діагоналі дорівнюють \( 1 \), а решта елементів — \( 0 \). Позначають її літерою \( E \) або \( I \).</span>
                </div>
            </div>
        </div>
        <!-- Flashcard 6 -->
        <div class="question-card" onclick="this.classList.toggle('flipped')">
            <div class="card-inner">
                <div class="card-front">
                    <span>Як виглядає вектор-рядок?</span>
                </div>
                <div class="card-back">
                    <span>Вектор-рядок (або матриця-рядок) — це матриця, що має лише один рядок (\( m = 1 \)). Наприклад: \( A = \begin{pmatrix} -3 & 2 & 1 & -2 \end{pmatrix} \).</span>
                </div>
            </div>
        </div>
        <!-- Flashcard 7 -->
        <div class="question-card" onclick="this.classList.toggle('flipped')">
            <div class="card-inner">
                <div class="card-front">
                    <span>Як визначити, чи є матриця симетричною?</span>
                </div>
                <div class="card-back">
                    <span>Матриця є симетричною, якщо вона квадратна і її елементи симетричні відносно головної діагоналі, тобто виконується умова \( a_{ij} = a_{ji} \) для всіх \( i \) та \( j \).</span>
                </div>
            </div>
        </div>
        <!-- Flashcard 8 -->
        <div class="question-card" onclick="this.classList.toggle('flipped')">
            <div class="card-inner">
                <div class="card-front">
                    <span>Що таке трикутна матриця?</span>
                </div>
                <div class="card-back">
                    <span>Трикутна матриця — квадратна матриця, у якій усі елементи вище або нижче головної діагоналі дорівнюють нулю. Буває верхня (нулі під діагоналлю) і нижня (нулі над діагоналлю).</span>
                </div>
            </div>
        </div>
    </div>
</div>

 <div id="trainerModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="trainerTitle">
    <div class="modal-header">
        <button class="close-btn" id="closeTrainerBtn" aria-label="Закрити">× Закрити</button>
    </div>
    <div class="modal-content">
        <div class="trainer-container" id="trainerContent">
            <div class="question-circle">
                <h3 id="questionNumber"></h3>
            </div>
            <p id="questionText" class="math-notation-centered"></p>
            <div class="options-container" id="optionsContainer"></div>
            <div id="inputContainer" class="input-container hidden">
                <input type="text" id="answerInput" aria-label="Введіть число від -9 до 9" placeholder="Число">
            </div>
            <button id="submitAnswer" disabled>Відповісти</button>
            <div id="feedback" class="feedback"></div>
            <div id="completionBlock" class="completion-message hidden">
                <div class="completion-emoji"></div>
                <h2>МІСІЯ ВИКОНАНА!</h2>
     <p>Солдате, фундамент закладено! Матриці та їх різновиди під контролем!</p>
    <p><strong>СЛАВА УКРАЇНІ!</strong></p>
    <button id="resetTrainerBtn">Повернутися на полігон!</button>
            </div>
        </div>
    </div>
</div>
<div id="modalOverlay"></div>

    <script>
document.addEventListener('DOMContentLoaded', function () {
    console.log("DOM повністю завантажено");
    document.body.classList.add('loaded');

    const elements = {
        openTheoryBtn: document.getElementById('openTheoryBtn'),
        openVideoBtn: document.getElementById('openVideoBtn'),
        openQuestionsBtn: document.getElementById('openQuestionsBtn'),
        openTrainerBtn: document.getElementById('openTrainerBtn'),
        theoryModal: document.getElementById('theoryModal'),
        videoModal: document.getElementById('videoModal'),
        questionsModal: document.getElementById('questionsModal'),
        trainerModal: document.getElementById('trainerModal'),
        closeTheoryBtn: document.getElementById('closeTheoryBtn'),
        closeVideoBtn: document.getElementById('closeVideoBtn'),
        closeQuestionsBtn: document.getElementById('closeQuestionsBtn'),
        closeTrainerBtn: document.getElementById('closeTrainerBtn'),
        closeVideoPlayerBtn1: document.getElementById('closeVideoPlayerBtn1'),
        closeVideoPlayerBtn2: document.getElementById('closeVideoPlayerBtn2'),
        closeVideoPlayerBtn3: document.getElementById('closeVideoPlayerBtn3'),
        videoPlayerModal1: document.getElementById('videoPlayerModal1'),
        videoPlayerModal2: document.getElementById('videoPlayerModal2'),
        videoPlayerModal3: document.getElementById('videoPlayerModal3'),
        modalOverlay: document.getElementById('modalOverlay'),
        questionNumber: document.getElementById('questionNumber'),
        questionText: document.getElementById('questionText'),
        optionsContainer: document.getElementById('optionsContainer'),
        inputContainer: document.getElementById('inputContainer'),
        answerInput: document.getElementById('answerInput'),
        submitAnswer: document.getElementById('submitAnswer'),
        feedback: document.getElementById('feedback'),
        completionBlock: document.getElementById('completionBlock'),
        resetTrainerBtn: document.getElementById('resetTrainerBtn'),
        youtubePlayer1: document.getElementById('youtubePlayer1'),
        youtubePlayer2: document.getElementById('youtubePlayer2'),
        youtubePlayer3: document.getElementById('youtubePlayer3')
    };

    let players = {};
    const playerIds = {
        'youtubePlayer1': '0-Imd4qvjiI',
        'youtubePlayer2': '5hedMrmjgZQ',
        'youtubePlayer3': 'LGUH6oFbrQU'
    };

    const playerSrcs = {
        'youtubePlayer1': elements.youtubePlayer1 ? elements.youtubePlayer1.src : '',
        'youtubePlayer2': elements.youtubePlayer2 ? elements.youtubePlayer2.src : '',
        'youtubePlayer3': elements.youtubePlayer3 ? elements.youtubePlayer3.src : ''
    };

    function loadYouTubeAPI() {
        if (!window.YT) {
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        }
    }

    window.onYouTubeIframeAPIReady = function() {
        Object.keys(playerIds).forEach(playerId => {
            const element = elements[playerId];
            if (element) {
                players[playerId] = new YT.Player(playerId, {
                    videoId: playerIds[playerId],
                    playerVars: {
                        'autoplay': 0,
                        'controls': 1,
                        'rel': 0,
                        'showinfo': 0
                    },
                    events: {
                        'onReady': function(event) {
                            console.log(`YouTube плеєр ${playerId} готовий`);
                        },
                        'onError': function(error) {
                            console.error(`Помилка YouTube плеєра ${playerId}:`, error);
                        }
                    }
                });
            }
        });
    };

    loadYouTubeAPI();

    function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function generateRandomMatrix() {
        const sizes = [
            [1, 1], [1, 2], [2, 1], [2, 2], [3, 1], [1, 3], [3, 2], [2, 3], [3, 3],
            [4, 1], [1, 4], [4, 2], [2, 4], [4, 3], [3, 4], [4, 4]
        ];
        const [rows, cols] = sizes[getRandomInt(0, sizes.length - 1)];
        const matrix = [];
        for (let i = 0; i < rows; i++) {
            const row = [];
            for (let j = 0; j < cols; j++) {
                row.push(getRandomInt(-9, 9));
            }
            matrix.push(row);
        }
        return { matrix, rows, cols };
    }

    function matrixToLatex(matrix, rows, cols) {
        let latex = '\\begin{pmatrix} ';
        for (let i = 0; i < rows; i++) {
            for (let j = 0; j < cols; j++) {
                latex += matrix[i][j];
                if (j < cols - 1) latex += ' & ';
            }
            if (i < rows - 1) latex += ' \\\\ ';
        }
        latex += ' \\end{pmatrix}';
        return latex;
    }

    function generateOptions(correctRows, correctCols) {
        const correct = `${correctRows} \\times ${correctCols}`;
        const options = new Set([correct]);
        while (options.size < 4) {
            const rows = getRandomInt(1, 4);
            const cols = getRandomInt(1, 4);
            options.add(`${rows} \\times ${cols}`);
        }
        return Array.from(options).sort(() => Math.random() - 0.5);
    }

    function generateMatrixForType3(type) {
        const matrix = Array(3).fill().map(() => Array(3).fill(0));
        if (type === 'діагональна') {
            for (let i = 0; i < 3; i++) {
                matrix[i][i] = getRandomInt(-5, 5);
                if (matrix[i][i] === 0) matrix[i][i] = getRandomInt(1, 5);
            }
        } else if (type === 'одинична') {
            for (let i = 0; i < 3; i++) {
                matrix[i][i] = 1;
            }
        } else if (type === 'нульова') {
            // Усі елементи вже 0
        } else if (type === 'трикутна') {
            const isUpper = Math.random() > 0.5;
            if (isUpper) {
                for (let i = 0; i < 3; i++) {
                    for (let j = i; j < 3; j++) {
                        matrix[i][j] = getRandomInt(-5, 5);
                    }
                }
                if (matrix[0][0] === 0 && matrix[1][1] === 0 && matrix[2][2] === 0) {
                    matrix[0][0] = getRandomInt(1, 5);
                }
            } else {
                for (let i = 0; i < 3; i++) {
                    for (let j = 0; j <= i; j++) {
                        matrix[i][j] = getRandomInt(-5, 5);
                    }
                }
                if (matrix[0][0] === 0 && matrix[1][1] === 0 && matrix[2][2] === 0) {
                    matrix[0][0] = getRandomInt(1, 5);
                }
            }
        } else if (type === 'трапецієвидна') {
            const isUpper = Math.random() > 0.5;
            let hasNonZero = false;
            do {
                for (let i = 0; i < 3; i++) {
                    for (let j = 0; j < 3; j++) {
                        matrix[i][j] = 0;
                    }
                }
                if (isUpper) {
                    const fillSecondRow = Math.random() > 0.5;
                    for (let j = 0; j < 3; j++) {
                        matrix[0][j] = getRandomInt(-5, 5);
                        if (fillSecondRow && j >= 1) {
                            matrix[1][j] = getRandomInt(-5, 5);
                        }
                    }
                    hasNonZero = matrix[0].some(el => el !== 0);
                } else {
                    for (let i = 1; i < 3; i++) {
                        for (let j = 0; j < 3; j++) {
                            matrix[i][j] = getRandomInt(-5, 5);
                        }
                    }
                    hasNonZero = matrix[1].some(el => el !== 0) || matrix[2].some(el => el !== 0);
                }
            } while (!hasNonZero);
        }
        return matrix;
    }

    function generateMatrixForSymmetry() {
        const matrix = Array(3).fill().map(() => Array(3).fill(0));
        const isSymmetric = Math.random() > 0.5;
        if (isSymmetric) {
            for (let i = 0; i < 3; i++) {
                for (let j = i; j < 3; j++) {
                    matrix[i][j] = getRandomInt(-9, 9);
                    matrix[j][i] = matrix[i][j];
                }
            }
        } else {
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 3; j++) {
                    matrix[i][j] = getRandomInt(-9, 9);
                }
            }
            const i = getRandomInt(0, 2);
            const j = getRandomInt(0, 2);
            if (i !== j) {
                matrix[i][j] = matrix[j][i] + 1;
            } else {
                matrix[0][1] = matrix[1][0] + 1;
            }
        }
        return { matrix, isSymmetric };
    }

    function formatNumberForLatex(num) {
        return num < 0 ? `(${num})` : `${num}`;
    }

    function generateTriangularMatrixForDeterminant() {
        const matrix = Array(3).fill().map(() => Array(3).fill(0));
        const isUpper = Math.random() > 0.5;
        let diag1, diag2, diag3;

        // Генеруємо ненульові діагональні елементи
        do {
            diag1 = getRandomInt(-9, 9);
        } while (diag1 === 0);
        do {
            diag2 = getRandomInt(-9, 9);
        } while (diag2 === 0);
        do {
            diag3 = getRandomInt(-9, 9);
        } while (diag3 === 0);

        if (isUpper) {
            // Верхня трикутна матриця
            matrix[0][0] = diag1;
            matrix[0][1] = getRandomInt(-9, 9);
            matrix[0][2] = getRandomInt(-9, 9);
            matrix[1][1] = diag2;
            matrix[1][2] = getRandomInt(-9, 9);
            matrix[2][2] = diag3;
        } else {
            // Нижня трикутна матриця
            matrix[0][0] = diag1;
            matrix[1][0] = getRandomInt(-9, 9);
            matrix[1][1] = diag2;
            matrix[2][0] = getRandomInt(-9, 9);
            matrix[2][1] = getRandomInt(-9, 9);
            matrix[2][2] = diag3;
        }

        // Форматуємо діагональні елементи для LaTeX
        const formattedDiag1 = formatNumberForLatex(diag1);
        const formattedDiag2 = formatNumberForLatex(diag2);
        const formattedDiag3 = formatNumberForLatex(diag3);

        // Обчислюємо визначник
        const det = isUpper ? (diag1 * diag2 * diag3) : -(diag3 * diag2 * diag1);
        const correctOption = isUpper 
            ? `${formattedDiag1} \\cdot ${formattedDiag2} \\cdot ${formattedDiag3}`
            : `-(${formattedDiag3} \\cdot ${formattedDiag2} \\cdot ${formattedDiag1})`;

        // Генеруємо неправильні варіанти
        const wrongOptions = new Set();
        while (wrongOptions.size < 3) {
            const type = getRandomInt(0, 2);
            let option;
            if (type === 0) {
                // Неправильне множення (змінюємо один елемент)
                let wrongVal;
                do {
                    wrongVal = getRandomInt(-9, 9);
                } while (wrongVal === diag1 || wrongVal === 0);
                const formattedWrongVal = formatNumberForLatex(wrongVal);
                option = isUpper 
                    ? `${formattedWrongVal} \\cdot ${formattedDiag2} \\cdot ${formattedDiag3}`
                    : `-(${formattedWrongVal} \\cdot ${formattedDiag2} \\cdot ${formattedDiag1})`;
            } else if (type === 1) {
                // Додавання замість множення
                option = `${formattedDiag1} + ${formattedDiag2} + ${formattedDiag3}`;
            } else {
                // Неправильна комбінація елементів
                let other1, other2;
                do {
                    other1 = getRandomInt(-9, 9);
                } while (other1 === 0 || other1 === diag1);
                do {
                    other2 = getRandomInt(-9, 9);
                } while (other2 === 0 || other2 === diag2);
                const formattedOther1 = formatNumberForLatex(other1);
                const formattedOther2 = formatNumberForLatex(other2);
                option = isUpper 
                    ? `${formattedOther1} \\cdot ${formattedOther2} \\cdot ${formattedDiag3}`
                    : `-(${formattedOther1} \\cdot ${formattedOther2} \\cdot ${formattedDiag3})`;
            }
            if (option !== correctOption && !wrongOptions.has(option)) wrongOptions.add(option);
        }

        const options = [correctOption, ...Array.from(wrongOptions)].sort(() => Math.random() - 0.5);
        return { matrix, options, correct: correctOption, isUpper };
    }

    const questionPool = [
        {
            generate: () => {
                const { matrix, rows, cols } = generateRandomMatrix();
                return {
                    type: 'options',
                    question: `Вказати розмір матриці \\[${matrixToLatex(matrix, rows, cols)}\\]`,
                    options: generateOptions(rows, cols),
                    correct: `${rows} \\times ${cols}`
                };
            }
        },
        {
            generate: () => {
                const { matrix, rows, cols } = generateRandomMatrix();
                const i = getRandomInt(1, rows);
                const j = getRandomInt(1, cols);
                const correctAnswer = matrix[i - 1][j - 1];
                return {
                    type: 'input',
                    question: `Чому дорівнює елемент \\( a_{${i}${j}} \\) матриці \\[ A = ${matrixToLatex(matrix, rows, cols)} \\]`,
                    correct: correctAnswer.toString()
                };
            }
        },
        {
            generate: () => {
                const types = ['діагональна', 'одинична', 'нульова', 'трикутна', 'трапецієвидна'];
                const correctType = types[getRandomInt(0, types.length - 1)];
                const matrix = generateMatrixForType3(correctType);
                const options = types.sort(() => Math.random() - 0.5);
                return {
                    type: 'options',
                    question: `Вказати тип матриці \\[${matrixToLatex(matrix, 3, 3)}\\]`,
                    options: options,
                    correct: correctType
                };
            }
        },
        {
            generate: () => {
                const { matrix, isSymmetric } = generateMatrixForSymmetry();
                return {
                    type: 'options',
                    question: `Чи є матриця \\[${matrixToLatex(matrix, 3, 3)}\\] симетричною?`,
                    options: ['Так', 'Ні'],
                    correct: isSymmetric ? 'Так' : 'Ні'
                };
            }
        },
        {
            generate: () => {
                const { matrix, options, correct } = generateTriangularMatrixForDeterminant();
                return {
                    type: 'options',
                    question: `Визначник даної трикутної матриці \\[${matrixToLatex(matrix, 3, 3)}\\] можна обчислити як`,
                    options: options,
                    correct: correct
                };
            }
        }
    ];

    let questions = [];
    let currentQuestionIndex = 0;
    let selectedOption = null;

    function initializeQuestions() {
        questions = [];
        questions.push(questionPool[0].generate());
        questions.push(questionPool[1].generate());
        questions.push(questionPool[2].generate());
        questions.push(questionPool[3].generate());
        questions.push(questionPool[4].generate());
    }

    function waitForMathJax(callback, maxAttempts = 10, attempt = 0) {
        if (window.MathJax && MathJax.typesetPromise) {
            MathJax.typesetPromise([elements.questionText, elements.optionsContainer]).then(() => {
                console.log("MathJax типізація завершена для питання");
                callback();
            }).catch(err => console.error('Помилка MathJax:', err));
        } else if (attempt < maxAttempts) {
            console.warn(`MathJax не завантажено, спроба ${attempt + 1}/${maxAttempts}`);
            setTimeout(() => waitForMathJax(callback, maxAttempts, attempt + 1), 200);
        } else {
            console.warn('MathJax не завантажено після максимальної кількості спроб, продовжуємо без типізації');
            callback();
        }
    }

    function displayQuestion() {
        console.log("Відображення питання:", currentQuestionIndex);
        selectedOption = null;

        if (elements.answerInput) {
            elements.answerInput.value = '';
            console.log("Поле answerInput очищено");
        }
        if (elements.submitAnswer) {
            elements.submitAnswer.disabled = true;
            console.log("Кнопка submitAnswer відключена");
        }
        if (elements.optionsContainer) {
            elements.optionsContainer.innerHTML = '';
            elements.optionsContainer.style.display = 'none';
            console.log("optionsContainer очищено і приховано");
        }
        if (elements.inputContainer) {
            elements.inputContainer.classList.add('hidden');
            console.log("inputContainer приховано:", elements.inputContainer.className);
        }

        if (elements.questionNumber && elements.questionNumber.parentElement) {
            elements.questionNumber.parentElement.style.display = 'flex';
            elements.questionNumber.textContent = `Питання ${currentQuestionIndex + 1}`;
            console.log("Номер питання оновлено:", elements.questionNumber.textContent);
        }
        if (elements.questionText) {
            elements.questionText.style.display = 'block';
            console.log("questionText відображено");
        }
        if (elements.submitAnswer) {
            elements.submitAnswer.style.display = 'block';
            console.log("submitAnswer відображено");
        }
        if (elements.completionBlock) {
            elements.completionBlock.classList.add('hidden');
            console.log("completionBlock приховано");
        }

        if (elements.questionText) {
            elements.questionText.innerHTML = questions[currentQuestionIndex].question;
            console.log("Текст питання встановлено:", questions[currentQuestionIndex].question);
        }

        if (questions[currentQuestionIndex].type === 'options') {
            if (elements.optionsContainer) {
                elements.optionsContainer.style.display = 'flex';
                if (elements.inputContainer) {
                    elements.inputContainer.classList.add('hidden');
                    console.log("Питання 1, 3, 4 або 5: inputContainer приховано:", elements.inputContainer.className);
                }
                questions[currentQuestionIndex].options.forEach((option, index) => {
                    const optionElement = document.createElement('div');
                    optionElement.className = 'option' + (currentQuestionIndex >= 2 ? ' text-option' : '');
                    optionElement.innerHTML = `\\(${option}\\)`; // Усі варіанти для питань 1, 3, 4, 5 рендеряться як LaTeX
                    optionElement.setAttribute('tabindex', '0');
                    optionElement.setAttribute('data-option', option);
                    optionElement.setAttribute('role', 'button');
                    optionElement.setAttribute('aria-label', `Варіант відповіді ${index + 1}: ${option}`);
                    elements.optionsContainer.appendChild(optionElement);
                });
                console.log("Варіанти відповідей додано до optionsContainer");
            }
        } else if (questions[currentQuestionIndex].type === 'input') {
            if (elements.optionsContainer) {
                elements.optionsContainer.style.display = 'none';
                console.log("optionsContainer приховано для Питання 2");
            }
            if (elements.inputContainer) {
                elements.inputContainer.classList.remove('hidden');
                console.log("Питання 2: inputContainer показано:", elements.inputContainer.className);
            }
            if (elements.answerInput) {
                elements.answerInput.focus();
                console.log("Фокус на answerInput");
            }
        }

        waitForMathJax(() => {
            console.log("MathJax типізація завершена");
            if (questions[currentQuestionIndex].type === 'options') {
                const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
                const eventTypes = isTouchDevice ? ['touchstart', 'touchend'] : ['click'];

                document.querySelectorAll('.option').forEach((optionElement, index) => {
                    const option = questions[currentQuestionIndex].options[index];
                    const newOptionElement = optionElement.cloneNode(true);
                    optionElement.parentNode.replaceChild(newOptionElement, optionElement);

                    eventTypes.forEach(eventType => {
                        newOptionElement.addEventListener(eventType, (e) => {
                            console.log(`Подія ${eventType} на варіанті ${index + 1}: ${option}`);
                            if (eventType === 'touchstart') e.preventDefault();
                            handleOptionSelection(e, newOptionElement, option);
                        }, { passive: eventType !== 'touchstart' });
                    });

                    if (!isTouchDevice) {
                        newOptionElement.addEventListener('mouseover', () => {
                            if (!newOptionElement.classList.contains('selected')) {
                                newOptionElement.style.background = '#4ade80';
                                newOptionElement.style.transform = 'scale(1.03)';
                            }
                        });
                        newOptionElement.addEventListener('mouseout', () => {
                            if (!newOptionElement.classList.contains('selected')) {
                                newOptionElement.style.background = '#3b4a5a';
                                newOptionElement.style.transform = 'scale(1)';
                            }
                        });
                    }

                    newOptionElement.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            handleOptionSelection(e, newOptionElement, option);
                        }
                    });

                    newOptionElement.querySelectorAll('mjx-container, mjx-container *').forEach(el => {
                        el.style.pointerEvents = 'none';
                    });
                });
                console.log("Обробники подій для варіантів відповідей додано");
            }
            if (elements.inputContainer) {
                console.log("Перевірка inputContainer після MathJax:", elements.inputContainer.className);
                if (questions[currentQuestionIndex].type === 'options' && !elements.inputContainer.classList.contains('hidden')) {
                    elements.inputContainer.classList.add('hidden');
                    console.log("Додатково приховано inputContainer для Питання 1, 3, 4 або 5:", elements.inputContainer.className);
                }
            }
        });
    }

    function handleOptionSelection(e, optionElement, option) {
        e.preventDefault();
        document.querySelectorAll('.option').forEach(opt => {
            opt.classList.remove('selected');
            opt.setAttribute('aria-selected', 'false');
            opt.style.background = '#3b4a5a';
            opt.style.transform = 'scale(1)';
            opt.style.border = '1.5px solid #a855f7';
        });

        optionElement.classList.add('selected');
        optionElement.setAttribute('aria-selected', 'true');
        optionElement.style.background = '#fef08a';
        optionElement.style.border = '2px solid #FFD700';
        selectedOption = option;
        elements.submitAnswer.disabled = false;
    }

    function showFeedback(message, isCorrect) {
        elements.feedback.innerHTML = message;
        elements.feedback.className = `feedback ${isCorrect ? 'correct-feedback' : 'incorrect-feedback'}`;
        elements.feedback.style.opacity = '1';
        setTimeout(() => {
            elements.feedback.style.opacity = '0';
        }, 2000);
    }

    elements.answerInput.addEventListener('input', () => {
        let value = elements.answerInput.value.trim();
        if (!/^(-?\d{0,1})$|^$/.test(value)) {
            value = value.replace(/[^0-9-]/g, '');
            if (value.startsWith('-') && value.length > 2) {
                value = '-' + value.replace(/[^0-9]/g, '').slice(0, 1);
            } else if (!value.startsWith('-') && value.length > 1) {
                value = value.replace(/[^0-9]/g, '').slice(0, 1);
            }
            elements.answerInput.value = value;
        }
        if (value === '' || value === '-') {
            elements.submitAnswer.disabled = true;
            selectedOption = null;
        } else {
            const num = parseInt(value);
            if (num >= -9 && num <= 9) {
                selectedOption = value;
                elements.submitAnswer.disabled = false;
            } else {
                elements.answerInput.value = value.slice(0, value.startsWith('-') ? 2 : 1);
                selectedOption = elements.answerInput.value;
                elements.submitAnswer.disabled = false;
            }
        }
    });

    elements.submitAnswer.addEventListener('click', () => {
        if (!selectedOption) return;
        const correctAnswer = questions[currentQuestionIndex].correct;
        if (questions[currentQuestionIndex].type === 'options') {
            document.querySelectorAll('.option').forEach(opt => {
                if (opt.getAttribute('data-option') === correctAnswer) {
                    opt.classList.add('correct');
                } else if (opt.getAttribute('data-option') === selectedOption) {
                    opt.classList.add('incorrect');
                }
                opt.classList.add('disabled');
                opt.style.pointerEvents = 'none';
            });
        }

        if (selectedOption === correctAnswer) {
            showFeedback('✅ ВІРНО! Ціль уражена!', true);
            setTimeout(() => {
                currentQuestionIndex++;
                if (currentQuestionIndex < questions.length) {
                    displayQuestion();
                } else {
                    elements.questionNumber.parentElement.style.display = 'none';
                    elements.questionText.style.display = 'none';
                    elements.optionsContainer.style.display = 'none';
                    elements.inputContainer.classList.add('hidden');
                    elements.submitAnswer.style.display = 'none';
                    elements.feedback.style.opacity = '0';
                    elements.completionBlock.classList.remove('hidden');
                    elements.resetTrainerBtn.focus();
                    if (window.MathJax && MathJax.typesetPromise) {
                        MathJax.typesetPromise([elements.completionBlock]).catch(err => console.error('Помилка MathJax:', err));
                    }
                }
            }, 2000);
        } else {
            showFeedback('❌ Промах! Спробуй ще!', false);
            setTimeout(() => {
                questions[currentQuestionIndex] = questionPool[currentQuestionIndex].generate();
                displayQuestion();
            }, 2000);
        }
    });

    elements.resetTrainerBtn.addEventListener('click', () => {
        console.log("Кнопка скидання натиснута");
        currentQuestionIndex = 0;
        initializeQuestions();
        displayQuestion();
    });

    function stopAllVideos() {
        Object.keys(players).forEach(playerId => {
            const player = players[playerId];
            const element = elements[playerId];
            if (player && typeof player.stopVideo === 'function') {
                try {
                    player.stopVideo();
                    console.log(`Зупинено відео через API: ${playerId}`);
                } catch (e) {
                    console.error(`Помилка при зупинці відео ${playerId}:`, e);
                }
            }
            if (element) {
                element.src = '';
                console.log(`Очищено src для ${playerId}`);
                const parent = element.parentNode;
                const newIframe = document.createElement('iframe');
                newIframe.id = playerId;
                newIframe.className = element.className;
                newIframe.setAttribute('data-src', playerSrcs[playerId]);
                newIframe.setAttribute('frameborder', '0');
                newIframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
                newIframe.setAttribute('allowfullscreen', '');
                parent.replaceChild(newIframe, element);
                elements[playerId] = newIframe;
                console.log(`Замінено iframe для ${playerId}`);
                players[playerId] = new YT.Player(playerId, {
                    videoId: playerIds[playerId],
                    playerVars: {
                        'autoplay': 0,
                        'controls': 1,
                        'rel': 0,
                        'showinfo': 0
                    },
                    events: {
                        'onReady': function(event) {
                            console.log(`YouTube плеєр ${playerId} переініціалізовано`);
                        },
                        'onError': function(error) {
                            console.error(`Помилка YouTube плеєра ${playerId}:`, error);
                        }
                    }
                });
            }
        });
    }

    function toggleModal(modal, show) {
        const allModals = [
            elements.theoryModal,
            elements.videoModal,
            elements.questionsModal,
            elements.trainerModal,
            elements.videoPlayerModal1,
            elements.videoPlayerModal2,
            elements.videoPlayerModal3
        ].filter(Boolean);
        allModals.forEach(m => {
            if (m && m !== modal) m.style.display = 'none';
        });
        modal.style.display = show ? 'flex' : 'none';
        elements.modalOverlay.style.display = show ? 'block' : 'none';
        document.body.style.overflow = show ? 'hidden' : 'auto';
        if (show) {
            const closeBtn = modal.querySelector('.close-btn');
            if (closeBtn) closeBtn.focus();
            if (modal === elements.trainerModal) {
                currentQuestionIndex = 0;
                initializeQuestions();
                displayQuestion();
            }
            if (window.MathJax && MathJax.typesetPromise) {
                MathJax.typesetPromise(['#trainerContent', '#questionsModal', '#theoryModal', '#videoModal', '#videoPlayerModal1', '#videoPlayerModal2', '#videoPlayerModal3']).then(() => {
                    console.log(`MathJax типізація завершена для ${modal.id}`);
                    const modalContent = modal.querySelector('.modal-content');
                    if (modalContent) {
                        modalContent.scrollTop = 0;
                        console.log(`Прокручено до верху modal-content для ${modal.id}`);
                    }
                }).catch(err => console.error('Помилка MathJax:', err));
            }
        }
    }

    function openVideoPlayerModal(videoModal, playerId) {
        stopAllVideos();
        toggleModal(elements.videoModal, false);
        toggleModal(videoModal, true);
        const element = elements[playerId];
        if (element && !element.src) {
            element.src = playerSrcs[playerId];
            console.log(`Відновлено src для ${playerId}: ${playerSrcs[playerId]}`);
        }
        if (players[playerId] && typeof players[playerId].loadVideoById === 'function') {
            try {
                players[playerId].loadVideoById(playerIds[playerId]);
                console.log(`Завантаження відео: ${playerId} з videoId ${playerIds[playerId]}`);
            } catch (e) {
                console.error(`Помилка при завантаженні відео ${playerId}:`, e);
            }
        }
    }

    elements.openTheoryBtn?.addEventListener('click', () => toggleModal(elements.theoryModal, true));
    elements.openVideoBtn?.addEventListener('click', () => toggleModal(elements.videoModal, true));
    elements.openQuestionsBtn?.addEventListener('click', () => toggleModal(elements.questionsModal, true));
    elements.openTrainerBtn?.addEventListener('click', () => toggleModal(elements.trainerModal, true));

    elements.closeTheoryBtn?.addEventListener('click', () => toggleModal(elements.theoryModal, false));
    elements.closeVideoBtn?.addEventListener('click', () => toggleModal(elements.videoModal, false));
    elements.closeQuestionsBtn?.addEventListener('click', () => toggleModal(elements.questionsModal, false));
    elements.closeTrainerBtn?.addEventListener('click', () => toggleModal(elements.trainerModal, false));

    elements.closeVideoPlayerBtn1?.addEventListener('click', () => {
        stopAllVideos();
        setTimeout(() => {
            toggleModal(elements.videoPlayerModal1, false);
            toggleModal(elements.videoModal, true);
        }, 50);
    });
    elements.closeVideoPlayerBtn2?.addEventListener('click', () => {
        stopAllVideos();
        setTimeout(() => {
            toggleModal(elements.videoPlayerModal2, false);
            toggleModal(elements.videoModal, true);
        }, 50);
    });
    elements.closeVideoPlayerBtn3?.addEventListener('click', () => {
        stopAllVideos();
        setTimeout(() => {
            toggleModal(elements.videoPlayerModal3, false);
            toggleModal(elements.videoModal, true);
        }, 50);
    });

    elements.modalOverlay?.addEventListener('click', () => {
        stopAllVideos();
        toggleModal(elements.theoryModal, false);
        toggleModal(elements.videoModal, false);
        toggleModal(elements.questionsModal, false);
        toggleModal(elements.trainerModal, false);
        toggleModal(elements.videoPlayerModal1, false);
        toggleModal(elements.videoPlayerModal2, false);
        toggleModal(elements.videoPlayerModal3, false);
    });

    document.addEventListener('keydown', e => {
        if (e.key === 'Escape') {
            stopAllVideos();
            toggleModal(elements.theoryModal, false);
            toggleModal(elements.videoModal, false);
            toggleModal(elements.questionsModal, false);
            toggleModal(elements.trainerModal, false);
            toggleModal(elements.videoPlayerModal1, false);
            toggleModal(elements.videoPlayerModal2, false);
            toggleModal(elements.videoPlayerModal3, false);
        }
    });

    document.querySelectorAll('.video-card').forEach(card => {
        card.addEventListener('click', () => {
            const videoId = card.dataset.video;
            console.log('Натиснуто відеокарточку, відкриваємо відеоплеєр:', videoId);
            const videoModal = elements[`videoPlayerModal${videoId}`];
            const playerId = `youtubePlayer${videoId}`;
            if (videoModal) {
                openVideoPlayerModal(videoModal, playerId);
            } else {
                console.error('Модальне вікно для videoId не знайдено:', videoId);
            }
        });
    });

    Object.keys(playerSrcs).forEach(playerId => {
        const element = elements[playerId];
        if (element && playerSrcs[playerId]) {
            element.setAttribute('data-src', playerSrcs[playerId]);
        }
    });
});
    </script>
</body>
</html>




