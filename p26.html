<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>26. –ö—Ä–∏—Ç–µ—Ä—ñ–π —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ —Å–∏—Å—Ç–µ–º–∏ –ª—ñ–Ω—ñ–π–Ω–∏—Ö –∞–ª–≥–µ–±—Ä–∞—ó—á–Ω–∏—Ö —Ä—ñ–≤–Ω—è–Ω—å</title>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            startup: {
                ready: () => {
                    console.log("MathJax is loaded and ready!");
                    MathJax.startup.defaultReady();
                }
            }
        };
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" onerror="console.error('Failed to load MathJax')"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;700&family=Roboto:wght@400;700&family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
    <style>
        *, *:before, *:after {
            box-sizing: border-box;
        }
        body {
            margin: 0;
            background: linear-gradient(135deg, #1a2e2a, #0a3d2e);
            font-family: 'Roboto', sans-serif;
            color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: start;
            min-height: 100vh;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        body.loaded {
            visibility: visible;
            opacity: 1;
        }
        .title-box {
            margin-top: 60px;
            padding: 20px 40px;
            background: linear-gradient(135deg, #4a7043, #8b9a46);
            border-radius: 15px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
            max-width: 90%;
            text-align: center;
        }
        .title-box h1 {
            margin: 0;
            font-size: 24px;
            color: #ffffff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            font-family: 'Merriweather', serif;
        }
        .section-container {
            margin-top: 80px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        .section {
            width: 260px;
            height: 200px;
            background: linear-gradient(45deg, #2e3b2e, #4a5b4a);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 15px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            color: #ffffff;
            text-decoration: none;
        }
        .section:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0,0,0,0.25);
            background: linear-gradient(45deg, #2e3b2e, #6b8e23);
        }
        .section img {
            width: 40px;
            height: 40px;
            margin-bottom: 15px;
            object-fit: cover;
            border-radius: 8px;
            filter: drop-shadow(0 0 5px rgba(139, 154, 70, 0.3));
        }
        .section h2 {
            font-size: 20px;
            margin: 0;
            font-family: 'Merriweather', serif;
            color: #ffffff;
        }
        .modal {
            display: none;
            position: fixed;
            top: 5%;
            left: 5%;
            width: 90%;
            height: 90%;
            background: linear-gradient(135deg, #4a7043, #2e3b2e);
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            z-index: 1001;
            overflow: hidden;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
        }
        #modalOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
        }
        .modal-content {
            padding: 20px;
            flex-grow: 1;
            background: #2e3b2e;
            border-radius: 10px;
            margin: 10px;
            color: #ffffff;
            width: calc(100% - 20px);
            overflow-y: auto;
            display: block;
            max-height: calc(100% - 60px);
        }
        .modal-content::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        .modal-content::-webkit-scrollbar-track {
            background: #2e3b2e;
            border-radius: 10px;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.3);
        }
        .modal-content::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #4a7043, #8b9a46);
            border-radius: 10px;
            border: 2px solid #2e3b2e;
        }
        .modal-content::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, #6b8e23, #9ab973);
        }
        .modal-header {
            background: linear-gradient(0deg, #4a7043, #2e3b2e);
            padding: 8px 12px;
            display: flex;
            justify-content: flex-end;
            width: 100%;
            flex-shrink: 0;
            position: sticky;
            top: 0;
            z-index: 1002;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
        }
        .close-btn {
            background: #8b9a46;
            color: #ffffff;
            border: none;
            border-radius: 6px;
            padding: 6px 16px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s ease;
            font-family: 'Roboto', sans-serif;
            z-index: 1003;
        }
        .close-btn:hover {
            background: #6b8e23;
        }
        details {
            margin: 10px 0;
            padding: 10px;
            border-radius: 6px;
            background: #2e3b2e;
            cursor: pointer;
        }
        summary {
            font-weight: bold;
            padding: 10px;
            background: #4a7043;
            border-radius: 6px;
            color: #ffffff;
            font-family: 'Merriweather', serif;
        }
        summary:hover {
            background: #6b8e23;
        }
        details p {
            padding: 0 15px 10px;
            color: #ffffff;
            margin: 8px 0;
        }
        .math-notation {
            font-style: italic;
            color: #ffd700;
            background: #2e3b2e;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .highlight-term {
            background: #e0f7fa;
            padding: 2px 4px;
            border-radius: 3px;
            color: #0ea5e9;
        }
        .formula-line {
            display: inline-block;
            white-space: nowrap;
        }
        .theory-content h2 {
            color: #ffd700;
            text-align: center;
        }
        .theory-content h3 {
            color: #ffffff;
        }
        .theory-content p, .theory-content li {
            color: #ffffff;
            font-size: clamp(18px, 3vw, 20px);
            text-align: justify;
        }
        .example {
            color: #ff8c00;
            font-weight: bold;
        }
        .solution {
            color: #ff8c00;
            font-weight: bold;
            text-align: center;
            display: block;
        }
        .note {
            color: #ff8c00;
            font-weight: bold;
        }
        .note-text {
            font-style: italic;
            color: #ffffff;
            text-align: justify;
            width: 100%;
        }
        .matrix-type {
            font-style: italic;
            color: #ffd700;
        }
        .main-types {
            font-weight: bold;
            color: #ffffff;
        }
        ol {
            color: #ffffff;
        }
        ol li::marker {
            color: #ffd700;
        }
        mjx-container {
            color: #ffd700 !important;
           
            font-style: italic !important;
            display: inline-block;
            white-space: nowrap;
            max-width: 100%;
        }
        .theory-content mjx-container {
            color: #ffd700 !important;
            background: #2e3b2e !important;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .glow-title {
            text-align: center;
            color: #ffffff;
            font-family: 'Merriweather', serif;
            font-size: clamp(20px, 3vw, 24px);
            margin: 10px 0;
            text-shadow: 0 0 5px rgba(139, 154, 70, 0.5);
        }
        .navigation-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 40px 0;
        }
        .nav-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            background: linear-gradient(45deg, #4a7043, #8b9a46);
            color: #ffffff;
            text-decoration: none;
            border-radius: 10px;
            font-family: 'Merriweather', serif;
            font-size: 18px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
        }
        .nav-button:hover {
            background: linear-gradient(45deg, #6b8e23, #9ab973);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.3);
        }
        .nav-button svg {
            fill: none;
            stroke: #ffffff;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        .nav-button:hover svg {
            stroke: #ffd700;
        }
        /* –°—Ç–∏–ª—å–Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –¥–ª—è —Ñ–æ—Ä–º—É–ª */
        .math-notation-centered {
            display: block;
            text-align: center;
            margin: 1em 0;
            color: white;
            padding: 0 10px;
            overflow-y: hidden;
        }
        .math-notation-centered mjx-container {
            max-width: 100%;
            display: inline-block;
            vertical-align: middle;
        }
        /* –ö–ª–∞—Å –¥–ª—è —Å–ª–æ–≤–∞ "–ü—Ä–∏–∫–ª–∞–¥" */
        .example-title {
            color: orange;
            font-weight: bold;
        }
        /* –ë—ñ–ª–∏–π —Ç–µ–∫—Å—Ç –¥–ª—è –ø–æ—è—Å–Ω–µ–Ω—å */
        .text-white {
            color: white;
        }
        /* –°—Ç–∏–ª—ñ –¥–ª—è –≤—ñ–¥–µ–æ */
         .video-card-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 20px;
            padding: 20px;
        }
        .video-card {
            width: 400px;
            height: 400px;
            background:#314765;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 10px;
            cursor: pointer;
            color: #ffff00;
        }
        .video-card:hover {
            background: #556b2f;
        }
        .video-card img {
            width: 40px;
            height: 40px;
            margin-bottom: 8px;
            object-fit: cover;
            border-radius: 6px;
        }
        .video-player-container {
            width: 80vw;
            max-width: 960px;
            aspect-ratio: 16 / 9;
            margin: 20px auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .video-player-container iframe {
            width: 100%;
            height: 100%;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            display: block;
            border: none;
        }
        .video-card h3 {
            font-size: clamp(16px, 2.5vw, 18px);
            font-weight: 600;
            color: var(--text-color);
        }
        /* –°—Ç–∏–ª—ñ –¥–ª—è —Ñ–ª–µ—à-–∫–∞—Ä—Ç–æ–∫ */
        .flashcard-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            padding: 20px;
        }
        .flashcard {
            width: 350px;
            height: 250px;
            perspective: 1000px;
            cursor: pointer;
            position: relative;
            transition: transform 0.6s ease;
        }
        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }
        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .flashcard .front,
        .flashcard .back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            border-radius: 12px;
            font-family: 'Roboto', sans-serif;
            font-size: clamp(16px, 2.5vw, 18px);
            color: #ffffff;
        }
        .flashcard .front {
            background: linear-gradient(45deg, #4a7043, #8b9a46);
        }
        .flashcard .back {
            background: linear-gradient(45deg, #2e3b2e, #4a5b4a);
            transform: rotateY(180deg);
        }
        .flashcard .front p,
        .flashcard .back p {
            margin: 0;
            text-align: center;
        }
        .flashcard .front mjx-container,
        .flashcard .back mjx-container {
            color: #ffd700 !important;
            background: transparent !important;
            font-size: clamp(16px, 2.5vw, 18px) !important;
        }
.trainer-container {
    width: 95%;
    max-width: 95%;
    padding: 25px;
    text-align: center;
    background: linear-gradient(135deg, #2e1065, #6b21a8);
    border-radius: 20px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6);
    border: 2px solid rgba(236, 72, 153, 0.5);
    position: relative;
    min-height: 600px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    overflow-y: visible; /* –ó–∞–ª–∏—à–∞—î–º–æ visible */
    box-sizing: border-box;
}

.trainer-feedback {
    display: none;
    padding: 15px 25px;
    border-radius: 10px;
    font-size: clamp(16px, 2.5vw, 18px);
    font-weight: bold;
    text-align: center;
    max-width: 400px;
    width: 90%;
    margin: 20px auto;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
    transition: all 0.3s ease;
    position: absolute; /* –ó–º—ñ–Ω–µ–Ω–æ –Ω–∞ absolute */
    top: 50%; /* –¶–µ–Ω—Ç—Ä—É—î–º–æ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—ñ */
    left: 50%; /* –¶–µ–Ω—Ç—Ä—É—î–º–æ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—ñ */
    transform: translate(-50%, -50%); /* –¢–æ—á–Ω–µ —Ü–µ–Ω—Ç—Ä—É–≤–∞–Ω–Ω—è */
    z-index: 20; /* –í–∏—â–µ –∑–∞ —ñ–Ω—à—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ */
}

.trainer-feedback.show {
    display: block;
    opacity: 1;
}
.trainer-container::-webkit-scrollbar {
    width: 12px;
}

.trainer-container::-webkit-scrollbar-track {
    background: rgba(167, 139, 250, 0.2);
    border-radius: 10px;
    margin: 5px;
}

.trainer-container::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, #d81b60, #f06292);
    border-radius: 10px;
    border: 2px solid rgba(167, 139, 250, 0.3);
}

.trainer-container::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(135deg, #f06292, #d81b60);
}

.trainer-container {
    scrollbar-width: thin;
    scrollbar-color: #f06292 rgba(167, 139, 250, 0.2);
}

.trainer-question {
    font-size: clamp(18px, 3vw, 20px);
    color: #f0e7ff;
    margin-bottom: 25px;
}

.system-equations {
    text-align: center;
    margin-bottom: 20px;
}

.trainer-options {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: repeat(2, auto);
    gap: 15px;
    max-width: 750px;
    margin: 25px auto;
    justify-items: center;
    align-items: stretch;
}

.option-btn {
    padding: 10px 20px;
    background: #4b5320;
    color: #ffffff;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.3s ease, transform 0.3s ease, border-color 0.3s ease;
    width: 100%;
    text-align: center;
    font-family: 'Roboto', sans-serif;
}

.option-btn:hover {
    background: #556b2f;
    transform: translateY(-2px);
}

.option-btn.selected {
    background: #560319;
    border: 2px solid #facc15;
    font-weight: bold;
}

.option-btn.wrong {
    background: linear-gradient(135deg, #7f1d1d, #991b1b);
    color: #ffffff;
    border: 2px solid rgba(167, 139, 250, 0.5);
}

.option-btn.correct {
    background: linear-gradient(135deg, #22c55e, #86efac);
    color: #1e1e5f;
    border: 2px solid #22c55e;
}

.trainer-submit {
    background: #50622c;
    color: #1e1e5f;
    border: none;
    border-radius: 10px;
    padding: 12px 25px;
    font-size: clamp(18px, 2.8vw, 20px);
    cursor: pointer;
    margin-top: 25px;
    transition: background 0.3s ease, transform 0.2s ease;
}

.trainer-submit:hover {
    background: linear-gradient(135deg, #86efac, #4ade80);
    transform: scale(1.05);
}




.trainer-feedback.correct {
    background: linear-gradient(135deg, #22c55e, #86efac);
    color: #1e1e5f;
}

.trainer-feedback.correct::before {
    content: '‚úì ';
    font-size: 24px;
    vertical-align: middle;
}

.trainer-feedback.wrong {
    background: linear-gradient(135deg, #b91c1c, #dc2626);
    color: #ffffff;
}

.trainer-feedback.wrong::before {
    content: '‚úó ';
    font-size: 24px;
    vertical-align: middle;
}

#resetTrainerBtn {
    padding: 12px 24px;
    background: linear-gradient(45deg, #4a7043, #8b9a46);
    color: #ffff00;
    border: none;
    border-radius: 10px;
    font-size: clamp(16px, 2.5vw, 18px);
    cursor: pointer;
    font-family: 'Roboto', sans-serif;
    transition: background 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

#resetTrainerBtn:hover {
    background: linear-gradient(45deg, #6b8e23, #9ab973);
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
}

#resetTrainerBtn:focus {
    outline: 2px solid #facc15;
    outline-offset: 2px;
}

.question-circle {
    width: clamp(100px, 16vw, 130px);
    height: clamp(100px, 16vw, 130px);
    min-width: clamp(100px, 16vw, 130px);
    min-height: clamp(100px, 16vw, 130px);
    max-width: clamp(100px, 16vw, 130px);
    max-height: clamp(100px, 16vw, 130px);
    aspect-ratio: 1/1;
    background: linear-gradient(135deg, #d81b60, #f06292);
    border-radius: 50%;
    color: #ffffff;
    font-family: 'Lora', serif;
    font-weight: 700;
    margin: 0 auto 25px;
    border: 3px dashed #a78bfa;
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
    padding: 0;
    box-sizing: border-box;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: clamp(1.0rem, 2.5vw, 1.1rem);
    text-align: center;
    white-space: nowrap;
    line-height: 1.2;
    overflow: hidden;
}

.question-circle span {
    font-size: inherit;
    font-family: inherit;
    font-weight: inherit;
    color: inherit;
    margin: 0;
    padding: 0;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    box-sizing: border-box;
}

.question-circle mjx-container,
.question-circle .MathJax {
    display: none !important;
}
    .completion-message {
    text-align: center;
    margin: 20px auto;
    max-width: 400px;
    width: 90%;
    position: relative; /* –î–æ–¥–∞—î–º–æ –ø–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è */
    z-index: 10; /* –ù–∏–∂—á–µ, –Ω—ñ–∂ trainer-feedback, –∞–ª–µ –≤–∏—â–µ —ñ–Ω—à–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ */
}

#successMessage {
    background: linear-gradient(135deg, #22c55e, #86efac);
    color: #1e1e5f;
    padding: 15px 25px;
    border-radius: 10px;
    font-size: clamp(16px, 2.5vw, 18px);
    font-weight: bold;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
    margin-bottom: 20px;
}

#successMessage::before {
    content: '‚úì ';
    font-size: 24px;
    vertical-align: middle;
}
.completion-emoji {
            width: clamp(100px, 18vw, 140px);
            height: clamp(100px, 18vw, 140px);
            margin: 0 auto 20px;
            border-radius: 50%;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
            border: 3px dashed #ccff00;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .completion-emoji::after {
            content: 'üéâ';
            font-size: clamp(50px, 10vw, 70px);
            color: #ffff00;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
        }

    @media (max-width: 768px) {
            .close-btn {
                font-size: 16px;
                padding: 6px 12px;
                border-radius: 8px;
            }
            .theory-content p, .theory-content li {
                font-size: clamp(18px, 3vw, 20px);
            }
            .theory-content mjx-container {
                font-size: clamp(16px, 3vw, 18px) !important;
            }
            .theory-content h2, .theory-content h3 {
                font-size: clamp(20px, 3vw, 24px);
            }
            .title-box {
                margin-top: 40px;
                padding: 15px 20px;
            }
            .title-box h1 {
                font-size: 24px;
            }
            .trainer-options {
        grid-template-columns: 1fr !important; /* –û–¥–∏–Ω —Å—Ç–æ–≤–ø—á–∏–∫ */
        grid-template-rows: auto; /* –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤ */
        gap: 10px;
        max-width: 90%;
    }
            .section-container {
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }
            .section {
                width: 80%;
                height: 180px;
            }
            .modal {
                top: 2%;
                left: 2%;
                width: 96%;
                height: 96%;
            }
            .modal-header {
                padding: 5px 8px;
            }
            .modal-content {
                max-height: calc(100% - 50px);
                padding: 15px;
            }
            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
                margin: 30px 0;
            }
            .nav-button {
                padding: 10px 20px;
                font-size: 16px;
            }
            .math-notation-centered {
                overflow-x: auto;
                overflow-y: hidden;
                white-space: nowrap;
                padding: 0 5px;
                -webkit-overflow-scrolling: touch;
            }
            .math-notation-centered::-webkit-scrollbar {
                height: 8px;
                display: block;
            }
            .math-notation-centered::-webkit-scrollbar-track {
                background: #2e3b2e;
                border-radius: 8px;
                box-shadow: inset 0 0 4px rgba(0,0,0,0.3);
            }
            .math-notation-centered::-webkit-scrollbar-thumb {
                background: linear-gradient(90deg, #4a7043, #8b9a46);
                border-radius: 8px;
                border: 1px solid #2e3b2e;
                box-shadow: 0 0 4px rgba(139, 154, 70, 0.5);
                transition: background 0.3s ease;
            }
            .math-notation-centered::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(90deg, #6b8e23, #9ab973);
            }
            .video-card {
            width: 300px;
            height: 300px;
            
        }
             
        .video-player-container {
            width: 80vw;
            max-width: 800px;
            aspect-ratio: 16 / 9;
            margin: 20px auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .video-player-container iframe {
            width: 90%;
            height: 90%;
            
        }
            .flashcard {
                width: 80%;
                height: 150px;
            }
            .flashcard .front,
            .flashcard .back {
                font-size: clamp(15px, 2.8vw, 17px);
            }
            .flashcard .front mjx-container,
            .flashcard .back mjx-container {
                font-size: clamp(15px, 2.8vw, 17px) !important;
            }
               .trainer-question {
        font-size: clamp(16px, 2.8vw, 18px);
    }
    .option-btn {
        font-size: 14px;
        padding: 8px 15px;
    }
    .trainer-submit {
        font-size: 14px;
        padding: 8px 15px;
    }
    .question-circle {
        width: 60px;
        height: 60px;
        font-size: 16px;
    }
            
        }
        @media (max-width: 480px) {
            .close-btn {
                font-size: 14px;
                padding: 5px 10px;
                border-radius: 6px;
            }
            .theory-content p, .theory-content li {
                font-size: clamp(17px, 3.2vw, 19px);
            }
            .theory-content mjx-container {
                font-size: clamp(16px, 3.2vw, 18px) !important;
            }
            .theory-content h2, .theory-content h3 {
                font-size: clamp(17px, 3vw, 19px);
            }
            .title-box {
                margin-top: 20px;
                padding: 10px 15px;
            }
            .title-box h1 {
                font-size: 20px;
            }
            .section {
                width: 90%;
                height: 150px;
            }
            .section img {
                width: 50px;
                height: 50px;
            }
            .section h2 {
                font-size: 18px;
            }
            .modal-header {
                padding: 4px 6px;
            }
            .modal-content {
                max-height: calc(100% - 40px);
                padding: 10px;
            }
           .navigation-buttons {
        flex-direction: row; /* –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–µ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è */
        gap: 10px;
        margin: 20px 0;
        justify-content: center;
        flex-wrap: nowrap;
    }
    .nav-button {
        padding: 6px 14px; /* "–ì—Ä—É–±—à—ñ" –∫–Ω–æ–ø–∫–∏ */
        font-size: 15px; /* –ë—ñ–ª—å—à–∏–π —à—Ä–∏—Ñ—Ç */
        font-weight: 600; /* –¢–æ–≤—Å—Ç—ñ—à–∏–π —à—Ä–∏—Ñ—Ç */
        width: auto;
        min-width: 100px;
        text-align: center;
        border: 2px solid #ffffff; /* –ú–µ–∂–∞ –¥–ª—è –æ–±‚Äô—î–º—É */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* –¢—ñ–Ω—å */
    }
    .trainer-submit {
    padding: 8px 20px !important;
    font-size: 15px !important;
    min-width: 120px !important;
    font-weight: 700 !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3) !important;
}
            .math-notation-centered {
                padding: 0 5px;
            }
            .math-notation-centered::-webkit-scrollbar {
                height: 6px;
            }
            .video-card {
            width: 200px;
            height: 200px;
            
        }
             
        .video-player-container {
            width: 80vw;
            max-width: 600px;
            aspect-ratio: 16 / 9;
            margin: 20px auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }
                    
            .flashcard {
                width: 90%;
                height: 140px;
            }
            .flashcard .front,
            .flashcard .back {
                font-size: clamp(14px, 2.5vw, 16px);
            }
            .flashcard .front mjx-container,
            .flashcard .back mjx-container {
                font-size: clamp(14px, 2.5vw, 16px) !important;
            }
            .math-notation-centered {
                padding: 0 5px;
            }
             .trainer-question {
        font-size: clamp(14px, 2.5vw, 16px);
    }
    .option-btn {
        font-size: 13px;
        padding: 6px 12px;
    }
    .trainer-submit {
        font-size: 13px;
        padding: 6px 12px;
    }
    .question-circle {
        width: 50px;
        height: 50px;
        font-size: 14px;
    }
                   }
    </style>
</head>
<body>
    <div class="title-box">
        <h1>26. –ö—Ä–∏—Ç–µ—Ä—ñ–π —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ —Å–∏—Å—Ç–µ–º–∏ –ª—ñ–Ω—ñ–π–Ω–∏—Ö –∞–ª–≥–µ–±—Ä–∞—ó—á–Ω–∏—Ö —Ä—ñ–≤–Ω—è–Ω—å</h1>
    </div>

    <div class="section-container">
        <div class="section" id="openTheoryBtn">
            <img src="https://img.icons8.com/fluency/96/book-shelf.png" alt="–ö–Ω–∏–≥–∞">
            <h2>–¢–µ–æ—Ä–µ—Ç–∏—á–Ω—ñ –≤—ñ–¥–æ–º–æ—Å—Ç—ñ</h2>
        </div>
        <div class="section" id="openVideoBtn">
            <img src="https://img.icons8.com/fluency/96/video.png" alt="–í—ñ–¥–µ–æ">
            <h2>–í—ñ–¥–µ–æ–º–∞—Ç–µ—Ä—ñ–∞–ª–∏</h2>
        </div>
        <div class="section" id="openQuestionsBtn">
            <img src="https://img.icons8.com/fluency/96/flipboard.png" alt="–ö–∞—Ä—Ç–∫–∏">
            <h2>–ü–∏—Ç–∞–Ω–Ω—è —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ</h2>
        </div>
        <div class="section" id="openTrainerBtn">
            <img src="https://img.icons8.com/fluency/96/flash-on.png" alt="–¢—Ä–µ–Ω–∞–∂–µ—Ä">
            <h2>–¢—Ä–µ–Ω–∞–∂–µ—Ä</h2>
        </div>
    </div>

    <div class="navigation-buttons">
        <a class="nav-button" href="{{ url_for('tema6') }}">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
                <path d="M15 18l-6-6 6-6"/>
            </svg>
            –î–æ —Ç–µ–º–∏ 6
        </a>
        <a class="nav-button" href="{{ url_for('home') }}">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
                <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
            </svg>
            –ù–∞ –≥–æ–ª–æ–≤–Ω—É
        </a>
    </div>

    <div id="theoryModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="theoryTitle">
        <div class="modal-header">
            <button class="close-btn" id="closeTheoryBtn" aria-label="–ó–∞–∫—Ä–∏—Ç–∏">√ó –ó–∞–∫—Ä–∏—Ç–∏</button>
        </div>
        <div class="modal-content">
            <div class="theory-content">
                <details>
                    <summary>–ö—Ä–∏—Ç–µ—Ä—ñ–π —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ —Å–∏—Å—Ç–µ–º–∏ –ª—ñ–Ω—ñ–π–Ω–∏—Ö –∞–ª–≥–µ–±—Ä–∞—ó—á–Ω–∏—Ö —Ä—ñ–≤–Ω—è–Ω—å</summary>
                    <p>–ü–µ—Ä–µ–¥ —Ä–æ–∑–≤‚Äô—è–∑—É–≤–∞–Ω–Ω—è–º —Å–∏—Å—Ç–µ–º–∏ –ª—ñ–Ω—ñ–π–Ω–∏—Ö —Ä—ñ–≤–Ω—è–Ω—å, –æ—Å–æ–±–ª–∏–≤–æ —è–∫—â–æ –≤–æ–Ω–∞ –º—ñ—Å—Ç–∏—Ç—å –±–∞–≥–∞—Ç–æ —Ä—ñ–≤–Ω—è–Ω—å –∞–±–æ –∑–º—ñ–Ω–Ω–∏—Ö, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —ó—ó —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å, —Ç–æ–±—Ç–æ –∑‚Äô—è—Å—É–≤–∞—Ç–∏, —á–∏ –º–∞—î –≤–æ–Ω–∞ —Ä–æ–∑–≤‚Äô—è–∑–∫–∏. –î–ª—è —Ü—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ–π, —è–∫–∏–π –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ —Ä–∞–Ω–≥–∞—Ö –º–∞—Ç—Ä–∏—Ü—å, –≤—ñ–¥–æ–º–∏–π —è–∫ —Ç–µ–æ—Ä–µ–º–∞ –ö—Ä–æ–Ω–µ–∫–µ—Ä–∞-–ö–∞–ø–µ–ª–ª—ñ.</p>
                    <p><strong style="color: orange;">–§–æ—Ä–º—É–ª—é–≤–∞–Ω–Ω—è –∫—Ä–∏—Ç–µ—Ä—ñ—é.</strong> –°–∏—Å—Ç–µ–º–∞ –ª—ñ–Ω—ñ–π–Ω–∏—Ö —Ä—ñ–≤–Ω—è–Ω—å —Å—É–º—ñ—Å–Ω–∞, —è–∫—â–æ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —É–º–æ–≤–∞:</p>
                    <p class="math-notation-centered">\[ r(A) = r(A|B), \]</p>
                    <p>–¥–µ \( A \) ‚Äì –º–∞—Ç—Ä–∏—Ü—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤ —Å–∏—Å—Ç–µ–º–∏, \( A|B \) ‚Äì —Ä–æ–∑—à–∏—Ä–µ–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è (–º–∞—Ç—Ä–∏—Ü—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤, –¥–æ–ø–æ–≤–Ω–µ–Ω–∞ —Å—Ç–æ–≤–ø—Ü–µ–º –≤—ñ–ª—å–Ω–∏—Ö —á–ª–µ–Ω—ñ–≤).</p>
                    <p>–Ø–∫—â–æ —Ü—è —Ä—ñ–≤–Ω—ñ—Å—Ç—å –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —ñ —Ä–∞–Ω–≥ –º–∞—Ç—Ä–∏—Ü—ñ –¥–æ—Ä—ñ–≤–Ω—é—î –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–º—ñ–Ω–Ω–∏—Ö, —Ç–æ —Å–∏—Å—Ç–µ–º–∞ –º–∞—î —î–¥–∏–Ω–∏–π —Ä–æ–∑–≤‚Äô—è–∑–æ–∫. –Ø–∫—â–æ –∂ —Ä–∞–Ω–≥ –º–µ–Ω—à–∏–π –∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–º—ñ–Ω–Ω–∏—Ö, —Å–∏—Å—Ç–µ–º–∞ –º–∞—î –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤. –Ø–∫—â–æ –∂ \( r(A) \neq r(A|B) \), —Å–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞, —Ç–æ–±—Ç–æ –Ω–µ–º–∞—î —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤.</p>
                    <p><strong style="color: orange;">–ê–Ω–∞–ª—ñ–∑ —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ —Å–∏—Å—Ç–µ–º–∏.</strong> –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ —Å–∏—Å—Ç–µ–º–∏ –ª—ñ–Ω—ñ–π–Ω–∏—Ö —Ä—ñ–≤–Ω—è–Ω—å —î –≤–∞–∂–ª–∏–≤–∏–º –ø–æ—á–∞—Ç–∫–æ–≤–∏–º –µ—Ç–∞–ø–æ–º —Ä–æ–∑–≤‚Äô—è–∑–∞–Ω–Ω—è. –î–ª—è —Ü—å–æ–≥–æ –≤–∏–∫–æ–Ω—É—é—Ç—å —Ç–∞–∫—ñ –∫—Ä–æ–∫–∏:</p>
                    <ol>
                        <li><em style="color: #f5e1c0;">–ü–æ–±—É–¥–æ–≤–∞ –º–∞—Ç—Ä–∏—Ü—å.</em> –°–∫–ª–∞–¥–∞—é—Ç—å –≥–æ–ª–æ–≤–Ω—É –º–∞—Ç—Ä–∏—Ü—é \( A \), —è–∫–∞ –º—ñ—Å—Ç–∏—Ç—å –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ –ø—Ä–∏ –∑–º—ñ–Ω–Ω–∏—Ö, —Ç–∞ —Ñ–æ—Ä–º—É—é—Ç—å —Ä–æ–∑—à–∏—Ä–µ–Ω—É –º–∞—Ç—Ä–∏—Ü—é \( (A|B) \), –¥–æ–¥–∞–≤—à–∏ –¥–æ \( A \) —Å—Ç–æ–≤–ø–µ—Ü—å –≤—ñ–ª—å–Ω–∏—Ö —á–ª–µ–Ω—ñ–≤ \( b \).</li>
                        <li><em style="color: #f5e1c0;">–û–±—á–∏—Å–ª–µ–Ω–Ω—è —Ä–∞–Ω–≥—ñ–≤.</em> –í–∏–∑–Ω–∞—á–∞—é—Ç—å \( r(A) \) —ñ \( r(A|B) \), –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –º–µ—Ç–æ–¥–æ–º –ì–∞—É—Å–∞ –∞–±–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º—ñ–Ω–æ—Ä—ñ–≤.</li>
                        <li><em style="color: #f5e1c0;">–í–∏—Å–Ω–æ–≤–∫–∏ –∑–∞ —Ç–µ–æ—Ä–µ–º–æ—é –ö—Ä–æ–Ω–µ–∫–µ—Ä–∞-–ö–∞–ø–µ–ª–ª—ñ.</em> –Ø–∫—â–æ \( r(A) = r(A|B) \), —Ç–æ —Å–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ (–º–∞—î —Ö–æ—á–∞ –± –æ–¥–∏–Ω —Ä–æ–∑–≤‚Äô—è–∑–æ–∫). –Ø–∫—â–æ \( r(A) \neq r(A|B) \), —Ç–æ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞ (–Ω–µ –º–∞—î —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤).</li>
                    </ol>
                </details>

                <details>
                    <summary>–ü—Ä–∏–∫–ª–∞–¥–∏</summary>
                    <!-- –ü—Ä–∏–∫–ª–∞–¥ 6.8 -->
                    <h3><span class="example-title">–ü—Ä–∏–∫–ª–∞–¥ 6.8.</span> <span class="text-white">–î–æ—Å–ª—ñ–¥–∏—Ç–∏ —Å–∏—Å—Ç–µ–º—É –Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å —Ç–∞ –∑–Ω–∞–π—Ç–∏ —ó—ó —Ä–æ–∑–≤‚Äô—è–∑–æ–∫, —è–∫—â–æ —Å–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞:</span></h3>
                    <p style="color: orange; font-weight: bold; text-align: center; font-size: 1.2em; margin: 1em 0;">–†–æ–∑–≤‚Äô—è–∑–∞–Ω–Ω—è</p>
                    <p style="color: white; margin: 1em 0;">
                        –¶—é —Å–∏—Å—Ç–µ–º—É –≤–∂–µ —Ä–æ–∑–≤‚Äô—è–∑—É–≤–∞–ª–∏ –º–µ—Ç–æ–¥–æ–º –ì–∞—É—Å–∞ —É –ø—Ä–∏–∫–ª–∞–¥—ñ 6.4 (–¥–∏–≤. –ø. 25). –¢–µ–ø–µ—Ä –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ —ó—ó –Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å –∑–∞ —Ç–µ–æ—Ä–µ–º–æ—é –ö—Ä–æ–Ω–µ–∫–µ—Ä–∞-–ö–∞–ø–µ–ª–ª—ñ —Ç–∞ –∑–Ω–∞–π–¥–µ–º–æ —Ä–æ–∑–≤‚Äô—è–∑–æ–∫.<br>
                        –ó–∞—Å—Ç–æ—Å—É—î–º–æ –µ–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–æ—ó –º–∞—Ç—Ä–∏—Ü—ñ, —â–æ–± –æ–±—á–∏—Å–ª–∏—Ç–∏ —ó—ó —Ä–∞–Ω–≥. –¶—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–µ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ —Ä–∞–Ω–≥ –º–∞—Ç—Ä–∏—Ü—å.
                    </p>
                    <p class="math-notation-centered">
                        \[
                        \left(
                        \begin{array}{ccc|c}
                        3 & 2 & -5 & -1 \\
                        2 & -1 & 3 & 13 \\
                        1 & 2 & -1 & 9
                        \end{array}
                        \right)
                        \sim
                        \left(
                        \begin{array}{ccc|c}
                        1 & 2 & -1 & 9 \\
                        2 & -1 & 3 & 13 \\
                        3 & 2 & -5 & -1
                        \end{array}
                        \right)
                        \sim
                        \left(
                        \begin{array}{ccc|c}
                        1 & 2 & -1 & 9 \\
                        0 & -5 & 5 & -5 \\
                        0 & -4 & -2 & -28
                        \end{array}
                        \right)
                        \]
                    </p>
                    <p class="math-notation-centered">
                        \[
                        \sim
                        \left(
                        \begin{array}{ccc|c}
                        1 & 2 & -1 & 9 \\
                        0 & 1 & -1 & 1 \\
                        0 & 2 & 1 & 14
                        \end{array}
                        \right)
                        \sim
                        \left(
                        \begin{array}{ccc|c}
                        1 & 2 & -1 & 9 \\
                        0 & 1 & -1 & 1 \\
                        0 & 0 & 3 & 12
                        \end{array}
                        \right)
                        \sim
                        \left(
                        \begin{array}{ccc|c}
                        1 & 2 & -1 & 9 \\
                        0 & 1 & -1 & 1 \\
                        0 & 0 & 1 & 4
                        \end{array}
                        \right)
                        .\]
                    </p>
                    <p style="color: white; margin: 1em 0;">
                        –£ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –≤–∏–∫–æ–Ω–∞–Ω–∏—Ö –¥—ñ–π –æ—Ç—Ä–∏–º–∞–ª–∏ <em>–µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω—ñ –º–∞—Ç—Ä–∏—Ü—ñ </em>–¥–ª—è –∑–∞–¥–∞–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏:
                        \[
                        A = \begin{pmatrix}1 & 2 & -1\\0 & 1 & -1\\0 & 0 & 1\end{pmatrix},\quad
                        (A|b) = 
                        \left(
                        \begin{array}{ccc|c}
                        1 & 2 & -1 & 9 \\
                        0 & 1 & -1 & 1 \\
                        0 & 0 & 1 & 4
                        \end{array}
                        \right)
                        \]
                        –û–±–∏–¥–≤—ñ –º–∞—Ç—Ä–∏—Ü—ñ –º–∞—é—Ç—å <em>—Å—Ö—ñ–¥—á–∞—Å—Ç–∏–π –≤–∏–≥–ª—è–¥ </em>, –ø—Ä–∏—á–æ–º—É –≤ –∫–æ–∂–Ω—ñ–π –º–∞—Ç—Ä–∏—Ü—ñ —Ç—Ä–∏ –Ω–µ–Ω—É–ª—å–æ–≤—ñ —Ä—è–¥–∫–∏. –û—Ç–∂–µ, —ó—Ö–Ω—ñ–π —Ä–∞–Ω–≥ –¥–æ—Ä—ñ–≤–Ω—é—î \(3\).
                        –û—Å–∫—ñ–ª—å–∫–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–º—ñ–Ω–Ω–∏—Ö —Ç–∞–∫–æ–∂ \(3\), —Ç–æ –∑–∞ —Ç–µ–æ—Ä–µ–º–æ—é –ö—Ä–æ–Ω–µ–∫–µ—Ä–∞-–ö–∞–ø–µ–ª–ª—ñ —Å–∏—Å—Ç–µ–º–∞ —î <em>—Å—É–º—ñ—Å–Ω–æ—é</em> —Ç–∞ –º–∞—î <em>—î–¥–∏–Ω–∏–π —Ä–æ–∑–≤‚Äô—è–∑–æ–∫.</em>
                    </p>
                    <p><em>–ó–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è —Ä–æ–∑–≤‚Äô—è–∑–∫—É.</em> –ó –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ —Ä—ñ–≤–Ω—è–Ω–Ω—è –≤–∏–¥–Ω–æ, —â–æ \(z=4\), –ø—ñ–¥—Å—Ç–∞–≤–ª—è—î–º–æ —É –¥—Ä—É–≥–µ —Ä—ñ–≤–Ω—è–Ω–Ω—è:</p>
                    <p class="math-notation-centered">\(y-z=1 \Rightarrow y-4=1 \Rightarrow y=5.\)</p>
                    <p>–ü—ñ–¥—Å—Ç–∞–≤–ª—è—î–º–æ \(y=5\) —Ç–∞ \(z=4\) —É –ø–µ—Ä—à–µ —Ä—ñ–≤–Ω—è–Ω–Ω—è:</p>
                    <p class="math-notation-centered">\(x+2y-z=9 \Rightarrow x+10-4=9 \Rightarrow x=3.\)</p>
                    <p>
                        <span class="example-title">–í—ñ–¥–ø–æ–≤—ñ–¥—å:</span> 
                        \((x,y,z) = (3,5,4).\)
                    </p>

                    <!-- –ü—Ä–∏–∫–ª–∞–¥ 6.9 -->
                    <h3><span class="example-title">–ü—Ä–∏–∫–ª–∞–¥ 6.9.</span> <span class="text-white">–î–æ—Å–ª—ñ–¥–∏—Ç–∏ —Å–∏—Å—Ç–µ–º—É –Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å —Ç–∞ –∑–Ω–∞–π—Ç–∏ —ó—ó —Ä–æ–∑–≤‚Äô—è–∑–æ–∫, —è–∫—â–æ —Å–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞:</span></h3>
                    <p class="math-notation-centered">
                        \[
                        \begin{cases}
                        4x_1 - 3x_2 + 2x_3 - x_4 = 8\\
                        3x_1 - 2x_2 + x_3 - 3x_4 = 7\\
                        5x_1 - 3x_2 + x_3 - 8x_4 = 1
                        \end{cases}
                        \]
                    </p>
                    <p style="color: orange; font-weight: bold; text-align: center; font-size: 1.2em; margin: 1em 0;">–†–æ–∑–≤‚Äô—è–∑–∞–Ω–Ω—è</p>
                    <p class="text-white">
                        –°–∏—Å—Ç–µ–º–∞ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ \(3\) —Ä—ñ–≤–Ω—è–Ω—å —ñ \(4\) –∑–º—ñ–Ω–Ω–∏—Ö \((m=3, n=4)\). –û—Å–∫—ñ–ª—å–∫–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–º—ñ–Ω–Ω–∏—Ö –ø–µ—Ä–µ–≤–∏—â—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—ñ–≤–Ω—è–Ω—å, —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ –±—É—Ç–∏ –∞–±–æ –Ω–µ—Å—É–º—ñ—Å–Ω–æ—é, –∞–±–æ –º–∞—Ç–∏ –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤. –í–∏–∑–Ω–∞—á–∏–º–æ —ó—ó —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å <em>–∑–∞ —Ç–µ–æ—Ä–µ–º–æ—é –ö—Ä–æ–Ω–µ–∫–µ—Ä–∞-–ö–∞–ø–µ–ª–ª—ñ.</em>
                    </p>
                    <p class="text-white">–ó–∞–ø–∏—à–µ–º–æ —Ä–æ–∑—à–∏—Ä–µ–Ω—É –º–∞—Ç—Ä–∏—Ü—é —Å–∏—Å—Ç–µ–º–∏:</p>
                    <p class="math-notation-centered">
                        \[
                        \left(\begin{array}{cccc|c}
                        4 & -3 & 2 & -1 & 8\\
                        3 & -2 & 1 & -3 & 7\\
                        5 & -3 & 1 & -8 & 1
                        \end{array}\right)
                        \]
                    </p>
                    <p class="text-white">
                        <em>–ü—Ä–∏–≤–µ–¥–µ–º–æ –º–∞—Ç—Ä–∏—Ü—é –¥–æ —Å—Ö—ñ–¥—á–∞—Å—Ç–æ–≥–æ –≤–∏–≥–ª—è–¥—É</em>. –£—Ç–≤–æ—Ä–∏–º–æ –Ω—É–ª—ñ —É –ø–µ—Ä—à–æ–º—É —Å—Ç–æ–≤–ø—Ü—ñ –ø—ñ–¥ –≥–æ–ª–æ–≤–Ω–∏–º –µ–ª–µ–º–µ–Ω—Ç–æ–º: –¥–æ –¥—Ä—É–≥–æ–≥–æ —Ä—è–¥–∫–∞ –¥–æ–¥–∞—î–º–æ –ø–µ—Ä—à–∏–π —Ä—è–¥–æ–∫, –ø–æ–º–Ω–æ–∂–µ–Ω–∏–π –Ω–∞ \(-3\), –∞ —Å–∞–º –¥—Ä—É–≥–∏–π —Ä—è–¥–æ–∫ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –º–Ω–æ–∂–∏–º–æ –Ω–∞ \(4\); –¥–æ —Ç—Ä–µ—Ç—å–æ–≥–æ —Ä—è–¥–∫–∞ –¥–æ–¥–∞—î–º–æ –ø–µ—Ä—à–∏–π —Ä—è–¥–æ–∫, –ø–æ–º–Ω–æ–∂–µ–Ω–∏–π –Ω–∞ \(-5\), –∞ —Å–∞–º —Ç—Ä–µ—Ç—ñ–π —Ä—è–¥–æ–∫ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –º–Ω–æ–∂–∏–º–æ –Ω–∞ \(4\):
                    </p>
                    <p class="math-notation-centered">
                        \[
                        \overset{
                        \substack{
                        R_2 = 4R_2 - 3R_1\\
                        R_3 = 4R_3 - 5R_1
                        }
                        }{\longrightarrow}
                        \left(
                        \begin{array}{cccc|c}
                        4 & -3 & 2 & -1 & 8\\
                        0 & 1 & -2 & -9 & 4\\
                        0 & 3 & -6 & -36 & -36
                        \end{array}
                        \right)
                        \]
                    </p>
                    <p class="text-white">–¢–µ–ø–µ—Ä –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ –Ω—É–ª—å —É —Ç—Ä–µ—Ç—å–æ–º—É —Ä—è–¥–∫—É –Ω–∞ –¥—Ä—É–≥—ñ–π –ø–æ–∑–∏—Ü—ñ—ó. –î–ª—è —Ü—å–æ–≥–æ –¥–æ —Ç—Ä–µ—Ç—å–æ–≥–æ —Ä—è–¥–∫–∞ –¥–æ–¥–∞—î–º–æ –¥—Ä—É–≥–∏–π —Ä—è–¥–æ–∫, –ø–æ–º–Ω–æ–∂–µ–Ω–∏–π –Ω–∞ \(-3\), —ñ –æ—Ç—Ä–∏–º–∞—î–º–æ:</p>
                    <p class="math-notation-centered">
                        \[
                        \overset{R_3 = R_3 - 3R_2}{\longrightarrow}
                        \left(\begin{array}{cccc|c}
                        4 & -3 & 2 & -1 & 8\\
                        0 & 1 & -2 & -9 & 4\\
                        0 & 0 & 0 & 0 & -48
                        \end{array}\right)
                        \]
                    </p>
                    <p class="text-white">
                        –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –µ–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–∏—Ö –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω—å –æ—Ç—Ä–∏–º–∞–ª–∏ –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω—É –º–∞—Ç—Ä–∏—Ü—é —Å–∏—Å—Ç–µ–º–∏
                    </p>
                    <p class="math-notation-centered">
                        \[
                        A = 
                        \left(
                        \begin{array}{cccc}
                        4 & -3 & 2 & -1\\
                        0 & 1 & -2 & -9\\
                        0 & 0 & 0 & 0
                        \end{array}
                        \right)
                        \sim
                        \left(
                        \begin{array}{cccc}
                        4 & -3 & 2 & -1\\
                        0 & 1 & -2 & -9
                        \end{array}
                        \right)
                        \]
                    </p>
                    <p class="text-white">—Ç–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω—É –º–∞—Ç—Ä–∏—Ü—é —Å–∏—Å—Ç–µ–º–∏</p>
                    <p class="math-notation-centered">
                        \[
                        (A \,|\, b) =
                        \left(
                        \begin{array}{cccc|c}
                        4 & -3 & 2 & -1 & 8 \\
                        0 & 1 & -2 & -9 & 4 \\
                        0 & 0 & 0 & 0 & -48
                        \end{array}
                        \right).
                        \]
                    </p>
                    <p class="text-white">
                        –¢–æ–º—É \(r(A) = 2\) (–¥–≤–∞ –Ω–µ–Ω—É–ª—å–æ–≤—ñ —Ä—è–¥–∫–∏), \(r(A|b) = 3\) (—Ç—Ä–∏ –Ω–µ–Ω—É–ª—å–æ–≤—ñ —Ä—è–¥–∫–∏). –û—Ç–∂–µ, –æ—Å–∫—ñ–ª—å–∫–∏ \(r(A) \neq r(A|B)\), —Ç–æ–¥—ñ –∑–∞ —Ç–µ–æ—Ä–µ–º–æ—é –ö—Ä–æ–Ω–µ–∫–µ—Ä–∞-–ö–∞–ø–µ–ª–ª—ñ —Å–∏—Å—Ç–µ–º–∞ <em>–Ω–µ—Å—É–º—ñ—Å–Ω–∞ (–Ω–µ–º–∞—î —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤).</em>
                    </p>
                    <p>
                        <span style="color: orange; font-weight: bold;">–ü—Ä–∏–º—ñ—Ç–∫–∞.</span>
                        <span style="font-style: italic;">
                            –Ø–∫–±–∏ —É–º–æ–≤–∞ –Ω–µ –≤–∏–º–∞–≥–∞–ª–∞ –∞–Ω–∞–ª—ñ–∑—É —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ, –º–æ–∂–Ω–∞ –±—É–ª–æ –± –æ–¥—Ä–∞–∑—É –≤–∫–∞–∑–∞—Ç–∏, —â–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è –ø—Ä–∏–≤–µ–¥–µ–Ω–∞ –¥–æ —Å—Ö—ñ–¥—á–∞—Å—Ç–æ–≥–æ –≤–∏–≥–ª—è–¥—É 
                            <p class="math-notation-centered">
                                \[
                                \left(\begin{array}{cccc|c}
                                4 & -3 & 2 & -1 & 8 \\
                                0 & 1 & -2 & -9 & 4 \\
                                0 & 0 & 0 & 0 & -48
                                \end{array}\right).
                                \]
                            </p>
                            <p class="text-white">
                                –û—Å–∫—ñ–ª—å–∫–∏ –∑‚Äô—è–≤–∏–≤—Å—è —Ä—è–¥–æ–∫ 
                                \[\left(\begin{array}{cccc|c}0 & 0 & 0 & 0 & -48\end{array}\right)\], 
                                —Å–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞ (–Ω–µ–º–∞—î —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤).
                            </p>
                        </span>
                    </p>
                    <p>
                        <span class="example-title">–í—ñ–¥–ø–æ–≤—ñ–¥—å:</span> –°–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞, —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤ –Ω–µ–º–∞—î.
                    </p>

                    <!-- –ü—Ä–∏–∫–ª–∞–¥ 6.10 -->
                    <h3><span class="example-title">–ü—Ä–∏–∫–ª–∞–¥ 6.10.</span> <span class="text-white">–î–æ—Å–ª—ñ–¥–∏—Ç–∏ —Å–∏—Å—Ç–µ–º—É –Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å —Ç–∞ –∑–Ω–∞–π—Ç–∏ —ó—ó —Ä–æ–∑–≤‚Äô—è–∑–æ–∫, —è–∫—â–æ —Å–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞:</span></h3>
                    <p class="math-notation-centered">
                        \[
                        \begin{cases}
                        2x_1+3x_2-x_3+x_4=1\\
                        8x_1+12x_2-9x_3+8x_4=3\\
                        4x_1+6x_2+3x_3-2x_4=3\\
                        2x_1+3x_2+9x_3-7x_4=3
                        \end{cases}
                        \]
                    </p>
                    <p style="color: orange; font-weight: bold; text-align: center; font-size: 1.2em; margin: 1em 0;">–†–æ–∑–≤‚Äô—è–∑–∞–Ω–Ω—è</p>
                    <p>
                        –°–∏—Å—Ç–µ–º–∞ –º–∞—î \(4\) —Ä—ñ–≤–Ω—è–Ω–Ω—è —ñ \(4\) –∑–º—ñ–Ω–Ω—ñ \((m=4, n=4)\). –í–æ–Ω–∞ –º–æ–∂–µ –º–∞—Ç–∏ —î–¥–∏–Ω–∏–π —Ä–æ–∑–≤‚Äô—è–∑–æ–∫, –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤ –∞–±–æ –±—É—Ç–∏ –Ω–µ—Å—É–º—ñ—Å–Ω–æ—é. –ú–µ—Ç–æ–¥ –ì–∞—É—Å–∞ –¥–æ–ø–æ–º–æ–∂–µ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ —Ü–µ –∑–∞–≤–¥—è–∫–∏ —Å–≤–æ—ó–π —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—ñ.
                    </p>
                    <p>–ó–∞–ø–∏—à–µ–º–æ —Ä–æ–∑—à–∏—Ä–µ–Ω—É –º–∞—Ç—Ä–∏—Ü—é —Å–∏—Å—Ç–µ–º–∏:</p>
                    <p class="math-notation-centered">
                        \[
                        \left(\begin{array}{cccc|c}
                        2 & 3 & -1 & 1 & 1 \\
                        8 & 12 & -9 & 8 & 3 \\
                        4 & 6 & 3 & -2 & 3 \\
                        2 & 3 & 9 & -7 & 3
                        \end{array}\right).
                        \]
                    </p>
                    <p>–ó–∞—Å—Ç–æ—Å—É—î–º–æ –µ–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è, —â–æ–± —Å–ø—Ä–æ—Å—Ç–∏—Ç–∏ –º–∞—Ç—Ä–∏—Ü—é. –£—Å—É–Ω–µ–Ω–Ω—è –Ω–µ–Ω—É–ª—å–æ–≤–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ —É –ø–µ—Ä—à–æ–º—É —Å—Ç–æ–≤–ø—Ü—ñ –ø—ñ–¥ –≥–æ–ª–æ–≤–Ω–∏–º –µ–ª–µ–º–µ–Ω—Ç–æ–º:</p>
                    <p class="math-notation-centered">
                        \[
                        \xrightarrow{\;
                        \begin{array}{c}
                        R_2 \to R_2 - 4R_1 \\
                        R_3 \to R_3 - 2R_1 \\
                        R_4 \to R_4 - R_1
                        \end{array}
                        \;}
                        \left(
                        \begin{array}{cccc|c}
                        2 & 3 & -1 & 1 & 1 \\
                        0 & 0 & -5 & 4 & -1 \\
                        0 & 0 & 5 & -4 & 1 \\
                        0 & 0 & 10 & -8 & 2
                        \end{array}
                        \right)
                        \]
                    </p>
                    <p>–û—Å—Ç–∞–Ω–Ω—ñ —Ç—Ä–∏ —Ä—è–¥–∫–∏ –ø—Ä–æ–ø–æ—Ä—Ü—ñ–π–Ω—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, \(R_3=-R_2, R_4=-2R_2\)), —Ç–æ–º—É <em>–≤–∏–¥–∞–ª—è—î–º–æ –¥–≤–∞ –∑ –Ω–∏—Ö</em>, –∑–∞–ª–∏—à–∞—é—á–∏ –ª–∏—à–µ –æ–¥–∏–Ω.</p>
                    <p>–û—Ç–∂–µ, –ø—ñ—Å–ª—è –µ–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–∏—Ö –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω—å —Ä–æ–∑—à–∏—Ä–µ–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è –Ω–∞–±—É–≤–∞—î –≤–∏–≥–ª—è–¥—É:</p>
                    <p class="math-notation-centered">
                        \[
                        \left(\begin{array}{cccc|c}
                        2 & 3 & -1 & 1 & 1 \\
                        0 & 0 & 5 & -4 & 1
                        \end{array}\right).
                        \]
                    </p>
                    <p>–¢–µ–ø–µ—Ä –æ—Ç—Ä–∏–º—É—î–º–æ –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω—É –º–∞—Ç—Ä–∏—Ü—é —Å–∏—Å—Ç–µ–º–∏:</p>
                    <p class="math-notation-centered">
                        \[
                        A=\left(\begin{array}{cccc}
                        2 & 3 & -1 & 1 \\
                        0 & 0 & 5 & -4
                        \end{array}\right)
                        \]
                    </p>
                    <p>—Ç–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω—É –º–∞—Ç—Ä–∏—Ü—é —Å–∏—Å—Ç–µ–º–∏</p>
                    <p class="math-notation-centered">
                        \[
                        (A|b)=\left(\begin{array}{cccc|c}
                        2 & 3 & -1 & 1 & 1 \\
                        0 & 0 & 5 & -4 & 1
                        \end{array}\right).
                        \]
                    </p>
                    <p>
                        –¢–æ–º—É \(r(A)=2\) (–¥–≤–∞ –Ω–µ–Ω—É–ª—å–æ–≤—ñ —Ä—è–¥–∫–∏), \(r(A|b)=2\) (–¥–≤–∞ –Ω–µ–Ω—É–ª—å–æ–≤—ñ —Ä—è–¥–∫–∏).
                        –ó–∞ —Ç–µ–æ—Ä–µ–º–æ—é –ö—Ä–æ–Ω–µ–∫–µ—Ä–∞-–ö–∞–ø–µ–ª–ª—ñ:
                    </p>
                    <p>
                        –û—Å–∫—ñ–ª—å–∫–∏ \(r(A)=r(A|b)=2\), —Å–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞. –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–º—ñ–Ω–Ω–∏—Ö \(n=4\), –∞ \(r(A)=2&lt;4\), —Ç–æ–º—É —Å–∏—Å—Ç–µ–º–∞ –º–∞—î <em>–±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤</em>.
                    </p>
                    <p>–ó–Ω–∞—Ö–æ–¥–∏–º–æ –∑–∞–≥–∞–ª—å–Ω–∏–π —Ä–æ–∑–≤‚Äô—è–∑–æ–∫. –û—Ç—Ä–∏–º–∞–Ω–æ –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω—É —Å–∏—Å—Ç–µ–º—É:</p>
                    <p class="math-notation-centered">
                        \[
                        \begin{cases}
                        2x_1+3x_2-x_3+x_4=1, \\
                        5x_3-4x_4=1.
                        \end{cases}
                        \]
                    </p>
                    <p>
                        –í–∏–∑–Ω–∞—á–∏–º–æ –±–∞–∑–∏—Å–Ω—ñ —Ç–∞ –≤—ñ–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ. <em>–ë–∞–∑–∏—Å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ</em>: \(x_1, x_3\) ‚Äì —Ç—ñ, —â–æ —Å—Ç–æ—è—Ç—å –Ω–∞ ¬´—Å—Ö–æ–¥–∏–Ω–∫–∞—Ö¬ª —Å—Ö—ñ–¥—á–∞—Å—Ç–æ—ó –º–∞—Ç—Ä–∏—Ü—ñ (–ø–µ—Ä—à—ñ –Ω–µ–Ω—É–ª—å–æ–≤—ñ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ –≤ –∫–æ–∂–Ω–æ–º—É —Ä—ñ–≤–Ω—è–Ω–Ω—ñ). <em>–í—ñ–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ</em>:  
                        \(x_2, x_4\) ‚Äì —Ä–µ—à—Ç–∞ –∑–º—ñ–Ω–Ω–∏—Ö, —è–∫—ñ –Ω–µ —î –±–∞–∑–∏—Å–Ω–∏–º–∏ —ñ –º–æ–∂—É—Ç—å –Ω–∞–±—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å.
                    </p>
                    <p>–í–∏—Ä–∞–∑–∏–º–æ –±–∞–∑–∏—Å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ —á–µ—Ä–µ–∑ –≤—ñ–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ. –ó–≤–æ—Ä–æ—Ç–Ω—ñ–π —Ö—ñ–¥ –º–µ—Ç–æ–¥—É –ì–∞—É—Å–∞:</p>
                    <p>
                        –ó –¥—Ä—É–≥–æ–≥–æ —Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ –≤–∏—Ä–∞–∑–∏–º–æ –±–∞–∑–∏—Å–Ω—É –∑–º—ñ–Ω–Ω—É \(x_3\) —á–µ—Ä–µ–∑ \(x_4\):
                    </p>
                    <p class="math-notation-centered">
                        \[
                        x_3=\frac{4}{5}x_4+\frac{1}{5}.
                        \]
                    </p>
                    <p>–ü—ñ–¥—Å—Ç–∞–≤–∏–º–æ —É –ø–µ—Ä—à–µ —Ä—ñ–≤–Ω—è–Ω–Ω—è:</p>
                    <p class="math-notation-centered">
                        \[
                        \begin{aligned}
                        &5x_3 - 4x_4 = 1, \\
                        &5x_3 = 4x_4 + 1 \Rightarrow x_3 = \frac{4}{5}x_4 + \frac{1}{5}
                        \end{aligned}
                        \]
                    </p>
                    <p>–ü—ñ–¥—Å—Ç–∞–≤–∏–º–æ \(x_3 = \frac{4}{5} x_4 + \frac{1}{5}\) —É –ø–µ—Ä—à–µ —Ä—ñ–≤–Ω—è–Ω–Ω—è \(2x_1 + 3x_2 - x_3 + x_4 = 1\) —Å–∏—Å—Ç–µ–º–∏:</p>
                    <p class="math-notation-centered">
                        \[
                        \begin{array}{l}
                        2x_1 + 3x_2 - \left(\frac{4}{5}x_4 + \frac{1}{5}\right) + x_4 = 1,\\
                        2x_1 + 3x_2 - \frac{4}{5}x_4 - \frac{1}{5} + x_4 = 1,\\
                        \hspace{1.5cm} 2x_1 = 1 - 3x_2 - \frac{1}{5}x_4 + \frac{1}{5},\\
                        \hspace{1.5cm} 2x_1 = -3x_2 - \frac{1}{5}x_4 + \frac{6}{5} \Rightarrow x_1 = -\frac{3}{2}x_2 - \frac{1}{10}x_4 + \frac{3}{5}.
                        \end{array}
                        \]
                    </p>
                    <p>–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –æ—Ç—Ä–∏–º–∞–Ω–æ –∑–∞–≥–∞–ª—å–Ω–∏–π —Ä–æ–∑–≤‚Äô—è–∑–æ–∫ –¥–ª—è –±–∞–∑–∏—Å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö \(x_1\) —ñ \(x_3\), –≤–∏—Ä–∞–∂–µ–Ω–∏—Ö —á–µ—Ä–µ–∑ –≤—ñ–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ \(x_2\) —ñ \(x_4\):</p>
                    <p class="math-notation-centered">
                        \[
                        \begin{cases}
                        x_1=-\frac{3}{2}x_2-\frac{1}{10}x_4+\frac{3}{5}, \\
                        x_2 \in \mathbb{R}, \\
                        x_3=\frac{4}{5}x_4+\frac{1}{5}, \\
                        x_4 \in \mathbb{R}.
                        \end{cases}
                        \]
                    </p>
                    <p>
                        <span class="example-title">–í—ñ–¥–ø–æ–≤—ñ–¥—å:</span>  
                        \((x_1,x_2,x_3,x_4)=\left(-\frac{3}{2}x_2-\frac{1}{10}x_4+\frac{3}{5},\; x_2,\; \frac{4}{5}x_4+\frac{1}{5},\; x_4\right), \; x_2,x_4 \in \mathbb{R}.\)
                    </p>
                </details>
            </div>
        </div>
    </div>

  <div id="videoModal" class="modal">
        <div class="modal-header">
            <button class="close-btn" id="closeVideoBtn">√ó –ó–∞–∫—Ä–∏—Ç–∏</button>
        </div>
        <div class="modal-content">
                       <div class="video-card-container">
                <div class="video-card" data-video="1">
                    <img src="https://img.icons8.com/?size=100&id=o1CR3NjO7Pv8&format=png&color=000000" alt="–í—ñ–¥–µ–æ–∫–∞–º–µ—Ä–∞">
                    <h3>–ù–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ –ª—ñ–Ω—ñ–π–Ω–∏—Ö —Ä—ñ–≤–Ω—è–Ω—å. –¢–µ–æ—Ä–µ–º–∞ –ö—Ä–æ–Ω–µ–∫–µ—Ä–∞-–ö–∞–ø–µ–ª—ñ.</h3>
                </div>
                                            </div>
        </div>
    </div>

    <div id="videoPlayerModal1" class="modal">
        <div class="modal-header">
            <button class="close-btn" id="closeVideoPlayerBtn1">√ó –ó–∞–∫—Ä–∏—Ç–∏</button>
        </div>
        <div class="modal-content">
            <div class="video-player-container">
                <iframe id="youtubePlayer1" title="–ù–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ –ª—ñ–Ω—ñ–π–Ω–∏—Ö —Ä—ñ–≤–Ω—è–Ω—å. –¢–µ–æ—Ä–µ–º–∞ –ö—Ä–æ–Ω–µ–∫–µ—Ä–∞-–ö–∞–ø–µ–ª–ª—ñ" width="100%" height="100%" data-src="https://www.youtube.com/embed/7iqR_k8tN1E" src="https://www.youtube.com/embed/7iqR_k8tN1E" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
        </div>
    </div>

    <div id="questionsModal" class="modal">
        <div class="modal-header">
            <button class="close-btn" id="closeQuestionsBtn">√ó –ó–∞–∫—Ä–∏—Ç–∏</button>
        </div>
        <div class="modal-content">
            <div class="flashcard-container">
                <div class="flashcard" tabindex="0">
                    <div class="flashcard-inner">
                        <div class="front">
                            <p>1. –©–æ –æ–∑–Ω–∞—á–∞—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ —Å–∏—Å—Ç–µ–º–∏ –ª—ñ–Ω—ñ–π–Ω–∏—Ö —Ä—ñ–≤–Ω—è–Ω—å?</p>
                        </div>
                        <div class="back">
                            <p>–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è, —á–∏ –º–∞—î —Å–∏—Å—Ç–µ–º–∞ —Ö–æ—á–∞ –± –æ–¥–∏–Ω —Ä–æ–∑–≤‚Äô—è–∑–æ–∫.</p>
                        </div>
                    </div>
                </div>
                <div class="flashcard" tabindex="0">
                    <div class="flashcard-inner">
                        <div class="front">
                            <p>2. –Ø–∫–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ —Å–∏—Å—Ç–µ–º–∏?</p>
                        </div>
                        <div class="back">
                            <p>–¢–µ–æ—Ä–µ–º–∞ –ö—Ä–æ–Ω–µ–∫–µ—Ä–∞-–ö–∞–ø–µ–ª–ª—ñ, —è–∫–∞ –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ —Ä–∞–Ω–≥–∞—Ö –º–∞—Ç—Ä–∏—Ü—å.</p>
                        </div>
                    </div>
                </div>
                <div class="flashcard" tabindex="0">
                    <div class="flashcard-inner">
                        <div class="front">
                            <p>3. –Ø–∫–∞ —É–º–æ–≤–∞ —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ —Å–∏—Å—Ç–µ–º–∏ –∑–∞ —Ç–µ–æ—Ä–µ–º–æ—é –ö—Ä–æ–Ω–µ–∫–µ—Ä–∞-–ö–∞–ø–µ–ª–ª—ñ?</p>
                        </div>
                        <div class="back">
                            <p>–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞, —è–∫—â–æ \( r(A) = r(A|B) \).</p>
                        </div>
                    </div>
                </div>
                <div class="flashcard" tabindex="0">
                    <div class="flashcard-inner">
                        <div class="front">
                            <p>4. –©–æ –æ–∑–Ω–∞—á–∞—î, —è–∫—â–æ \( r(A) = r(A|B) \) —ñ —Ä–∞–Ω–≥ –º–∞—Ç—Ä–∏—Ü—ñ –¥–æ—Ä—ñ–≤–Ω—é—î –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–º—ñ–Ω–Ω–∏—Ö?</p>
                        </div>
                        <div class="back">
                            <p>–°–∏—Å—Ç–µ–º–∞ –º–∞—î —î–¥–∏–Ω–∏–π —Ä–æ–∑–≤‚Äô—è–∑–æ–∫.</p>
                        </div>
                    </div>
                </div>
                <div class="flashcard" tabindex="0">
                    <div class="flashcard-inner">
                        <div class="front">
                            <p>5. –©–æ –æ–∑–Ω–∞—á–∞—î, —è–∫—â–æ \( r(A) = r(A|B) \), –∞–ª–µ —Ä–∞–Ω–≥ –º–µ–Ω—à–∏–π –∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–º—ñ–Ω–Ω–∏—Ö?</p>
                        </div>
                        <div class="back">
                            <p>–°–∏—Å—Ç–µ–º–∞ –º–∞—î –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤.</p>
                        </div>
                    </div>
                </div>
                <div class="flashcard" tabindex="0">
                    <div class="flashcard-inner">
                        <div class="front">
                            <p>6. –©–æ –æ–∑–Ω–∞—á–∞—î, —è–∫—â–æ \( r(A) \neq r(A|B) \)?</p>
                        </div>
                        <div class="back">
                            <p>–°–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞, —Ç–æ–±—Ç–æ –Ω–µ –º–∞—î –∂–æ–¥–Ω–æ–≥–æ —Ä–æ–∑–≤‚Äô—è–∑–∫—É.</p>
                        </div>
                    </div>
                </div>
                <div class="flashcard" tabindex="0">
                    <div class="flashcard-inner">
                        <div class="front">
                            <p>7. –Ø–∫ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω—É –º–∞—Ç—Ä–∏—Ü—é —Å–∏—Å—Ç–µ–º–∏?</p>
                        </div>
                        <div class="back">
                            <p>–î–æ–¥–∞—é—Ç—å –¥–æ –º–∞—Ç—Ä–∏—Ü—ñ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤ \( A \) —Å—Ç–æ–≤–ø–µ—Ü—å –≤—ñ–ª—å–Ω–∏—Ö —á–ª–µ–Ω—ñ–≤ \( b \), —É—Ç–≤–æ—Ä—é—é—á–∏ \( (A|B) \).</p>
                        </div>
                    </div>
                </div>
                <div class="flashcard" tabindex="0">
                    <div class="flashcard-inner">
                        <div class="front">
                            <p>8. –Ø–∫—ñ –æ—Å–Ω–æ–≤–Ω—ñ –∫—Ä–æ–∫–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ —Å–∏—Å—Ç–µ–º–∏?</p>
                        </div>
                        <div class="back">
                            <p>
                                1. –ü–æ–±—É–¥–æ–≤–∞ –º–∞—Ç—Ä–∏—Ü—å \( A \) —Ç–∞ \( (A|B) \).<br>
                                2. –û–±—á–∏—Å–ª–µ–Ω–Ω—è —Ä–∞–Ω–≥—ñ–≤ \( r(A) \) —ñ \( r(A|B) \).<br>
                                3. –í–∏—Å–Ω–æ–≤–∫–∏ –∑–∞ —Ç–µ–æ—Ä–µ–º–æ—é –ö—Ä–æ–Ω–µ–∫–µ—Ä–∞-–ö–∞–ø–µ–ª–ª—ñ.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<div id="trainerModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="trainerTitle">
    <div class="modal-header">
        <button class="close-btn" id="closeTrainerBtn" aria-label="–ó–∞–∫—Ä–∏—Ç–∏">√ó –ó–∞–∫—Ä–∏—Ç–∏</button>
    </div>
    <div class="modal-content">
        <div class="trainer-container">
            <div class="question-circle">–ü–∏—Ç–∞–Ω–Ω—è 1</div>
            <div class="trainer-question">
                –ó–∞–¥–∞–Ω–æ —Ä–æ–∑—à–∏—Ä–µ–Ω—É –º–∞—Ç—Ä–∏—Ü—é —Å–∏—Å—Ç–µ–º–∏ –≤ —Å—Ö—ñ–¥—á–∞—Å—Ç–æ–º—É –≤–∏–≥–ª—è–¥—ñ:
            </div>
            <div class="system-equations" id="systemEquations"></div>
            <div class="trainer-options" id="trainerOptions"></div>
            <button class="trainer-submit" id="submitAnswer">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
            <div class="trainer-feedback" id="feedbackMessage"></div>
            <div class="completion-message" id="completionMessage" style="display: none;">
    <div class="completion-emoji"></div>
    <h2>–¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ!</h2>
    <p style="font-weight:bold; color:#ccff00;">–ú–æ–ª–æ–¥–µ—Ü—å!</p>
    <button id="resetTrainerBtn" aria-label="–°–ø—Ä–æ–±—É–≤–∞—Ç–∏ —â–µ —Ä–∞–∑">–°–ø—Ä–æ–±—É–≤–∞—Ç–∏ —â–µ —Ä–∞–∑</button>
</div>
        </div>
    </div>
</div>

    <div id="modalOverlay"></div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    document.body.classList.add('loaded');

    const elements = {
        openTheoryBtn: document.getElementById('openTheoryBtn'),
        openVideoBtn: document.getElementById('openVideoBtn'),
        openQuestionsBtn: document.getElementById('openQuestionsBtn'),
        openTrainerBtn: document.getElementById('openTrainerBtn'),
        theoryModal: document.getElementById('theoryModal'),
        videoModal: document.getElementById('videoModal'),
        questionsModal: document.getElementById('questionsModal'),
        trainerModal: document.getElementById('trainerModal'),
        videoPlayerModal1: document.getElementById('videoPlayerModal1'),
        closeTheoryBtn: document.getElementById('closeTheoryBtn'),
        closeVideoBtn: document.getElementById('closeVideoBtn'),
        closeQuestionsBtn: document.getElementById('closeQuestionsBtn'),
        closeTrainerBtn: document.getElementById('closeTrainerBtn'),
        closeVideoPlayerBtn1: document.getElementById('closeVideoPlayerBtn1'),
        modalOverlay: document.getElementById('modalOverlay'),
        youtubePlayer1: document.getElementById('youtubePlayer1'),
        systemEquations: document.getElementById('systemEquations'),
        trainerOptions: document.getElementById('trainerOptions'),
        submitAnswer: document.getElementById('submitAnswer'),
        feedbackMessage: document.getElementById('feedbackMessage'),
        completionMessage: document.getElementById('completionMessage'),
        resetTrainerBtn: document.getElementById('resetTrainerBtn'),
        questionCircle: document.querySelector('.question-circle'),
        trainerQuestion: document.querySelector('.trainer-question')
    };

    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
    Object.entries(elements).forEach(([key, value]) => {
        if (!value) console.error(`–ï–ª–µ–º–µ–Ω—Ç ${key} –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –≤ DOM`);
    });

    
    function toggleModal(modal, show) {
        if (!modal) {
            console.error('–ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ');
            return;
        }
        modal.style.display = show ? 'flex' : 'none';
        elements.modalOverlay.style.display = show ? 'block' : 'none';
        document.body.style.overflow = show ? 'hidden' : 'auto';
        if (show) {
            const closeBtn = modal.querySelector('.close-btn');
            if (closeBtn) closeBtn.focus();
            if (window.MathJax && MathJax.typesetPromise) {
                MathJax.typesetPromise([modal]).then(() => {
                    console.log(`MathJax —Ç–∏–ø—ñ–∑–∞—Ü—ñ—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –¥–ª—è ${modal.id}`);
                    const modalContent = modal.querySelector('.modal-content');
                    if (modalContent) modalContent.scrollTop = 0;
                }).catch(err => console.error('–ü–æ–º–∏–ª–∫–∞ MathJax:', err));
            }
        }
    }

    // –õ–æ–≥—ñ–∫–∞ –¥–ª—è YouTube-–≤—ñ–¥–µ–æ (–∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –±–µ–∑ –∑–º—ñ–Ω)
    let players = {};
    const playerIds = {
        'youtubePlayer1': '7iqR_k8tN1E'
    };

    const playerSrcs = {
        'youtubePlayer1': elements.youtubePlayer1?.getAttribute('data-src') || 'https://www.youtube.com/embed/7iqR_k8tN1E'
    };

    function loadYouTubeAPI() {
        if (!window.YT) {
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        }
    }

    window.onYouTubeIframeAPIReady = function() {
        Object.keys(playerIds).forEach(playerId => {
            const element = elements[playerId];
            if (element) {
                players[playerId] = new YT.Player(playerId, {
                    videoId: playerIds[playerId],
                    playerVars: { 'autoplay': 0, 'controls': 1, 'rel': 0, 'showinfo': 0 },
                    events: {
                        'onReady': event => {
                            event.target.cueVideoById({ videoId: playerIds[playerId], startSeconds: 0 });
                        },
                        'onError': event => {
                            console.error(`YouTube Player error for ${playerId}:`, event.data);
                        }
                    }
                });
            }
        });
    };

    loadYouTubeAPI();

    function stopAllVideos() {
        Object.keys(players).forEach(playerId => {
            const player = players[playerId];
            const element = elements[playerId];
            if (player && typeof player.stopVideo === 'function') {
                player.stopVideo();
            }
            if (element) {
                element.src = '';
                const parent = element.parentNode;
                const newIframe = document.createElement('iframe');
                newIframe.id = playerId;
                newIframe.setAttribute('data-src', playerSrcs[playerId]);
                newIframe.setAttribute('src', playerSrcs[playerId]);
                newIframe.setAttribute('title', '–ù–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ –ª—ñ–Ω—ñ–π–Ω–∏—Ö —Ä—ñ–≤–Ω—è–Ω—å. –¢–µ–æ—Ä–µ–º–∞ –ö—Ä–æ–Ω–µ–∫–µ—Ä–∞-–ö–∞–ø–µ–ª–ª—ñ');
                newIframe.setAttribute('frameborder', '0');
                newIframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
                newIframe.setAttribute('allowfullscreen', '');
                newIframe.style.width = '100%';
                newIframe.style.height = '100%';
                parent.replaceChild(newIframe, element);
                elements[playerId] = newIframe;
                players[playerId] = new YT.Player(playerId, {
                    videoId: playerIds[playerId],
                    playerVars: { 'autoplay': 0, 'controls': 1, 'rel': 0, 'showinfo': 0 },
                    events: {
                        'onReady': event => event.target.cueVideoById({ videoId: playerIds[playerId], startSeconds: 0 }),
                        'onError': event => console.error(`YouTube Player error for ${playerId}:`, event.data)
                    }
                });
            }
        });
    }

    function openVideoPlayerModal(videoModal, playerId) {
        stopAllVideos();
        toggleModal(elements.videoModal, false);
        toggleModal(videoModal, true);
        const element = elements[playerId];
        if (element && !element.src) {
            element.src = playerSrcs[playerId];
        }
        if (players[playerId] && typeof players[playerId].loadVideoById === 'function') {
            players[playerId].loadVideoById({ videoId: playerIds[playerId], startSeconds: 0 });
        }
    }

    // –õ–æ–≥—ñ–∫–∞ –¥–ª—è —Ñ–ª–µ—à-–∫–∞—Ä—Ç–æ–∫ (–∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –±–µ–∑ –∑–º—ñ–Ω)
    document.querySelectorAll('.flashcard').forEach(card => {
        card.addEventListener('click', () => {
            card.classList.toggle('flipped');
            if (window.MathJax && window.MathJax.typesetPromise) {
                window.MathJax.typesetPromise([card]).catch(err => console.error('MathJax error in flashcard:', err));
            }
        });
        card.addEventListener('keydown', e => {
            if (e.key === 'Enter' || e.key === 'Space') {
                e.preventDefault();
                card.classList.toggle('flipped');
                if (window.MathJax && window.MathJax.typesetPromise) {
                    window.MathJax.typesetPromise([card]).catch(err => console.error('MathJax error in flashcard:', err));
                }
            }
        });
    });

    document.querySelectorAll('.video-card').forEach(card => {
        card.addEventListener('click', () => {
            const videoNumber = card.getAttribute('data-video');
            const videoModal = elements[`videoPlayerModal${videoNumber}`];
            const playerId = `youtubePlayer${videoNumber}`;
            if (videoModal && playerId) openVideoPlayerModal(videoModal, playerId);
            else console.error(`Video modal or player not found for video ${videoNumber}`);
        });
    });



// –õ–æ–≥—ñ–∫–∞ –¥–ª—è —Ç—Ä–µ–Ω–∞–∂–µ—Ä–∞
let correctRankA, correctRankAb;
let questionCount = 1;

const fixedMatricesQ3 = [
    {
        A: [[1, -1, 2], [4, -4, 8], [-3, 3, -6]],
        b: [5, 20, -15],
        correct: { rankA: 1, rankAb: 1 },
        incorrect: [
            { rankA: 3, rankAb: 3 },
            { rankA: 2, rankAb: 3 },
            { rankA: 1, rankAb: 2 }
        ]
    },
    {
        A: [[5, 4, -3], [-10, -8, 6], [-5, -4, 3]],
        b: [4, 3, -4],
        correct: { rankA: 1, rankAb: 2 },
        incorrect: [
            { rankA: 1, rankAb: 3 },
            { rankA: 2, rankAb: 2 },
            { rankA: 1, rankAb: 1 }
        ]
    },
    {
        A: [[3, -2, 4], [1, 5, -3], [6, -4, 8]],
        b: [1, 2, 2],
        correct: { rankA: 2, rankAb: 2 },
        incorrect: [
            { rankA: 3, rankAb: 3 },
            { rankA: 2, rankAb: 3 },
            { rankA: 1, rankAb: 2 }
        ]
    },
    {
        A: [[4, -2, 1], [5, 3, 2], [-8, 4, -2]],
        b: [4, 3, 6],
        correct: { rankA: 2, rankAb: 3 },
        incorrect: [
            { rankA: 3, rankAb: 3 },
            { rankA: 2, rankAb: 2 },
            { rankA: 1, rankAb: 2 }
        ]
    },
    {
        A: [[3, 2, -5], [2, -1, 3], [1, 2, -1]],
        b: [-1, 13, 9],
        correct: { rankA: 3, rankAb: 3 },
        incorrect: [
            { rankA: 2, rankAb: 3 },
            { rankA: 2, rankAb: 2 },
            { rankA: 1, rankAb: 2 }
        ]
    },
    {
        A: [[3, 2, -5], [-6, -4, 10], [9, 6, -15]],
        b: [1, -2, 3],
        correct: { rankA: 1, rankAb: 1 },
        incorrect: [
            { rankA: 3, rankAb: 3 },
            { rankA: 2, rankAb: 3 },
            { rankA: 1, rankAb: 2 }
        ]
    },
    {
        A: [[-2, 3, 1], [2, -3, -1], [-8, 12, 4]],
        b: [-1, 5, -4],
        correct: { rankA: 1, rankAb: 2 },
        incorrect: [
            { rankA: 1, rankAb: 3 },
            { rankA: 2, rankAb: 2 },
            { rankA: 1, rankAb: 1 }
        ]
    },
    {
        A: [[4, 1, -2], [8, 4, 6], [-8, -2, 4]],
        b: [-3, -1, 6],
        correct: { rankA: 2, rankAb: 2 },
        incorrect: [
            { rankA: 3, rankAb: 3 },
            { rankA: 2, rankAb: 3 },
            { rankA: 1, rankAb: 2 }
        ]
    },
    {
        A: [[1, 4, 5], [3, 12, 10], [-4, -16, -20]],
        b: [2, 4, 8],
        correct: { rankA: 2, rankAb: 3 },
        incorrect: [
            { rankA: 3, rankAb: 3 },
            { rankA: 2, rankAb: 2 },
            { rankA: 1, rankAb: 2 }
        ]
    },
    {
        A: [[1, -2, 3], [2, 4, -3], [1, 3, 2]],
        b: [0, -1, 4],
        correct: { rankA: 3, rankAb: 3 },
        incorrect: [
            { rankA: 2, rankAb: 3 },
            { rankA: 2, rankAb: 2 },
            { rankA: 1, rankAb: 2 }
        ]
    },
    {
        A: [[1, 0, 1], [0, 0, 0], [-2, 0, -2]],
        b: [4, 0, -8],
        correct: { rankA: 1, rankAb: 1 },
        incorrect: [
            { rankA: 3, rankAb: 3 },
            { rankA: 2, rankAb: 3 },
            { rankA: 1, rankAb: 2 }
        ]
    },
    {
        A: [[2, 1, 0], [6, 3, 0], [-4, -2, 0]],
        b: [-1, -3, -2],
        correct: { rankA: 1, rankAb: 2 },
        incorrect: [
            { rankA: 1, rankAb: 3 },
            { rankA: 2, rankAb: 2 },
            { rankA: 1, rankAb: 1 }
        ]
    },
    {
        A: [[0, 1, -3], [2, 0, -3], [0, -2, 6]],
        b: [1, 0, -2],
        correct: { rankA: 2, rankAb: 2 },
        incorrect: [
            { rankA: 3, rankAb: 3 },
            { rankA: 2, rankAb: 3 },
            { rankA: 1, rankAb: 2 }
        ]
    },
    {
        A: [[0, -1, 1], [1, 0, 1], [1, 1, 0]],
        b: [-1, 1, 1],
        correct: { rankA: 2, rankAb: 3 },
        incorrect: [
            { rankA: 3, rankAb: 3 },
            { rankA: 2, rankAb: 2 },
            { rankA: 1, rankAb: 2 }
        ]
    },
    {
        A: [[0, -1, 1], [1, 0, 1], [1, -1, 0]],
        b: [-1, 1, 1],
        correct: { rankA: 3, rankAb: 3 },
        incorrect: [
            { rankA: 2, rankAb: 3 },
            { rankA: 2, rankAb: 2 },
            { rankA: 1, rankAb: 2 }
        ]
    }
];

const fixedSystemsQ4 = [
    {
        A: [[3, 2, -5], [2, -1, 3], [1, 2, -1]],
        b: [-1, 13, 9],
        equations: ['3x + 2y - 5z = -1', '2x - y + 3z = 13', 'x + 2y - z = 9'],
        correct: '–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –æ–¥–∏–Ω —Ä–æ–∑–≤‚Äô—è–∑–æ–∫',
        incorrect: ['–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤', '–°–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞', '–ù–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏']
    },
    {
        A: [[2, 3, -1, 1], [8, 12, -9, 8], [4, 6, 3, -2], [2, 3, 9, -7]],
        b: [1, 3, 3, 3],
        equations: ['2x_1 + 3x_2 - x_3 + x_4 = 1', '8x_1 + 12x_2 - 9x_3 + 8x_4 = 3', '4x_1 + 6x_2 + 3x_3 - 2x_4 = 3', '2x_1 + 3x_2 + 9x_3 - 7x_4 = 3'],
        correct: '–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤',
        incorrect: ['–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –æ–¥–∏–Ω —Ä–æ–∑–≤‚Äô—è–∑–æ–∫', '–°–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞', '–ù–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏']
    },
    {
        A: [[4, -3, 2, -1], [3, -2, 1, -3], [5, -3, 1, -8]],
        b: [8, 7, 1],
        equations: ['4x_1 - 3x_2 + 2x_3 - x_4 = 8', '3x_1 - 2x_2 + x_3 - 3x_4 = 7', '5x_1 - 3x_2 + x_3 - 8x_4 = 1'],
        correct: '–°–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞',
        incorrect: ['–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –æ–¥–∏–Ω —Ä–æ–∑–≤‚Äô—è–∑–æ–∫', '–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤', '–ù–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏']
    },
    {
        A: [[3, 4, -1, -1], [2, -1, -2, 2], [1, 3, 5, -4], [4, -8, -3, 3]],
        b: [3, 9, 2, 10],
        equations: ['3x_1 + 4x_2 - x_3 - x_4 = 3', '2x_1 - x_2 - 2x_3 + 2x_4 = 9', 'x_1 + 3x_2 + 5x_3 - 4x_4 = 2', '4x_1 - 8x_2 - 3x_3 + 3x_4 = 10'],
        correct: '–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –æ–¥–∏–Ω —Ä–æ–∑–≤‚Äô—è–∑–æ–∫',
        incorrect: ['–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤', '–°–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞', '–ù–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏']
    },
    {
        A: [[2, -1, 1, -5], [2, 1, 2, -1], [6, -1, 1, 11]],
        b: [4, 1, 6],
        equations: ['2x_1 - x_2 + x_3 - 5x_4 = 4', '2x_1 + x_2 + 2x_3 - x_4 = 1', '6x_1 - x_2 + x_3 + 11x_4 = 6'],
        correct: '–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤',
        incorrect: ['–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –æ–¥–∏–Ω —Ä–æ–∑–≤‚Äô—è–∑–æ–∫', '–°–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞', '–ù–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏']
    },
    {
        A: [[1, 1, -3, 2], [0, 1, 1, 3], [1, -2, 0, -1], [2, -3, 2, 0]],
        b: [6, 16, -6, 6],
        equations: ['x_1 + x_2 - 3x_3 + 2x_4 = 6', 'x_2 + x_3 + 3x_4 = 16', 'x_1 - 2x_2 - x_4 = -6', '2x_1 - 3x_2 + 2x_3 = 6'],
        correct: '–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –æ–¥–∏–Ω —Ä–æ–∑–≤‚Äô—è–∑–æ–∫',
        incorrect: ['–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤', '–°–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞', '–ù–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏']
    },
    {
        A: [[3, -5, 2, 4], [7, -4, 1, 3], [5, 7, -4, -6]],
        b: [2, 5, 3],
        equations: ['3x_1 - 5x_2 + 2x_3 + 4x_4 = 2', '7x_1 - 4x_2 + x_3 + 3x_4 = 5', '5x_1 + 7x_2 - 4x_3 - 6x_4 = 3'],
        correct: '–°–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞',
        incorrect: ['–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –æ–¥–∏–Ω —Ä–æ–∑–≤‚Äô—è–∑–æ–∫', '–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤', '–ù–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏']
    },
    {
        A: [[9, -3, 5, 6], [6, -2, 3, 4], [3, -1, 3, 14]],
        b: [4, 5, -8],
        equations: ['9x_1 - 3x_2 + 5x_3 + 6x_4 = 4', '6x_1 - 2x_2 + 3x_3 + 4x_4 = 5', '3x_1 - x_2 + 3x_3 + 14x_4 = -8'],
        correct: '–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤',
        incorrect: ['–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –æ–¥–∏–Ω —Ä–æ–∑–≤‚Äô—è–∑–æ–∫', '–°–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞', '–ù–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏']
    },
    {
        A: [[1, 2, -4], [2, 1, -5], [1, -1, -1]],
        b: [1, -1, -2],
        equations: ['x + 2y - 4z = 1', '2x + y - 5z = -1', 'x - y - z = -2'],
        correct: '–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –æ–¥–∏–Ω —Ä–æ–∑–≤‚Äô—è–∑–æ–∫',
        incorrect: ['–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤', '–°–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞', '–ù–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏']
    },
    {
        A: [[2, -1, 1], [1, 2, 3], [1, -3, -2]],
        b: [-2, -1, 3],
        equations: ['2x - y + z = -2', 'x + 2y + 3z = -1', 'x - 3y - 2z = 3'],
        correct: '–°–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞',
        incorrect: ['–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –æ–¥–∏–Ω —Ä–æ–∑–≤‚Äô—è–∑–æ–∫', '–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤', '–ù–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏']
    }
];

function randomInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

function computeRank(matrix) {
    try {
        const m = matrix.length;
        const n = matrix[0].length;
        const mat = matrix.map(row => row.slice());
        let rank = 0;
        let lead = 0;

        while (lead < m && rank < n) {
            let i = lead;
            while (i < m && Math.abs(mat[i][rank]) < 1e-8) i++;
            if (i === m) { rank++; continue; }
            if (i !== lead) [mat[lead], mat[i]] = [mat[i], mat[lead]];
            const pivot = mat[lead][rank];
            if (Math.abs(pivot) < 1e-8) { rank++; continue; }
            for (let j = 0; j < n; j++) mat[lead][j] /= pivot;
            for (let k = 0; k < m; k++) {
                if (k !== lead && Math.abs(mat[k][rank]) > 1e-8) {
                    const factor = mat[k][rank];
                    for (let j = 0; j < n; j++) mat[k][j] -= factor * mat[lead][j];
                }
            }
            lead++;
            rank++;
        }
        for (let i = lead; i < m; i++) {
            if (mat[i].some(val => Math.abs(val) > 1e-8)) {
                lead++;
            }
        }
        return lead;
    } catch (err) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –≤ computeRank:', err);
        throw err;
    }
}

function generateQuestion() {
    try {
        console.log('–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–∏—Ç–∞–Ω–Ω—è –¥–ª—è questionCount:', questionCount);
        elements.trainerQuestion.innerHTML = '';
        elements.trainerOptions.innerHTML = '';
        elements.systemEquations.innerHTML = '';

        let A, b, options;
        const allowedRanksQ1 = [
            { rankA: 1, rankAb: 1 },
            { rankA: 1, rankAb: 2 },
            { rankA: 2, rankAb: 2 },
            { rankA: 2, rankAb: 3 },
            { rankA: 3, rankAb: 3 }
        ];
        const allowedRanksQ2 = [
            { rankA: 1, rankAb: 1 },
            { rankA: 1, rankAb: 2 },
            { rankA: 2, rankAb: 2 },
            { rankA: 2, rankAb: 3 },
            { rankA: 3, rankAb: 3 },
            { rankA: 3, rankAb: 4 },
            { rankA: 4, rankAb: 4 }
        ];

        let maxRankAttempts = 50;
        let rankAttempts = 0;

        if (questionCount === 3) {
            console.log('–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–∏—Ç–∞–Ω–Ω—è 3');
            const system = fixedMatricesQ3[Math.floor(Math.random() * fixedMatricesQ3.length)];
            A = system.A.map(row => row.slice());
            b = system.b.slice();
            const rankA = system.correct.rankA;
            const rankAb = system.correct.rankAb;

            options = [
                { text: `r(A)=${rankA}, r(A|b)=${rankAb}`, correct: true },
                ...system.incorrect.map(opt => ({
                    text: `r(A)=${opt.rankA}, r(A|b)=${opt.rankAb}`,
                    correct: false
                }))
            ];

            for (let i = options.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [options[i], options[j]] = [options[j], options[i]];
            }

            console.log('–°–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø–∏—Ç–∞–Ω–Ω—è 3:', { A, b, rankA, rankAb, options });

            const Ab = A.map((row, i) => [...row, b[i]]);
            const computedRankA = computeRank(A);
            const computedRankAb = computeRank(Ab);
            console.log('–û–±—á–∏—Å–ª–µ–Ω—ñ —Ä–∞–Ω–≥–∏: r(A)=', computedRankA, 'r(A|b)=', computedRankAb);
            if (computedRankA !== rankA || computedRankAb !== rankAb) {
                console.error('–ù–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —Ä–∞–Ω–≥—ñ–≤:', { computedRankA, computedRankAb, expectedRankA: rankA, expectedRankAb: rankAb });
                elements.trainerQuestion.innerHTML = '<span style="color: red;">–ü–æ–º–∏–ª–∫–∞: –ù–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —Ä–∞–Ω–≥—ñ–≤ –¥–ª—è –ø–∏—Ç–∞–Ω–Ω—è 3</span>';
                elements.trainerOptions.innerHTML = '';
                elements.submitAnswer.style.display = 'none';
                return;
            }

            const matrixLatex = `\\left( \\begin{array}{ccc|c} ${A.map((row, i) => row.join(' & ') + ' & ' + b[i]).join(' \\\\ ')} \\end{array} \\right)`;
            elements.trainerQuestion.innerHTML = `
                –ó–∞–¥–∞–Ω–æ —Ä–æ–∑—à–∏—Ä–µ–Ω—É –º–∞—Ç—Ä–∏—Ü—é —Å–∏—Å—Ç–µ–º–∏:<br>
                \\[(A \\mid b) = ${matrixLatex}\\]<br>
                –û–±—á–∏—Å–ª—ñ—Ç—å \\( r(A) \\) —Ç–∞ \\( r(A|b) \\).
            `;
            console.log('LaTeX –¥–ª—è –º–∞—Ç—Ä–∏—Ü—ñ:', matrixLatex);

            elements.trainerOptions.innerHTML = options.map((opt, index) => `
                <button class="option-btn" data-option="${index}" data-correct="${opt.correct}" aria-label="–í–∞—Ä—ñ–∞–Ω—Ç ${index + 1}: ${opt.text}">
                    \\(${opt.text}\\)
                </button>
            `).join('');
            console.log('–í–∞—Ä—ñ–∞–Ω—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π:', options);
        } else if (questionCount === 4) {
            console.log('–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–∏—Ç–∞–Ω–Ω—è 4');
            const system = fixedSystemsQ4[Math.floor(Math.random() * fixedSystemsQ4.length)];
            A = system.A.map(row => row.slice());
            b = system.b.slice();
            const equations = system.equations;

            options = [
                { text: system.correct, correct: true },
                ...system.incorrect.map(opt => ({
                    text: opt,
                    correct: false
                }))
            ];

            for (let i = options.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [options[i], options[j]] = [options[j], options[i]];
            }

            console.log('–°–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø–∏—Ç–∞–Ω–Ω—è 4:', { A, b, equations, correct: system.correct, options });

            const Ab = A.map((row, i) => [...row, b[i]]);
            const computedRankA = computeRank(A);
            const computedRankAb = computeRank(Ab);
            console.log('–û–±—á–∏—Å–ª–µ–Ω—ñ —Ä–∞–Ω–≥–∏: r(A)=', computedRankA, 'r(A|b)=', computedRankAb);

            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ —Å–∏—Å—Ç–µ–º–∏
            const n = A[0].length; // –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–º—ñ–Ω–Ω–∏—Ö
            let expectedAnswer;
            if (computedRankA !== computedRankAb) {
                expectedAnswer = '–°–∏—Å—Ç–µ–º–∞ –Ω–µ—Å—É–º—ñ—Å–Ω–∞';
            } else if (computedRankA === computedRankAb && computedRankA === n) {
                expectedAnswer = '–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –æ–¥–∏–Ω —Ä–æ–∑–≤‚Äô—è–∑–æ–∫';
            } else if (computedRankA === computedRankAb && computedRankA < n) {
                expectedAnswer = '–°–∏—Å—Ç–µ–º–∞ —Å—É–º—ñ—Å–Ω–∞ —ñ –º–∞—î –±–µ–∑–ª—ñ—á —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤';
            } else {
                expectedAnswer = '–ù–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏';
            }

            if (expectedAnswer !== system.correct) {
                console.error('–ù–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:', { computedAnswer: expectedAnswer, expectedCorrect: system.correct, rankA: computedRankA, rankAb: computedRankAb });
                elements.trainerQuestion.innerHTML = '<span style="color: red;">–ü–æ–º–∏–ª–∫–∞: –ù–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –¥–ª—è –ø–∏—Ç–∞–Ω–Ω—è 4</span>';
                elements.trainerOptions.innerHTML = '';
                elements.submitAnswer.style.display = 'none';
                return;
            }

            const equationsLatex = equations.join('\\\\');
            elements.trainerQuestion.innerHTML = `
                –î–æ—Å–ª—ñ–¥—ñ—Ç—å —Å–∏—Å—Ç–µ–º—É –Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å. –Ø–∫—â–æ —Å—É–º—ñ—Å–Ω–∞ ‚Äî –≤–∫–∞–∂—ñ—Ç—å, —Å–∫—ñ–ª—å–∫–∏ –≤ –Ω–µ—ó —Ä–æ–∑–≤‚Äô—è–∑–∫—ñ–≤:<br>
                \\[\\begin{cases} ${equationsLatex} \\end{cases}\\]<br>
            `;
            console.log('LaTeX –¥–ª—è —Ä—ñ–≤–Ω—è–Ω—å:', equationsLatex);

            elements.trainerOptions.innerHTML = options.map((opt, index) => `
                <button class="option-btn" data-option="${index}" data-correct="${opt.correct}" aria-label="–í–∞—Ä—ñ–∞–Ω—Ç ${index + 1}: ${opt.text}">
                    ${opt.text}
                </button>
            `).join('');
            console.log('–í–∞—Ä—ñ–∞–Ω—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π:', options);
        } else {
            const allowedRanks = questionCount === 1 ? allowedRanksQ1 : allowedRanksQ2;
            let computedRankA, computedRankAb, Ab;

            do {
                rankAttempts++;
                if (rankAttempts > maxRankAttempts) {
                    console.error('–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –º–∞—Ç—Ä–∏—Ü—é –∑ –ø–æ—Ç—Ä—ñ–±–Ω–∏–º–∏ —Ä–∞–Ω–≥–∞–º–∏ –ø—ñ—Å–ª—è', maxRankAttempts, '—Å–ø—Ä–æ–±');
                    elements.trainerQuestion.innerHTML = `<span style="color: red;">–ü–æ–º–∏–ª–∫–∞: –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –ø–∏—Ç–∞–Ω–Ω—è ${questionCount}</span>`;
                    elements.trainerOptions.innerHTML = '';
                    elements.submitAnswer.style.display = 'none';
                    return;
                }

                const selectedRank = allowedRanks[Math.floor(Math.random() * allowedRanks.length)];
                correctRankA = selectedRank.rankA;
                correctRankAb = selectedRank.rankAb;

                console.log('–í–∏–±—Ä–∞–Ω—ñ —Ä–∞–Ω–≥–∏ –¥–ª—è –ø–∏—Ç–∞–Ω–Ω—è', questionCount, ': r(A)=', correctRankA, ', r(A|b)=', correctRankAb);

                if (questionCount === 1) {
                    A = [[0, 0, 0], [0, 0, 0], [0, 0, 0]];
                    b = [0, 0, 0];
                    if (correctRankA === 1) {
                        const pivot = randomInt(-5, 5) || 1;
                        A[0] = [pivot, randomInt(-5, 5), randomInt(-5, 5)];
                        if (correctRankAb === 1) {
                            const scalar = randomInt(-10, 10) || 1;
                            b[0] = scalar * pivot;
                            if (b[0] > 30 || b[0] < -30) b[0] = Math.sign(b[0]) * 30;
                            b[1] = 0;
                            b[2] = 0;
                        } else {
                            b[0] = randomInt(-30, 30);
                            b[1] = randomInt(-30, 30);
                            b[2] = 0;
                        }
                    } else if (correctRankA === 2) {
                        const pivot1 = randomInt(-5, 5) || 1;
                        A[0] = [pivot1, randomInt(-5, 5), randomInt(-5, 5)];
                        const pivot2 = randomInt(-5, 5) || 1;
                        A[1] = [0, pivot2, randomInt(-5, 5)];
                        if (correctRankAb === 2) {
                            const scalar1 = randomInt(-10, 10) || 1;
                            const scalar2 = randomInt(-10, 10) || 1;
                            b[0] = scalar1 * pivot1;
                            b[1] = scalar2 * pivot2;
                            if (b[0] > 30 || b[0] < -30) b[0] = Math.sign(b[0]) * 30;
                            if (b[1] > 30 || b[1] < -30) b[1] = Math.sign(b[1]) * 30;
                            b[2] = 0;
                        } else {
                            b[0] = randomInt(-30, 30);
                            b[1] = randomInt(-30, 30);
                            b[2] = randomInt(-30, 30);
                        }
                    } else {
                        const pivot1 = randomInt(-5, 5) || 1;
                        const pivot2 = randomInt(-5, 5) || 1;
                        const pivot3 = randomInt(-5, 5) || 1;
                        A[0] = [pivot1, randomInt(-5, 5), randomInt(-5, 5)];
                        A[1] = [0, pivot2, randomInt(-5, 5)];
                        A[2] = [0, 0, pivot3];
                        b = [randomInt(-30, 30), randomInt(-30, 30), randomInt(-30, 30)];
                    }
                } else {
                    A = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]];
                    b = [0, 0, 0, 0];
                    if (correctRankA === 1 && correctRankAb === 1) {
                        const row1 = [randomInt(-5, 5) || 1, randomInt(-5, 5), randomInt(-5, 5), randomInt(-5, 5)];
                        A[0] = row1;
                        const b1 = randomInt(-30, 30) || 1;
                        b = [b1, 0, 0, 0];
                        for (let i = 1; i < 4; i++) {
                            if (i === 1) {
                                const scalar = randomInt(-5, 5) || 1;
                                A[i] = row1.map(x => x * scalar);
                                b[i] = b1 * scalar;
                            } else {
                                A[i] = [0, 0, 0, 0];
                                b[i] = 0;
                            }
                        }
                    } else if (correctRankA === 1 && correctRankAb === 2) {
                        const row1 = [randomInt(-5, 5) || 1, randomInt(-5, 5), randomInt(-5, 5), randomInt(-5, 5)];
                        A[0] = row1;
                        const scalar = randomInt(-5, 5) || 1;
                        A[1] = row1.map(x => x * scalar);
                        A[2] = [0, 0, 0, 0];
                        A[3] = [0, 0, 0, 0];
                        const b0 = randomInt(-30, 30) || 1;
                        b = [b0, b0 * scalar, randomInt(-30, 30) || 1, 0];
                        let attempts = 0;
                        const maxAttempts = 100;
                        while (computeRank([row1, b]) !== 2 && attempts < maxAttempts) {
                            b[2] = randomInt(-30, 30) || 1;
                            attempts++;
                        }
                        if (attempts >= maxAttempts) continue;
                    } else if (correctRankA === 2 && correctRankAb === 2) {
                        const row1 = [randomInt(-5, 5) || 1, randomInt(-5, 5), randomInt(-5, 5), randomInt(-5, 5)];
                        const row2 = [0, 0, randomInt(-5, 5) || 1, randomInt(-5, 5)];
                        let attempts = 0;
                        const maxAttempts = 100;
                        while (computeRank([row1, row2]) !== 2 && attempts < maxAttempts) {
                            row2[2] = randomInt(-5, 5) || 1;
                            row2[3] = randomInt(-5, 5);
                            attempts++;
                        }
                        if (attempts >= maxAttempts) continue;
                        A[0] = row1;
                        const scalar0 = randomInt(-5, 5) || 1;
                        A[1] = row2;
                        const scalar1 = randomInt(-5, 5) || 1;
                        A[2] = row2.map(x => x * scalar1);
                        const scalar2 = randomInt(-5, 5) || 1;
                        A[3] = row2.map(x => x * scalar2);
                        const b1 = randomInt(-10, 10) || 1;
                        b = [b1 * scalar0, b1, b1 * scalar1, b1 * scalar2];
                        b = b.map(x => Math.max(-30, Math.min(30, x)));
                    } else if (correctRankA === 2 && correctRankAb === 3) {
                        const row1 = [randomInt(-5, 5) || 1, randomInt(-5, 5), randomInt(-5, 5), randomInt(-5, 5)];
                        const row2 = [0, randomInt(-5, 5) || 1, randomInt(-5, 5), randomInt(-5, 5)];
                        let attempts = 0;
                        const maxAttempts = 100;
                        while (computeRank([row1, row2]) !== 2 && attempts < maxAttempts) {
                            row2[1] = randomInt(-5, 5) || 1;
                            row2[2] = randomInt(-5, 5);
                            row2[3] = randomInt(-5, 5);
                            attempts++;
                        }
                        if (attempts >= maxAttempts) continue;
                        const k = randomInt(-5, 5) || 1;
                        const row3 = row2.map(x => x * k);
                        const row4 = [0, 0, 0, 0];
                        b = [randomInt(-30, 30) || 1, randomInt(-30, 30) || 1, row3[3], randomInt(-30, 30) || 1];
                        A[0] = row1;
                        A[1] = row2;
                        A[2] = row3;
                        A[3] = row4;
                        attempts = 0;
                        while (computeRank([row1, row2, row3, row4, b]) !== 3 && attempts < maxAttempts) {
                            b[0] = randomInt(-30, 30) || 1;
                            b[1] = randomInt(-30, 30) || 1;
                            b[3] = randomInt(-30, 30) || 1;
                            attempts++;
                        }
                        if (attempts >= maxAttempts) continue;
                    } else if (correctRankA === 3 && correctRankAb === 3) {
                        const row1 = [randomInt(-5, 5) || 1, randomInt(-5, 5), randomInt(-5, 5), randomInt(-5, 5)];
                        const row2 = [0, randomInt(-5, 5) || 1, randomInt(-5, 5), randomInt(-5, 5)];
                        const row3 = [0, 0, randomInt(-5, 5) || 1, randomInt(-5, 5)];
                        let attempts = 0;
                        const maxAttempts = 100;
                        while (computeRank([row1, row2, row3]) !== 3 && attempts < maxAttempts) {
                            row2[1] = randomInt(-5, 5) || 1;
                            row3[2] = randomInt(-5, 5) || 1;
                            row2[2] = row2[3] = row3[3] = randomInt(-5, 5);
                            attempts++;
                        }
                        if (attempts >= maxAttempts) continue;
                        A[0] = row1;
                        A[1] = row2;
                        A[2] = row3;
                        A[3] = [0, 0, 0, randomInt(-5, 5) || 1];
                        const scalar1 = randomInt(-10, 10) || 1;
                        const scalar2 = randomInt(-10, 10) || 1;
                        const scalar3 = randomInt(-10, 10) || 1;
                        b = row1.map((x, i) => x * scalar1 + row2[i] * scalar2 + row3[i] * scalar3);
                        b = b.map(x => Math.max(-30, Math.min(30, x)));
                    } else if (correctRankA === 3 && correctRankAb === 4) {
                        const row1 = [randomInt(-5, 5) || 1, randomInt(-5, 5), randomInt(-5, 5), randomInt(-5, 5)];
                        const row2 = [0, 0, randomInt(-5, 5) || 1, randomInt(-5, 5)];
                        const row3 = [0, 0, 0, randomInt(-5, 5) || 1];
                        let attempts = 0;
                        const maxAttempts = 100;
                        while (computeRank([row1, row2, row3]) !== 3 && attempts < maxAttempts) {
                            row2[2] = randomInt(-5, 5) || 1;
                            row3[3] = randomInt(-5, 5) || 1;
                            row2[3] = randomInt(-5, 5);
                            attempts++;
                        }
                        if (attempts >= maxAttempts) continue;
                        A[0] = row1;
                        A[1] = row2;
                        A[2] = row3;
                        A[3] = [0, 0, 0, 0];
                        b = [randomInt(-30, 30), randomInt(-30, 30), randomInt(-30, 30), randomInt(-30, 30)];
                        attempts = 0;
                        while (computeRank([row1, row2, row3, b]) !== 4 && attempts < maxAttempts) {
                            b = [randomInt(-30, 30), randomInt(-30, 30), randomInt(-30, 30), randomInt(-30, 30)];
                            attempts++;
                        }
                        if (attempts >= maxAttempts) continue;
                    } else if (correctRankA === 4 && correctRankAb === 4) {
                        A[0] = [randomInt(-5, 5) || 1, randomInt(-5, 5), randomInt(-5, 5), randomInt(-5, 5)];
                        A[1] = [0, randomInt(-5, 5) || 1, randomInt(-5, 5), randomInt(-5, 5)];
                        A[2] = [0, 0, randomInt(-5, 5) || 1, randomInt(-5, 5)];
                        A[3] = [0, 0, 0, randomInt(-5, 5) || 1];
                        let attempts = 0;
                        const maxAttempts = 100;
                        while (computeRank(A) !== 4 && attempts < maxAttempts) {
                            A[1][1] = randomInt(-5, 5) || 1;
                            A[2][2] = randomInt(-5, 5) || 1;
                            A[3][3] = randomInt(-5, 5) || 1;
                            A[1][2] = A[1][3] = A[2][3] = randomInt(-5, 5);
                            attempts++;
                        }
                        if (attempts >= maxAttempts) continue;
                        b = [randomInt(-30, 30), randomInt(-30, 30), randomInt(-30, 30), randomInt(-30, 30)];
                    }
                }

                Ab = A.map((row, i) => [...row, b[i]]);
                computedRankA = computeRank(A);
                computedRankAb = computeRank(Ab);
            } while (computedRankA !== correctRankA || computedRankAb !== correctRankAb);

            console.log('–ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ A:', A, 'b:', b);
            console.log('–û–±—á–∏—Å–ª–µ–Ω—ñ —Ä–∞–Ω–≥–∏: r(A)=', computedRankA, 'r(A|b)=', computedRankAb, '–û—á—ñ–∫—É–≤–∞–Ω—ñ: r(A)=', correctRankA, 'r(A|b)=', correctRankAb);

            const matrixLatex = `\\left( \\begin{array}{${questionCount === 1 ? 'ccc|c' : 'cccc|c'}} ${A.map((row, i) => row.join(' & ') + ' & ' + b[i]).join(' \\\\ ')} \\end{array} \\right)`;
            elements.trainerQuestion.innerHTML = `
                –ó–∞–¥–∞–Ω–æ —Ä–æ–∑—à–∏—Ä–µ–Ω—É –º–∞—Ç—Ä–∏—Ü—é —Å–∏—Å—Ç–µ–º–∏${questionCount === 1 ? ' –≤ —Å—Ö—ñ–¥—á–∞—Å—Ç–æ–º—É –≤–∏–≥–ª—è–¥—ñ' : ''}:<br>
                \\[(A \\mid b) = ${matrixLatex}\\]<br>
                –û–±—á–∏—Å–ª—ñ—Ç—å \\( r(A) \\) —Ç–∞ \\( r(A|b) \\).
            `;
            elements.systemEquations.innerHTML = '';

            const allPossibleRanks = questionCount === 1 ? allowedRanksQ1 : allowedRanksQ2;
            options = [
                { text: `r(A)=${correctRankA}, r(A|b)=${correctRankAb}`, correct: true },
                ...allPossibleRanks
                    .filter(r => r.rankA !== correctRankA || r.rankAb !== correctRankAb)
                    .slice(0, 3)
                    .map(opt => ({ text: `r(A)=${opt.rankA}, r(A|b)=${opt.rankAb}`, correct: false }))
            ];
            for (let i = options.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [options[i], options[j]] = [options[j], options[i]];
            }

            elements.trainerOptions.innerHTML = options.map((opt, index) => `
                <button class="option-btn" data-option="${index}" data-correct="${opt.correct}" aria-label="–í–∞—Ä—ñ–∞–Ω—Ç ${index + 1}: ${opt.text}">
                    \\(${opt.text}\\)
                </button>
            `).join('');
        }

        if (!elements.trainerQuestion.innerHTML || !elements.trainerOptions.innerHTML) {
            console.error('DOM-–µ–ª–µ–º–µ–Ω—Ç–∏ –Ω–µ –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ –¥–ª—è –ø–∏—Ç–∞–Ω–Ω—è', questionCount);
            elements.trainerQuestion.innerHTML = `<span style="color: red;">–ü–æ–º–∏–ª–∫–∞: –ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏ –ø–∏—Ç–∞–Ω–Ω—è ${questionCount}</span>`;
            elements.trainerOptions.innerHTML = '';
            elements.submitAnswer.style.display = 'none';
            return;
        }

        elements.questionCircle.textContent = `–ü–∏—Ç–∞–Ω–Ω—è ${questionCount}`;
        elements.questionCircle.style.display = 'flex';
        elements.trainerQuestion.style.display = 'block';
        elements.systemEquations.style.display = 'none';
        elements.trainerOptions.style.display = 'grid';
        elements.feedbackMessage.style.display = 'none';
        elements.completionMessage.style.display = 'none';
        elements.submitAnswer.style.display = 'block';
        document.querySelectorAll('.option-btn').forEach(btn => {
            btn.classList.remove('wrong', 'selected', 'correct');
        });

        if (window.MathJax && MathJax.typesetPromise) {
            console.log('–ó–∞–ø—É—Å–∫ MathJax –¥–ª—è –ø–∏—Ç–∞–Ω–Ω—è', questionCount);
            MathJax.typesetPromise([elements.trainerQuestion, elements.trainerOptions])
                .then(() => {
                    console.log('MathJax —É—Å–ø—ñ—à–Ω–æ –æ–±—Ä–æ–±–∏–≤ –ø–∏—Ç–∞–Ω–Ω—è', questionCount);
                    elements.trainerOptions.removeEventListener('click', handleOptionClick);
                    elements.trainerOptions.addEventListener('click', handleOptionClick);
                })
                .catch(err => {
                    console.error('–ü–æ–º–∏–ª–∫–∞ MathJax:', err);
                    elements.trainerQuestion.innerHTML = `
                        <span style="color: red;">–ü–æ–º–∏–ª–∫–∞ MathJax. –ú–∞—Ç—Ä–∏—Ü—è: ${A.map((row, i) => row.join(', ') + ' | ' + b[i]).join('; ')}</span>
                    `;
                });
        } else {
            console.error('MathJax –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ');
            elements.trainerQuestion.innerHTML = `
                <span style="color: red;">–ü–æ–º–∏–ª–∫–∞: MathJax –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ. –ú–∞—Ç—Ä–∏—Ü—è: ${A.map((row, i) => row.join(', ') + ' | ' + b[i]).join('; ')}</span>
            `;
        }
    } catch (err) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –≤ generateQuestion:', err);
        elements.trainerQuestion.innerHTML = `<span style="color: red;">–ü–æ–º–∏–ª–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –ø–∏—Ç–∞–Ω–Ω—è ${questionCount}: ${err.message}</span>`;
        elements.trainerOptions.innerHTML = '';
        elements.submitAnswer.style.display = 'none';
    }
}

function handleOptionClick(event) {
    const btn = event.target.closest('.option-btn');
    if (!btn) return;
    console.log('–ö–ª—ñ–∫ –ø–æ –∫–Ω–æ–ø—Ü—ñ:', btn.getAttribute('aria-label'));
    document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected', 'wrong', 'correct'));
    btn.classList.add('selected');
}

function resetTrainer() {
    questionCount = 1; // –°–∫–∏–¥–∞—î–º–æ –¥–æ 1
    elements.systemEquations.innerHTML = '';
    elements.trainerOptions.innerHTML = '';
    elements.feedbackMessage.style.display = 'none';
    elements.completionMessage.style.display = 'none';
    elements.submitAnswer.style.display = 'block';
    elements.questionCircle.style.display = 'flex';
    elements.trainerQuestion.style.display = 'block';
    elements.questionCircle.textContent = '–ü–∏—Ç–∞–Ω–Ω—è 1'; // –Ø–≤–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ "–ü–∏—Ç–∞–Ω–Ω—è 1"
    document.querySelectorAll('.option-btn').forEach(btn => {
        btn.classList.remove('wrong', 'selected', 'correct');
    });
    console.log('resetTrainer: questionCount =', questionCount, ', questionCircle.textContent =', elements.questionCircle.textContent);
    generateQuestion(); // –í–∏–∫–ª–∏–∫–∞—î–º–æ –ø—ñ—Å–ª—è —Å–∫–∏–¥–∞–Ω–Ω—è
}
    
    // –î–æ–¥–∞–≤–∞–Ω–Ω—è —Å–ª—É—Ö–∞—á—ñ–≤ –ø–æ–¥—ñ–π
    if (elements.openTheoryBtn) elements.openTheoryBtn.addEventListener('click', () => toggleModal(elements.theoryModal, true));
    if (elements.openVideoBtn) elements.openVideoBtn.addEventListener('click', () => toggleModal(elements.videoModal, true));
    if (elements.openQuestionsBtn) elements.openQuestionsBtn.addEventListener('click', () => toggleModal(elements.questionsModal, true));
    if (elements.openTrainerBtn) elements.openTrainerBtn.addEventListener('click', () => {
        toggleModal(elements.trainerModal, true);
        generateQuestion();
    });
    if (elements.closeTheoryBtn) elements.closeTheoryBtn.addEventListener('click', () => toggleModal(elements.theoryModal, false));
    if (elements.closeVideoBtn) elements.closeVideoBtn.addEventListener('click', () => toggleModal(elements.videoModal, false));
    if (elements.closeQuestionsBtn) elements.closeQuestionsBtn.addEventListener('click', () => toggleModal(elements.questionsModal, false));
    if (elements.closeTrainerBtn) elements.closeTrainerBtn.addEventListener('click', () => {
        toggleModal(elements.trainerModal, false);
        resetTrainer();
    });
    if (elements.closeVideoPlayerBtn1) elements.closeVideoPlayerBtn1.addEventListener('click', () => {
        stopAllVideos();
        toggleModal(elements.videoPlayerModal1, false);
        toggleModal(elements.videoModal, true);
    });
    if (elements.modalOverlay) {
        elements.modalOverlay.addEventListener('click', () => {
            stopAllVideos();
            toggleModal(elements.theoryModal, false);
            toggleModal(elements.videoModal, false);
            toggleModal(elements.questionsModal, false);
            toggleModal(elements.trainerModal, false);
            toggleModal(elements.videoPlayerModal1, false);
            resetTrainer();
        });
    }
    document.addEventListener('keydown', e => {
        if (e.key === 'Escape') {
            stopAllVideos();
            toggleModal(elements.theoryModal, false);
            toggleModal(elements.videoModal, false);
            toggleModal(elements.questionsModal, false);
            toggleModal(elements.trainerModal, false);
            toggleModal(elements.videoPlayerModal1, false);
            resetTrainer();
        }
    });

if (elements.submitAnswer) {
    elements.submitAnswer.addEventListener('click', () => {
        const selectedBtn = elements.trainerOptions.querySelector('.option-btn.selected');
        const fb = elements.feedbackMessage;

        if (!fb) {
            console.error('–ï–ª–µ–º–µ–Ω—Ç feedbackMessage –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ');
            elements.trainerQuestion.innerHTML = '<span style="color: red;">–ü–æ–º–∏–ª–∫–∞: –ï–ª–µ–º–µ–Ω—Ç feedbackMessage –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</span>';
            return;
        }

        fb.style.display = 'none';
        fb.className = 'trainer-feedback';

        if (!selectedBtn) {
            fb.style.display = 'block';
            fb.textContent = '–í–∏–±–µ—Ä—ñ—Ç—å –≤–∞—Ä—ñ–∞–Ω—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ!';
            fb.className = 'trainer-feedback wrong show';
            setTimeout(() => {
                fb.className = 'trainer-feedback';
                fb.style.display = 'none';
                fb.textContent = '';
            }, 2000);
            return;
        }

        const isCorrect = selectedBtn.dataset.correct === 'true';
        console.log('–û–±—Ä–∞–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:', selectedBtn.getAttribute('aria-label'), '–ü—Ä–∞–≤–∏–ª—å–Ω–∞:', isCorrect, 'questionCount:', questionCount, 'dataset.correct:', selectedBtn.dataset.correct);

        if (isCorrect) {
            fb.style.display = 'block';
            fb.textContent = '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –ú–æ–ª–æ–¥–µ—Ü—å!';
            fb.className = 'trainer-feedback correct show';
            selectedBtn.classList.add('correct');
            setTimeout(() => {
                fb.className = 'trainer-feedback';
                fb.style.display = 'none';
                fb.textContent = '';
                elements.trainerQuestion.innerHTML = '';
                elements.trainerOptions.innerHTML = '';
                elements.systemEquations.innerHTML = '';
                console.log('–ü–µ—Ä–µ—Ö—ñ–¥ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–Ω—è, –ø–æ—Ç–æ—á–Ω–∏–π questionCount:', questionCount);
                if (questionCount === 1) {
                    questionCount = 2;
                    console.log('–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ questionCount = 2');
                    elements.questionCircle.textContent = '–ü–∏—Ç–∞–Ω–Ω—è 2';
                    generateQuestion();
                } else if (questionCount === 2) {
                    questionCount = 3;
                    console.log('–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ questionCount = 3');
                    elements.questionCircle.textContent = '–ü–∏—Ç–∞–Ω–Ω—è 3';
                    generateQuestion();
                } else if (questionCount === 3) {
                    questionCount = 4;
                    console.log('–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ questionCount = 4');
                    elements.questionCircle.textContent = '–ü–∏—Ç–∞–Ω–Ω—è 4';
                    generateQuestion();
                } else if (questionCount === 4) {
                    console.log('–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ç—Ä–µ–Ω–∞–∂–µ—Ä–∞');
                     elements.questionCircle.style.display = 'none';
                            elements.trainerQuestion.style.display = 'none';
                            elements.systemEquations.style.display = 'none';
                            elements.trainerOptions.style.display = 'none';
                            elements.submitAnswer.style.display = 'none';
                            elements.completionMessage.style.display = 'block';
                            elements.resetTrainerBtn?.focus();
                } else {
                    console.error('–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è questionCount:', questionCount);
                    elements.trainerQuestion.innerHTML = '<span style="color: red;">–ü–æ–º–∏–ª–∫–∞: –ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Å—Ç–∞–Ω —Ç—Ä–µ–Ω–∞–∂–µ—Ä–∞</span>';
                }
                if (window.MathJax && MathJax.typesetPromise && questionCount <= 4) {
                    console.log('–ó–∞–ø—É—Å–∫ MathJax –ø—ñ—Å–ª—è –ø–µ—Ä–µ—Ö–æ–¥—É –¥–æ –ø–∏—Ç–∞–Ω–Ω—è', questionCount);
                    MathJax.typesetPromise([elements.trainerQuestion, elements.trainerOptions])
                        .then(() => console.log('MathJax –æ–Ω–æ–≤–ª–µ–Ω–æ –¥–ª—è –ø–∏—Ç–∞–Ω–Ω—è', questionCount))
                        .catch(err => {
                            console.error('–ü–æ–º–∏–ª–∫–∞ MathJax:', err);
                            elements.trainerQuestion.innerHTML = '<span style="color: red;">–ü–æ–º–∏–ª–∫–∞ MathJax</span>';
                        });
                }
            }, 2000);
        } else {
            fb.style.display = 'block';
            fb.textContent = '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, —Å–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑!';
            fb.className = 'trainer-feedback wrong show';
            selectedBtn.classList.add('wrong');
            setTimeout(() => {
                fb.className = 'trainer-feedback';
                fb.style.display = 'none';
                fb.textContent = '';
                document.querySelectorAll('.option-btn').forEach(btn => {
                    btn.classList.remove('wrong', 'selected', 'correct');
                });
                console.log('–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –Ω–æ–≤–æ–≥–æ –ø–∏—Ç–∞–Ω–Ω—è –ø—ñ—Å–ª—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –¥–ª—è questionCount:', questionCount);
                generateQuestion();
                if (window.MathJax && MathJax.typesetPromise) {
                    MathJax.typesetPromise([elements.trainerQuestion, elements.trainerOptions])
                        .then(() => console.log('MathJax –æ–Ω–æ–≤–ª–µ–Ω–æ –ø—ñ—Å–ª—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ'))
                        .catch(err => {
                            console.error('–ü–æ–º–∏–ª–∫–∞ MathJax:', err);
                            elements.trainerQuestion.innerHTML = '<span style="color: red;">–ü–æ–º–∏–ª–∫–∞ MathJax</span>';
                        });
                }
            }, 2000);
        }
    });
}

if (elements.resetTrainerBtn) {
    elements.resetTrainerBtn.addEventListener('click', () => {
        console.log('–°–∫–∏–¥–∞–Ω–Ω—è —Ç—Ä–µ–Ω–∞–∂–µ—Ä–∞');
        resetTrainer();
    });
}

console.log('MathJax:', window.MathJax);
generateQuestion();
    });
    </script>
</body>
</html>


